{"code":"!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&n&&\"string\"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=8)}([function(t,e,n){\"use strict\";function r(t,e){function n(){this.constructor=t}I(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(n[r]=t[r]);if(null!=t&&\"function\"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)0>e.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function o(t,e,n,r){var i,o=arguments.length,s=3>o?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;0<=u;u--)(i=t[u])&&(s=(3>o?i(s):3<o?i(e,n,s):i(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}function s(t,e){return function(n,r){e(n,r,t)}}function u(t,e){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function a(t,e,n,r){function i(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){t.done?n(t.value):i(t.value).then(s,u)}a((r=r.apply(t,e||[])).next())})}function h(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(i=1,o&&(s=2&n[0]?o.return:n[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){a.label=n[1];break}if(6===n[0]&&a.label<s[1]){a.label=s[1],s=n;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(n);break}s[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:n(0),throw:n(1),return:n(2)},\"function\"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u}function c(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function f(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function l(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function v(t,e,n){function r(t){h[t]&&(a[t]=function(e){return new Promise(function(n,r){1<c.push([t,e,n,r])||i(t,e)})})}function i(t,e){try{!function(t){t.value instanceof y?Promise.resolve(t.value.v).then(o,s):u(c[0][2],t)}(h[t](e))}catch(e){u(c[0][3],e)}}function o(t){i(\"next\",t)}function s(t){i(\"throw\",t)}function u(t,e){t(e),c.shift(),c.length&&i(c[0][0],c[0][1])}if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var a,h=n.apply(t,e||[]),c=[];return a={},r(\"next\"),r(\"throw\"),r(\"return\"),a[Symbol.asyncIterator]=function(){return this},a}function m(t){function e(e,i){n[e]=t[e]?function(n){return(r=!r)?{value:y(t[e](n)),done:\"return\"===e}:i?i(n):n}:i}var n,r;return n={},e(\"next\"),e(\"throw\",function(t){throw t}),e(\"return\"),n[Symbol.iterator]=function(){return this},n}function g(t){function e(e){n[e]=t[e]&&function(n){return new Promise(function(r,i){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,i,(n=t[e](n)).done,n.value)})}}if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var n,r=t[Symbol.asyncIterator];return r?r.call(t):(t=f(t),n={},e(\"next\"),e(\"throw\"),e(\"return\"),n[Symbol.asyncIterator]=function(){return this},n)}function w(t,e){return Object.defineProperty?Object.defineProperty(t,\"raw\",{value:e}):t.raw=e,t}function b(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _(t){return t&&t.__esModule?t:{default:t}}function E(t,e){if(!e.has(t))throw new TypeError(\"attempted to get private field on non-instance\");return e.get(t)}function T(t,e,n){if(!e.has(t))throw new TypeError(\"attempted to set private field on non-instance\");return e.set(t,n),n}n.r(e),n.d(e,\"__extends\",function(){return r}),n.d(e,\"__assign\",function(){return N}),n.d(e,\"__rest\",function(){return i}),n.d(e,\"__decorate\",function(){return o}),n.d(e,\"__param\",function(){return s}),n.d(e,\"__metadata\",function(){return u}),n.d(e,\"__awaiter\",function(){return a}),n.d(e,\"__generator\",function(){return h}),n.d(e,\"__exportStar\",function(){return c}),n.d(e,\"__values\",function(){return f}),n.d(e,\"__read\",function(){return l}),n.d(e,\"__spread\",function(){return p}),n.d(e,\"__spreadArrays\",function(){return d}),n.d(e,\"__await\",function(){return y}),n.d(e,\"__asyncGenerator\",function(){return v}),n.d(e,\"__asyncDelegator\",function(){return m}),n.d(e,\"__asyncValues\",function(){return g}),n.d(e,\"__makeTemplateObject\",function(){return w}),n.d(e,\"__importStar\",function(){return b}),n.d(e,\"__importDefault\",function(){return _}),n.d(e,\"__classPrivateFieldGet\",function(){return E}),n.d(e,\"__classPrivateFieldSet\",function(){return T});var I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},N=function(){return(N=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)}},function(t,e,n){\"use strict\";var r=String.fromCharCode;(function(t){function i(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=i(t[n],e[n]));return t}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function o(){return\"undefined\"!=typeof navigator&&\"string\"==typeof navigator.userAgent?navigator.userAgent:\"\"}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction s(t){return JSON.parse(t)}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function u(){}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function a(t,e,n){var r=\"\";switch(e){case 1:r=n?\"first\":\"First\";break;case 2:r=n?\"second\":\"Second\";break;case 3:r=n?\"third\":\"Third\";break;case 4:r=n?\"fourth\":\"Fourth\";break;default:throw new Error(\"errorPrefix called with argumentNumber > 4.  Need to update it?\")}var i=t+\" failed: \";return i+=r+\" argument \"}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */Object.defineProperty(e,\"__esModule\",{value:!0});var h=n(0),c={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:\"${JSCORE_VERSION}\"},f=function(t,e){if(!t)throw l(e)},l=function(t){return new Error(\"Firebase Database (\"+c.SDK_VERSION+\") INTERNAL ASSERT FAILED: \"+t)},p=function(t){for(var e,n=[],r=0,i=0;i<t.length;i++)128>(e=t.charCodeAt(i))?n[r++]=e:2048>e?(n[r++]=192|e>>6,n[r++]=128|63&e):55296==(64512&e)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(e=65536+((1023&e)<<10)+(1023&t.charCodeAt(++i)),n[r++]=240|e>>18,n[r++]=128|63&e>>12,n[r++]=128|63&e>>6,n[r++]=128|63&e):(n[r++]=224|e>>12,n[r++]=128|63&e>>6,n[r++]=128|63&e);return n},d={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+\"+/=\"},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+\"-_.\"},HAS_NATIVE_SUPPORT:\"function\"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error(\"encodeByteArray takes an array as a parameter\");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,u=s?t[i+1]:0,a=i+2<t.length,h=a?t[i+2]:0,c=(15&u)<<2|h>>6,f=63&h;a||(f=64,!s&&(c=64)),r.push(n[o>>2],n[(3&o)<<4|u>>4],n[c],n[f])}return r.join(\"\")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(p(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var o=t[n++];if(128>o)e[i++]=r(o);else if(191<o&&224>o){var s=t[n++];e[i++]=r((31&o)<<6|63&s)}else if(239<o&&365>o){var u=((7&o)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[i++]=r(55296+(u>>10)),e[i++]=r(56320+(1023&u))}else{s=t[n++];var a=t[n++];e[i++]=r((15&o)<<12|(63&s)<<6|63&a)}}return e.join(\"\")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,u=++i<t.length?n[t.charAt(i)]:64,a=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==u||null==a)throw Error();r.push(o<<2|s>>4),64!==u&&(r.push(240&s<<4|u>>2),64!==a&&r.push(192&u<<6|a))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},y=function(t){try{return d.decodeString(t,!0)}catch(t){console.error(\"base64Decode failed: \",t)}return null},v=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),\"function\"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}(),m=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=\"FirebaseError\",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,g.prototype.create),i}return h.__extends(e,t),e}(Error),g=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+\"/\"+t,s=this.errors[t],u=s?function(t,e){return t.replace(w,function(t,n){var r=e[n];return null==r?\"<\"+n+\"?>\":r.toString()})}(s,i):\"Error\",a=this.serviceName+\": \"+u+\" (\"+o+\").\",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++)\"_\"!==(r=f[c]).slice(-1)&&(r in h&&console.warn('Overwriting FirebaseError base field \"'+r+'\" can cause unexpected behavior.'),h[r]=i[r]);return h},t}(),w=/\\{\\$([^}]+)}/g,b=function(t){var e={},n={},r={},i=\"\";try{var o=t.split(\".\");e=s(y(o[0])||\"\"),n=s(y(o[1])||\"\"),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:e,claims:n,data:r,signature:i}},_=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if(\"string\"==typeof t)for(var r=0;16>r;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;16>r;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;80>r;r++)f=n[r-3]^n[r-8]^n[r-14]^n[r-16],n[r]=4294967295&(f<<1|f>>>31);var i,o,s=this.chain_[0],u=this.chain_[1],a=this.chain_[2],h=this.chain_[3],c=this.chain_[4];for(r=0;80>r;r++){40>r?20>r?(i=h^u&(a^h),o=1518500249):(i=u^a^h,o=1859775393):60>r?(i=u&a|h&(u|a),o=2400959708):(i=u^a^h,o=3395469782);var f=4294967295&(s<<5|s>>>27)+i+c+o+n[r];c=h,h=a,a=4294967295&(u<<30|u>>>2),u=s,s=f}this.chain_[0]=4294967295&this.chain_[0]+s,this.chain_[1]=4294967295&this.chain_[1]+u,this.chain_[2]=4294967295&this.chain_[2]+a,this.chain_[3]=4294967295&this.chain_[3]+h,this.chain_[4]=4294967295&this.chain_[4]+c},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if(\"string\"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;5>n;n++)for(var i=24;0<=i;i-=8)t[r]=255&this.chain_[n]>>i,++r;return t},t}(),E=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error(\"Missing Observer.\");void 0===(r=function(t,e){if(\"object\"!=typeof t||null===t)return!1;for(var n,r=0,i=e;r<i.length;r++)if((n=i[r])in t&&\"function\"==typeof t[n])return!0;return!1}(t,[\"next\",\"error\",\"complete\"])?t:{next:t,error:e,complete:n}).next&&(r.next=u),void 0===r.error&&(r.error=u),void 0===r.complete&&(r.complete=u);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){\"undefined\"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */e.CONSTANTS=c,e.Deferred=v,e.ErrorFactory=g,e.FirebaseError=m,e.Sha1=_,e.assert=f,e.assertionError=l,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}},e.base64=d,e.base64Decode=y,e.base64Encode=function(t){var e=p(t);return d.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new E(t,e);return n.subscribe.bind(n)},e.decode=b,e.deepCopy=function(t){return i(void 0,t)},e.deepExtend=i,e.errorPrefix=a,e.getUA=o,e.isAdmin=function(t){var e=b(t).claims;return\"object\"==typeof e&&!0===e.admin},e.isBrowser=function(){return\"object\"==typeof self&&self.self===self},e.isBrowserExtension=function(){var t=\"object\"==typeof chrome?chrome.runtime:\"object\"==typeof browser?browser.runtime:void 0;return\"object\"==typeof t&&void 0!==t.id},e.isElectron=function(){return 0<=o().indexOf(\"Electron/\")},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isIE=function(){var t=o();return 0<=t.indexOf(\"MSIE \")||0<=t.indexOf(\"Trident/\")},e.isMobileCordova=function(){return\"undefined\"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(o())},e.isNode=function(){try{return\"[object process]\"===Object.prototype.toString.call(t.process)}catch(t){return!1}},e.isNodeSdk=function(){return!0===c.NODE_CLIENT||!0===c.NODE_ADMIN},e.isReactNative=function(){return\"object\"==typeof navigator&&\"ReactNative\"===navigator.product},e.isUWP=function(){return 0<=o().indexOf(\"MSAppHost/\")},e.isValidFormat=function(t){var e=b(t).claims;return!!e&&\"object\"==typeof e&&e.hasOwnProperty(\"iat\")},e.isValidTimestamp=function(t){var e=b(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return\"object\"==typeof e&&(e.hasOwnProperty(\"nbf\")?r=e.nbf:e.hasOwnProperty(\"iat\")&&(r=e.iat),i=e.hasOwnProperty(\"exp\")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=b(t).claims;return\"object\"==typeof e&&e.hasOwnProperty(\"iat\")?e.iat:null},e.jsonEval=s,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?\"&\"+e.join(\"&\"):\"\"},e.querystringDecode=function(t){var e={};return t.replace(/^\\?/,\"\").split(\"&\").forEach(function(t){if(t){var n=t.split(\"=\");e[n[0]]=n[1]}}),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e,n=0,r=0;r<t.length;r++)128>(e=t.charCodeAt(r))?n++:2048>e?n+=2:55296<=e&&56319>=e?(n+=4,r++):n+=3;return n},e.stringToByteArray=function(t){for(var e,n=[],r=0,i=0;i<t.length;i++){if(55296<=(e=t.charCodeAt(i))&&56319>=e){var o=e-55296;f(++i<t.length,\"Surrogate pair missing trail surrogate.\"),e=65536+(o<<10)+(t.charCodeAt(i)-56320)}128>e?n[r++]=e:2048>e?(n[r++]=192|e>>6,n[r++]=128|63&e):65536>e?(n[r++]=224|e>>12,n[r++]=128|63&e>>6,n[r++]=128|63&e):(n[r++]=240|e>>18,n[r++]=128|63&e>>12,n[r++]=128|63&e>>6,n[r++]=128|63&e)}return n},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i=\"at least \"+e:r>n&&(i=0===n?\"none\":\"no more than \"+n),i)throw new Error(t+\" failed: Was called with \"+r+(1===r?\" argument.\":\" arguments.\")+\" Expects \"+i+\".\")},e.validateCallback=function(t,e,n,r){if((!r||n)&&\"function\"!=typeof n)throw new Error(a(t,e,r)+\"must be a valid function.\")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&(\"object\"!=typeof n||null===n))throw new Error(a(t,e,r)+\"must be a valid context object.\")},e.validateNamespace=function(t,e,n,r){if((!r||n)&&\"string\"!=typeof n)throw new Error(a(t,e,r)+\"must be a valid firebase namespace.\")}}).call(this,n(2))},function(t){var e=function(){return this}();try{e=e||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(e=window)}t.exports=e},function(t,e,n){\"use strict\";\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(e,\"__esModule\",{value:!0});var r=n(0),i=n(1),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=\"LAZY\"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s=\"[DEFAULT]\",u=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=s);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:s,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var u=this.getOrInitializeService(o);if(!u){if(i)return null;throw Error(\"Service \"+this.name+\" is not available\")}return u}catch(e){if(i)return null;throw e}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error(\"Mismatching Component \"+t.name+\" for Provider \"+this.name+\".\");if(this.component)throw Error(\"Component for \"+this.name+\" has already been provided\");if(this.component=t,function(t){return\"EAGER\"===t.instantiationMode}(t))try{this.getOrInitializeService(s)}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var u=r.__read(o.value,2),a=u[0],h=u[1],c=this.normalizeInstanceIdentifier(a);try{var f=this.getOrInitializeService(c);h.resolve(f)}catch(e){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=s),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter(function(t){return\"INTERNAL\"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===s?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:s:t},t}(),a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(\"Component \"+t.name+\" has already been registered with \"+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new u(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */e.Component=o,e.ComponentContainer=a,e.Provider=u},function(t,e,n){\"use strict\";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function i(t){var e=\"string\"==typeof t?h[t]:t;a.forEach(function(t){t.logLevel=e})}function o(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=h[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map(function(t){if(null==t)return null;if(\"string\"==typeof t)return t;if(\"number\"==typeof t||\"boolean\"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(\" \");n>=(null!=r?r:e.logLevel)&&t({level:u[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++)n(i[r])}n.r(e),n.d(e,\"LogLevel\",function(){return u}),n.d(e,\"Logger\",function(){return p}),n.d(e,\"setLogLevel\",function(){return i}),n.d(e,\"setUserLogHandler\",function(){return o});var s,u,a=[];!function(t){t[t.DEBUG=0]=\"DEBUG\",t[t.VERBOSE=1]=\"VERBOSE\",t[t.INFO=2]=\"INFO\",t[t.WARN=3]=\"WARN\",t[t.ERROR=4]=\"ERROR\",t[t.SILENT=5]=\"SILENT\"}(u||(u={}));var h={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},c=u.INFO,f=((s={})[u.DEBUG]=\"log\",s[u.VERBOSE]=\"log\",s[u.INFO]=\"info\",s[u.WARN]=\"warn\",s[u.ERROR]=\"error\",s),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=f[e];if(!s)throw new Error(\"Attempted to log a message with an invalid logType (value: \"+e+\")\");console[s].apply(console,r([\"[\"+o+\"]  \"+t.name+\":\"],n))}},p=function(){function t(t){this.name=t,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,\"logLevel\",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError(\"Invalid value assigned to `logLevel`\");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"logHandler\",{get:function(){return this._logHandler},set:function(t){if(\"function\"!=typeof t)throw new TypeError(\"Value assigned to `logHandler` must be a function\");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"userLogHandler\",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,u.DEBUG],t)),this._logHandler.apply(this,r([this,u.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,u.VERBOSE],t)),this._logHandler.apply(this,r([this,u.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,u.INFO],t)),this._logHandler.apply(this,r([this,u.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,u.WARN],t)),this._logHandler.apply(this,r([this,u.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,u.ERROR],t)),this._logHandler.apply(this,r([this,u.ERROR],t))},t}()},function(t,e,n){\"use strict\";\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function r(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function o(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function s(t){return null==t}function u(t){return-0===t&&1/t==-1/0}function a(t){return\"number\"==typeof t&&Number.isInteger(t)&&!u(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function h(t){var e,n;return\"server_timestamp\"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function c(t){var e=m(t.mapValue.fields.__local_write_time__.timestampValue);return new Te(e.seconds,e.nanos)}\n/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function f(t){return\"nullValue\"in t?0:\"booleanValue\"in t?1:\"integerValue\"in t||\"doubleValue\"in t?2:\"timestampValue\"in t?3:\"stringValue\"in t?5:\"bytesValue\"in t?6:\"referenceValue\"in t?7:\"geoPointValue\"in t?8:\"arrayValue\"in t?9:\"mapValue\"in t?h(t)?4:10:G(\"Invalid value type: \"+JSON.stringify(t))}function l(t,e){var n=f(t);return n===f(e)&&(!(0!==n)||(1===n?t.booleanValue===e.booleanValue:4===n?c(t).isEqual(c(e)):3===n?function(t,e){if(\"string\"==typeof t.timestampValue&&\"string\"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=m(t.timestampValue),r=m(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e):5===n?t.stringValue===e.stringValue:6===n?function(t,e){return w(t.bytesValue).isEqual(w(e.bytesValue))}(t,e):7===n?t.referenceValue===e.referenceValue:8===n?function(t,e){return g(t.geoPointValue.latitude)===g(e.geoPointValue.latitude)&&g(t.geoPointValue.longitude)===g(e.geoPointValue.longitude)}(t,e):2===n?function(t,e){if(\"integerValue\"in t&&\"integerValue\"in e)return g(t.integerValue)===g(e.integerValue);if(\"doubleValue\"in t&&\"doubleValue\"in e){var n=g(t.doubleValue),r=g(e.doubleValue);return n===r?u(n)===u(r):isNaN(n)&&isNaN(r)}return!1}(t,e):9===n?W(t.arrayValue.values||[],e.arrayValue.values||[],l):10===n?function(t,e){var n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(r(n)!==r(i))return!1;for(var o in n)if(n.hasOwnProperty(o)&&(void 0===i[o]||!l(n[o],i[o])))return!1;return!0}(t,e):G(\"Unexpected value type: \"+JSON.stringify(t))))}function p(t,e){return void 0!==(t.values||[]).find(function(t){return l(t,e)})}function d(t,e){var n=f(t),r=f(e);if(n!==r)return K(n,r);switch(n){case 0:return 0;case 1:return K(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=g(t.integerValue||t.doubleValue),r=g(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return y(t.timestampValue,e.timestampValue);case 4:return y(c(t),c(e));case 5:return K(t.stringValue,e.stringValue);case 6:return function(t,e){var n=w(t),r=w(e);return n.D(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n,r=t.split(\"/\"),i=e.split(\"/\"),o=0;o<r.length&&o<i.length;o++)if(0!==(n=K(r[o],i[o])))return n;return K(r.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=K(g(t.latitude),g(e.latitude));return 0===n?K(g(t.longitude),g(e.longitude)):n}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n,r=t.values||[],i=e.values||[],o=0;o<r.length&&o<i.length;++o)if(n=d(r[o],i[o]))return n;return K(r.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s,u=0;u<r.length&&u<o.length;++u){if(0!==(s=K(r[u],o[u])))return s;var a=d(n[r[u]],i[o[u]]);if(0!==a)return a}return K(r.length,o.length)}(t.mapValue,e.mapValue);default:throw G(\"Invalid value type: \"+n)}}function y(t,e){if(\"string\"==typeof t&&\"string\"==typeof e&&t.length===e.length)return K(t,e);var n=m(t),r=m(e),i=K(n.seconds,r.seconds);return 0===i?K(n.nanos,r.nanos):i}function v(t){return function t(e){return\"nullValue\"in e?\"null\":\"booleanValue\"in e?\"\"+e.booleanValue:\"integerValue\"in e?\"\"+e.integerValue:\"doubleValue\"in e?\"\"+e.doubleValue:\"timestampValue\"in e?function(t){var e=m(t);return\"time(\"+e.seconds+\",\"+e.nanos+\")\"}(e.timestampValue):\"stringValue\"in e?e.stringValue:\"bytesValue\"in e?w(e.bytesValue).toBase64():\"referenceValue\"in e?(r=e.referenceValue,ke.tt(r).toString()):\"geoPointValue\"in e?\"geo(\"+(n=e.geoPointValue).latitude+\",\"+n.longitude+\")\":\"arrayValue\"in e?function(e){for(var n,r=\"[\",i=!0,o=0,s=e.values||[];o<s.length;o++)n=s[o],i?i=!1:r+=\",\",r+=t(n);return r+\"]\"}(e.arrayValue):\"mapValue\"in e?function(e){for(var n,r=\"{\",i=!0,o=0,s=Object.keys(e.fields||{}).sort();o<s.length;o++)i?i=!1:r+=\",\",r+=(n=s[o])+\":\"+t(e.fields[n]);return r+\"}\"}(e.mapValue):G(\"Invalid value type: \"+JSON.stringify(e));var n,r}(t)}function m(t){if(z(!!t,\"Cannot normalize null or undefined timestamp.\"),\"string\"==typeof t){var e=0,n=Ve.exec(t);if(z(!!n,\"invalid timestamp: \"+t),n[1]){var r=n[1];e=+(r=(r+\"000000000\").substr(0,9))}var i=new Date(t);return{seconds:se(i.getTime()/1e3),nanos:e}}return{seconds:g(t.seconds),nanos:g(t.nanos)}}function g(t){return\"number\"==typeof t?t:\"string\"==typeof t?+t:0}function w(t){return\"string\"==typeof t?Pe.fromBase64String(t):Pe.fromUint8Array(t)}function b(t,e){return{referenceValue:\"projects/\"+t.projectId+\"/databases/\"+t.database+\"/documents/\"+e.path.K()}}function _(t){return!!t&&\"integerValue\"in t}function E(t){return!!t&&\"arrayValue\"in t}function T(t){return!!t&&\"nullValue\"in t}function I(t){return!!t&&\"doubleValue\"in t&&isNaN(+t.doubleValue)}function N(t){return!!t&&\"mapValue\"in t}\n/**\n * @license\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function A(t){return E(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function S(t){return t===ve.OK?G(\"Treated status OK as error\"):t!==ve.CANCELLED&&t!==ve.UNKNOWN&&t!==ve.DEADLINE_EXCEEDED&&t!==ve.RESOURCE_EXHAUSTED&&t!==ve.INTERNAL&&t!==ve.UNAVAILABLE&&t!==ve.UNAUTHENTICATED&&(t===ve.INVALID_ARGUMENT||t===ve.NOT_FOUND||t===ve.ALREADY_EXISTS||t===ve.PERMISSION_DENIED||t===ve.FAILED_PRECONDITION||t===ve.ABORTED||t===ve.OUT_OF_RANGE||t===ve.UNIMPLEMENTED||t===ve.DATA_LOSS||G(\"Unknown status code: \"+t))}function D(t){return void 0===t?(q(\"GRPC error has no .code\"),ve.UNKNOWN):t===dn.OK?ve.OK:t===dn.CANCELLED?ve.CANCELLED:t===dn.UNKNOWN?ve.UNKNOWN:t===dn.DEADLINE_EXCEEDED?ve.DEADLINE_EXCEEDED:t===dn.RESOURCE_EXHAUSTED?ve.RESOURCE_EXHAUSTED:t===dn.INTERNAL?ve.INTERNAL:t===dn.UNAVAILABLE?ve.UNAVAILABLE:t===dn.UNAUTHENTICATED?ve.UNAUTHENTICATED:t===dn.INVALID_ARGUMENT?ve.INVALID_ARGUMENT:t===dn.NOT_FOUND?ve.NOT_FOUND:t===dn.ALREADY_EXISTS?ve.ALREADY_EXISTS:t===dn.PERMISSION_DENIED?ve.PERMISSION_DENIED:t===dn.FAILED_PRECONDITION?ve.FAILED_PRECONDITION:t===dn.ABORTED?ve.ABORTED:t===dn.OUT_OF_RANGE?ve.OUT_OF_RANGE:t===dn.UNIMPLEMENTED?ve.UNIMPLEMENTED:t===dn.DATA_LOSS?ve.DATA_LOSS:G(\"Unknown status code: \"+t)}function k(){return En}function x(){return k()}function O(){return Tn}function R(){return In}function L(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,r=Nn,i=0,o=t;i<o.length;i++)n=o[i],r=r.add(n);return r}function C(){return An}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function P(){return new xe(ke.F)}function V(){return new xe(ke.F)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function U(t){return 4<=t.length&&\"projects\"===t.get(0)&&\"databases\"===t.get(2)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function M(){return qn.logLevel}function j(t){qn.logLevel=t}function F(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(qn.logLevel<=ce.LogLevel.DEBUG){var r=e.map(B);qn.debug.apply(qn,ae.__spreadArrays([\"Firestore (\"+de+\"): \"+t],r))}}function q(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(qn.logLevel<=ce.LogLevel.ERROR){var r=e.map(B);qn.error.apply(qn,ae.__spreadArrays([\"Firestore (\"+de+\"): \"+t],r))}}function B(t){if(\"string\"==typeof t)return t;var e=Fn.Lt();try{return e.Ti(t)}catch(e){return t}}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function G(t){var e=\"FIRESTORE (\"+de+\") INTERNAL ASSERTION FAILED: \"+t;throw q(e),new Error(e)}function z(t,e){t||G(e)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function K(t,e){return t<e?-1:t>e?1:0}function W(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function H(t){return t+\"\\0\"}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Y(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=K(n,i);return 0===s?K(r,o):s}function X(t){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){if(t.code!==ve.FAILED_PRECONDITION||t.message!==Zn)throw t;return F(\"LocalStore\",\"Unexpectedly lost primary lease\"),[2]})})}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function J(t,e){if(0!==e.length)throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() does not support arguments, but was called with \"+pt(e.length,\"argument\")+\".\")}function Q(t,e,n){if(e.length!==n)throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires \"+pt(n,\"argument\")+\", but was called with \"+pt(e.length,\"argument\")+\".\")}function Z(t,e,n){if(e.length<n)throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires at least \"+pt(n,\"argument\")+\", but was called with \"+pt(e.length,\"argument\")+\".\")}function $(t,e,n,r){if(e.length<n||e.length>r)throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires between \"+n+\" and \"+r+\" arguments, but was called with \"+pt(e.length,\"argument\")+\".\")}function tt(t,e,n,r){ot(t,e,lt(n)+\" argument\",r)}function et(t,e,n,r){void 0!==r&&tt(t,e,n,r)}function nt(t,e,n,r){ot(t,e,n+\" option\",r)}function rt(t,e,n,r){void 0!==r&&nt(t,e,n,r)}function it(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o,s=[],u=0,a=i;u<a.length;u++){if((o=a[u])===r)return;s.push(ut(o))}var h=ut(r);throw new me(ve.INVALID_ARGUMENT,\"Invalid value \"+h+\" provided to function \"+t+'() for option \"'+n+'\". Acceptable values: '+s.join(\", \"))}(t,0,n,r,i)}function ot(t,e,n,r){if(\"object\"===e?!st(r):\"non-empty string\"===e?\"string\"!=typeof r||\"\"===r:typeof r!=e){var i=ut(r);throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+n+\" to be of type \"+e+\", but it was: \"+i)}}function st(t){return\"object\"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ut(t){if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"string\"==typeof t)return 20<t.length&&(t=t.substring(0,20)+\"...\"),JSON.stringify(t);if(\"number\"==typeof t||\"boolean\"==typeof t)return\"\"+t;if(\"object\"==typeof t){if(t instanceof Array)return\"an array\";var e=function(t){if(t.constructor){var e=/function\\s+([^\\s(]+)\\s*\\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?\"a custom \"+e+\" object\":\"an object\"}return\"function\"==typeof t?\"a function\":G(\"Unknown wrong type: \"+typeof t)}function at(t,e,n){if(void 0===n)throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires a valid \"+lt(e)+\" argument, but it was undefined.\")}function ht(t,e,n){i(e,function(e){if(0>n.indexOf(e))throw new me(ve.INVALID_ARGUMENT,\"Unknown option '\"+e+\"' passed to function \"+t+\"(). Available options: \"+n.join(\", \"))})}function ct(t,e,n,r){var i=ut(r);return new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+lt(n)+\" argument to be a \"+e+\", but it was: \"+i)}function ft(t,e,n){if(0>=n)throw new me(ve.INVALID_ARGUMENT,'Function \"'+t+'()\" requires its '+lt(e)+\" argument to be a positive number, but it was: \"+n+\".\")}function lt(t){return 1===t?\"first\":2===t?\"second\":3===t?\"third\":t+\"th\"}function pt(t,e){return t+\" \"+e+(1===t?\"\":\"s\")}\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function dt(t,e){function n(){var t=\"This constructor is private.\";throw e&&(t+=\" \",t+=e),new me(ve.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}function yt(){if(\"undefined\"==typeof Uint8Array)throw new me(ve.UNIMPLEMENTED,\"Uint8Arrays are not available in this environment.\")}function vt(){if(!Fn.Lt().ia)throw new me(ve.UNIMPLEMENTED,\"Blobs are unavailable in Firestore in this environment.\")}function mt(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G(\"Unexpected case for UserDataSource: \"+t)}}function gt(t){return!(\"object\"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Te||t instanceof Tr||t instanceof lr||t instanceof Dr||t instanceof vr)}function wt(t,e,n){if(!gt(n)||!st(n)){var r=ut(n);throw\"an object\"===r?e.Aa(t+\" a custom object\"):e.Aa(t+\" \"+r)}}function bt(t,e){if(e instanceof dr)return e.oa;if(\"string\"==typeof e)return _t(t,e);throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() called with invalid data. Field path arguments must be of type string or FieldPath.\")}function _t(t,e){try{return function(t){if(0<=t.search(yr))throw new me(ve.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not contain '~', '*', '/', '[', or ']'\");try{return new(dr.bind.apply(dr,ae.__spreadArrays([void 0],t.split(\".\"))))}catch(e){throw new me(ve.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\")}}(e).oa}catch(e){var n=Et(e);throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() called with invalid data. \"+n)}}function Et(t){return t instanceof Error?t.message:t.toString()}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Tt(t,e){return\"firestore_clients_\"+t+\"_\"+e}function It(t,e,n){var r=\"firestore_mutations_\"+t+\"_\"+n;return e.t()&&(r+=\"_\"+e.uid),r}function Nt(t,e){return\"firestore_targets_\"+t+\"_\"+e}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function At(t){for(var e=\"\",n=0;n<t.length;n++)0<e.length&&(e=Dt(e)),e=St(t.get(n),e);return Dt(e)}function St(t,e){for(var n,r=e,i=t.length,o=0;o<i;o++)r+=\"\\0\"===(n=t.charAt(o))?\"\u0001\u0010\":\"\u0001\"===n?\"\u0001\u0011\":n;return r}function Dt(t){return t+\"\u0001\u0001\"}function kt(t){var e=t.length;if(z(2<=e,\"Invalid path \"+t),2===e)return z(\"\u0001\"===t.charAt(0)&&\"\u0001\"===t.charAt(1),\"Non-empty path \"+t+\" had length 2\"),Ae.H;for(var n,r=[],i=\"\",o=0;o<e;){switch((0>(n=t.indexOf(\"\u0001\",o))||n>e-2)&&G('Invalid encoded resource path: \"'+t+'\"'),t.charAt(n+1)){case\"\u0001\":var s=t.substring(o,n),u=void 0;0===i.length?u=s:(u=i+=s,i=\"\"),r.push(u);break;case\"\u0010\":i+=t.substring(o,n),i+=\"\\0\";break;case\"\u0011\":i+=t.substring(o,n+1);break;default:G('Invalid encoded resource path: \"'+t+'\"')}o=n+2}return new Ae(r)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function xt(t){return new Jn(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Ot(t.target.error);n(e)}})}function Ot(t){var e=ri.Jl(fe.getUA());if(12.2<=e&&13>e){var n=\"An internal error was encountered in the Indexed Database server\";if(0<=t.message.indexOf(n)){var r=new me(\"internal\",\"IOS_INDEXEDDB_BUG1: IndexedDb has thrown '\"+n+\"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\");return ui||(ui=!0,setTimeout(function(){throw r},0)),r}}return t}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Rt(t,e,n){var r=wi.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Pt(t).md({range:o,Td:!0},function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()}).next(function(){return s})}function Lt(t,e,n){var r=t.store(gi.store),i=t.store(wi.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.md({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){z(1==u,\"Dangling document-mutation reference found: Missing batch \"+n.batchId)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=wi.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Jn.Ki(o).next(function(){return h})}function Ct(t){return Ci.ed(t,gi.store)}function Pt(t){return Ci.ed(t,wi.store)}function Vt(t){return Ci.ed(t,mi.store)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Ut(t){return Ci.ed(t,Ii.store)}function Mt(t){return ri.ed(t,Ai.store).get(Ai.key).next(function(t){return z(null!==t,\"Missing metadata row.\"),t})}function jt(t){return Mt(t).next(function(t){return t.highestListenSequenceNumber})}function Ft(t){return Ci.ed(t,Ni.store)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function qt(t){return Ci.ed(t,Ti.store)}function Bt(t){return Ci.ed(t,Ei.store)}function Gt(t){return t.path.j()}function zt(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw G(\"Unknown remote document type\");e=t.noDocument}return JSON.stringify(e).length}\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Kt(t){t.createObjectStore(Ni.store,{keyPath:Ni.keyPath}).createIndex(Ni.documentTargetsIndex,Ni.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ii.store,{keyPath:Ii.keyPath}).createIndex(Ii.queryTargetsIndexName,Ii.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ai.store)}\n/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Wt(t){return Ci.ed(t,Si.store)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Ht(t){return t.store(vi.store)}function Yt(t){return t.store(Di.store)}function Xt(t,e){return Ft(t).put(function(t,e){return new Ni(0,At(t.path),e)}(e,t.Ch))}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Jt(t){return function(t){if(\"object\"!=typeof t||null===t)return!1;for(var e,n=t,r=0,i=[\"next\",\"error\",\"complete\"];r<i.length;r++)if((e=i[r])in n&&\"function\"==typeof n[e])return!0;return!1}(t)}\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function Qt(t,e){if(void 0===e)return{merge:!1};if(ht(t,e,[\"merge\",\"mergeFields\"]),rt(t,\"boolean\",\"merge\",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+e+\" option to be an array, but it was: \"+ut(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() requires all \"+e+\" elements to be a string or a FieldPath, but the value at index \"+o+\" was: \"+ut(r[o]))}(t,\"mergeFields\",0,r,function(t){return\"string\"==typeof t||t instanceof dr})}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new me(ve.INVALID_ARGUMENT,\"Invalid options passed to function \"+t+'(): You cannot specify both \"merge\" and \"mergeFields\".');return e}function Zt(t,e){return void 0===e?{}:(ht(t,e,[\"serverTimestamps\"]),it(t,0,\"serverTimestamps\",e.serverTimestamps,[\"estimate\",\"previous\",\"none\"]),e)}function $t(t,e){et(t,\"object\",1,e),e&&(ht(t,e,[\"source\"]),it(t,0,\"source\",e.source,[\"default\",\"server\",\"cache\"]))}function te(t,e,n){if(e instanceof Zi){if(e.firestore!==n)throw new me(ve.INVALID_ARGUMENT,\"Provided document reference is from a different Firestore instance.\");return e}throw ct(t,\"DocumentReference\",1,e)}function ee(t,e,n){var r;return t?(r=t.toFirestore(e),n=\"toFirestore() in \"+n):r=e,[r,n]}\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */function ne(t){!function(t){t.INTERNAL.registerComponent(new le.Component(\"firestore\",function(t){return e=t.getProvider(\"app\").getImmediate(),n=t.getProvider(\"auth-internal\"),new Xi(e,n,new Gi);var e,n},\"PUBLIC\").setServiceProps(Object.assign({},yo)))}(t),t.registerVersion(\"@firebase/firestore\",\"1.14.1\")\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */}var re=Number.POSITIVE_INFINITY,ie=Number.NEGATIVE_INFINITY,oe=Math.max,se=Math.floor;Object.defineProperty(e,\"__esModule\",{value:!0});var ue,ae=n(0),he=(ue=n(6))&&\"object\"==typeof ue&&\"default\"in ue?ue.default:ue,ce=n(4),fe=n(1),le=n(3),pe=n(7),de=he.SDK_VERSION,ye=function(){function t(t){this.uid=t}return t.prototype.t=function(){return null!=this.uid},t.prototype.s=function(){return this.t()?\"uid:\"+this.uid:\"anonymous-user\"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();ye.UNAUTHENTICATED=new ye(null),ye.i=new ye(\"google-credentials-uid\"),ye.o=new ye(\"first-party-uid\");\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar ve={OK:\"ok\",CANCELLED:\"cancelled\",UNKNOWN:\"unknown\",INVALID_ARGUMENT:\"invalid-argument\",DEADLINE_EXCEEDED:\"deadline-exceeded\",NOT_FOUND:\"not-found\",ALREADY_EXISTS:\"already-exists\",PERMISSION_DENIED:\"permission-denied\",UNAUTHENTICATED:\"unauthenticated\",RESOURCE_EXHAUSTED:\"resource-exhausted\",FAILED_PRECONDITION:\"failed-precondition\",ABORTED:\"aborted\",OUT_OF_RANGE:\"out-of-range\",UNIMPLEMENTED:\"unimplemented\",INTERNAL:\"internal\",UNAVAILABLE:\"unavailable\",DATA_LOSS:\"data-loss\"},me=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name=\"FirebaseError\",r.toString=function(){return r.name+\": [code=\"+r.code+\"]: \"+r.message},r}return ae.__extends(e,t),e}(Error),ge=function(t,e){this.user=e,this.type=\"OAuth\",this.h={},this.h.Authorization=\"Bearer \"+t},we=function(){function t(){this.u=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype._=function(){},t.prototype.l=function(t){this.u=t,t(ye.UNAUTHENTICATED)},t.prototype.T=function(){this.u=null},t}(),be=function(){function t(t){var e=this;this.m=null,this.currentUser=ye.UNAUTHENTICATED,this.I=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.R++,e.currentUser=e.A(),e.I=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.R,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){if(t.R!==e)throw new me(ve.ABORTED,\"getToken aborted due to token change.\");return n?(z(\"string\"==typeof n.accessToken,\"Invalid tokenData returned from getToken():\"+n),new ge(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype._=function(){this.forceRefresh=!0},t.prototype.l=function(t){this.u=t,this.I&&t(this.currentUser)},t.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},t.prototype.A=function(){var t=this.auth&&this.auth.getUid();return z(null===t||\"string\"==typeof t,\"Received invalid UID: \"+t),new ye(t)},t}(),_e=function(){function t(t,e){this.P=t,this.V=e,this.type=\"FirstParty\",this.user=ye.o}return Object.defineProperty(t.prototype,\"h\",{get:function(){var t={\"X-Goog-AuthUser\":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),Ee=function(){function t(t,e){this.P=t,this.V=e}return t.prototype.getToken=function(){return Promise.resolve(new _e(this.P,this.V))},t.prototype.l=function(t){t(ye.o)},t.prototype.T=function(){},t.prototype._=function(){},t}(),Te=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,0>e)throw new me(ve.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(1e9<=e)throw new me(ve.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(-62135596800>t)throw new me(ve.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t);if(253402300800<=t)throw new me(ve.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=se(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.p=function(t){return this.seconds===t.seconds?K(this.nanoseconds,t.nanoseconds):K(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return\"Timestamp(seconds=\"+this.seconds+\", nanoseconds=\"+this.nanoseconds+\")\"},t.prototype.valueOf=function(){return(this.seconds- -62135596800+\"\").padStart(12,\"0\")+\".\"+(this.nanoseconds+\"\").padStart(9,\"0\")},t}(),Ie=function(){function t(t){this.timestamp=t}return t.v=function(e){return new t(e)},t.S=function(){return t.MIN},t.prototype.D=function(t){return this.timestamp.p(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return\"SnapshotVersion(\"+this.timestamp.toString()+\")\"},t.prototype.k=function(){return this.timestamp},t}();Ie.MIN=new Ie(new Te(0,0));var Ne=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&G(\"offset \"+e+\" out of range \"+t.length),void 0===n?n=t.length-e:n>t.length-e&&G(\"length \"+n+\" out of range \"+(t.length-e)),this.segments=t,this.offset=e,this.N=n}return Object.defineProperty(t.prototype,\"length\",{get:function(){return this.N},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.F(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.$(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.M=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},t.prototype.L=function(){return this.$(this.segments,this.offset,this.length-1)},t.prototype.O=function(){return this.segments[this.offset]},t.prototype.B=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.U=function(){return 0===this.length},t.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},t.F=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ae.__extends(e,t),e.prototype.$=function(t,n,r){return new e(t,n,r)},e.prototype.K=function(){return this.j().join(\"/\")},e.prototype.toString=function(){return this.K()},e.G=function(t){if(0<=t.indexOf(\"//\"))throw new me(ve.INVALID_ARGUMENT,\"Invalid path (\"+t+\"). Paths must not contain // in them.\");return new e(t.split(\"/\").filter(function(t){return 0<t.length}))},e}(Ne);Ae.H=new Ae([]);var Se=/^[_a-zA-Z][_a-zA-Z0-9]*$/,De=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ae.__extends(e,t),e.prototype.$=function(t,n,r){return new e(t,n,r)},e.J=function(t){return Se.test(t)},e.prototype.K=function(){return this.j().map(function(t){return t=t.replace(\"\\\\\",\"\\\\\\\\\").replace(\"`\",\"\\\\`\"),e.J(t)||(t=\"`\"+t+\"`\"),t}).join(\".\")},e.prototype.toString=function(){return this.K()},e.prototype.Y=function(){return 1===this.length&&\"__name__\"===this.get(0)},e.X=function(){return new e([\"__name__\"])},e.Z=function(t){for(var n,r=[],i=\"\",o=0,s=function(){if(0===i.length)throw new me(ve.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\");r.push(i),i=\"\"},u=!1;o<t.length;)if(\"\\\\\"===(n=t[o])){if(o+1===t.length)throw new me(ve.INVALID_ARGUMENT,\"Path has trailing escape character: \"+t);var a=t[o+1];if(\"\\\\\"!==a&&\".\"!==a&&\"`\"!==a)throw new me(ve.INVALID_ARGUMENT,\"Path has invalid escape sequence: \"+t);i+=a,o+=2}else\"`\"===n?(u=!u,o++):\".\"!==n||u?(i+=n,o++):(s(),o++);if(s(),u)throw new me(ve.INVALID_ARGUMENT,\"Unterminated ` in path: \"+t);return new e(r)},e}(Ne);De.H=new De([]);\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar ke=function(){function t(t){this.path=t}return t.tt=function(e){return new t(Ae.G(e).M(5))},t.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Ae.F(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.F=function(t,e){return Ae.F(t.path,e.path)},t.st=function(t){return 0==t.length%2},t.nt=function(e){return new t(new Ae(e.slice()))},t}();ke.EMPTY=new ke(new Ae([]));\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar xe=function(){function t(t,e){this.F=t,this.root=e||Re.EMPTY}return t.prototype.it=function(e,n){return new t(this.F,this.root.it(e,n,this.F).rt(null,null,Re.ot,null,null))},t.prototype.remove=function(e){return new t(this.F,this.root.remove(e,this.F).rt(null,null,Re.ot,null,null))},t.prototype.get=function(t){for(var e,n=this.root;!n.U();){if(0===(e=this.F(t,n.key)))return n.value;0>e?n=n.left:0<e&&(n=n.right)}return null},t.prototype.indexOf=function(t){for(var e,n=0,r=this.root;!r.U();){if(0===(e=this.F(t,r.key)))return n+r.left.size;0>e?r=r.left:(n+=r.left.size+1,r=r.right)}return-1},t.prototype.U=function(){return this.root.U()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.ht=function(){return this.root.ht()},t.prototype.at=function(){return this.root.at()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.ut(function(e,n){return t.push(e+\":\"+n),!1}),\"{\"+t.join(\", \")+\"}\"},t.prototype.ct=function(t){return this.root.ct(t)},t.prototype._t=function(){return new Oe(this.root,null,this.F,!1)},t.prototype.lt=function(t){return new Oe(this.root,t,this.F,!1)},t.prototype.dt=function(){return new Oe(this.root,null,this.F,!0)},t.prototype.ft=function(t){return new Oe(this.root,t,this.F,!0)},t}(),Oe=function(){function t(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.U();)if(i=e?n(t.key,e):1,r&&(i*=-1),0>i)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}return t.prototype.wt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.U();)this.Et.push(t),t=t.right;else for(t=t.right;!t.U();)this.Et.push(t),t=t.left;return e},t.prototype.It=function(){return 0<this.Et.length},t.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},t}(),Re=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null==r?t.RED:r,this.left=null==i?t.EMPTY:i,this.right=null==o?t.EMPTY:o,this.size=this.left.size+1+this.right.size}return t.prototype.rt=function(e,n,r,i,o){return new t(null==e?this.key:e,null==n?this.value:n,null==r?this.color:r,null==i?this.left:i,null==o?this.right:o)},t.prototype.U=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},t.prototype.min=function(){return this.left.U()?this:this.left.min()},t.prototype.ht=function(){return this.min().key},t.prototype.at=function(){return this.right.U()?this.key:this.right.at()},t.prototype.it=function(t,e,n){var r=this,i=n(t,r.key);return(r=0>i?r.rt(null,null,null,r.left.it(t,e,n),null):0===i?r.rt(null,e,null,null,null):r.rt(null,null,null,null,r.right.it(t,e,n))).At()},t.prototype.Pt=function(){if(this.left.U())return t.EMPTY;var e=this;return e.left.Vt()||e.left.left.Vt()||(e=e.gt()),(e=e.rt(null,null,null,e.left.Pt(),null)).At()},t.prototype.remove=function(e,n){var r,i=this;if(0>n(e,i.key))i.left.U()||i.left.Vt()||i.left.left.Vt()||(i=i.gt()),i=i.rt(null,null,null,i.left.remove(e,n),null);else{if(i.left.Vt()&&(i=i.pt()),i.right.U()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===n(e,i.key)){if(i.right.U())return t.EMPTY;r=i.right.min(),i=i.rt(r.key,r.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(e,n))}return i.At()},t.prototype.Vt=function(){return this.color},t.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.pt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},t.prototype.gt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.pt())).bt()).vt()),t},t.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.pt()).vt()),t},t.prototype.bt=function(){var e=this.rt(null,null,t.RED,null,this.right.left);return this.right.rt(null,null,this.color,e,null)},t.prototype.pt=function(){var e=this.rt(null,null,t.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,e)},t.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},t.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},t.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw G(\"Red node has red child(\"+this.key+\",\"+this.value+\")\");if(this.right.Vt())throw G(\"Right child of (\"+this.key+\",\"+this.value+\") is red\");var t=this.left.Dt();if(t!==this.right.Dt())throw G(\"Black depths differ\");return t+(this.Vt()?0:1)},t}();Re.EMPTY=null,Re.RED=!0,Re.ot=!1,Re.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,\"key\",{get:function(){throw G(\"LLRBEmptyNode has no key.\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"value\",{get:function(){throw G(\"LLRBEmptyNode has no value.\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"color\",{get:function(){throw G(\"LLRBEmptyNode has no color.\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"left\",{get:function(){throw G(\"LLRBEmptyNode has no left child.\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"right\",{get:function(){throw G(\"LLRBEmptyNode has no right child.\")},enumerable:!0,configurable:!0}),t.prototype.rt=function(){return this},t.prototype.it=function(t,e){return new Re(t,e)},t.prototype.remove=function(){return this},t.prototype.U=function(){return!0},t.prototype.ut=function(){return!1},t.prototype.ct=function(){return!1},t.prototype.ht=function(){return null},t.prototype.at=function(){return null},t.prototype.Vt=function(){return!1},t.prototype.St=function(){return!0},t.prototype.Dt=function(){return 0},t}());\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar Le=function(){function t(t){this.F=t,this.data=new xe(this.F)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ht()},t.prototype.last=function(){return this.data.at()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut(function(e){return t(e),!1})},t.prototype.Ct=function(t,e){for(var n,r=this.data.lt(t[0]);r.It();){if(n=r.wt(),0<=this.F(n.key,t[1]))return;e(n.key)}},t.prototype.kt=function(t,e){var n;for(n=void 0===e?this.data._t():this.data.lt(e);n.It();)if(!t(n.wt().key))return},t.prototype.Nt=function(t){var e=this.data.lt(t);return e.It()?e.wt().key:null},t.prototype._t=function(){return new Ce(this.data._t())},t.prototype.lt=function(t){return new Ce(this.data.lt(t))},t.prototype.add=function(t){return this.rt(this.data.remove(t).it(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},t.prototype.U=function(){return this.data.U()},t.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.It();){var i=n.wt().key,o=r.wt().key;if(0!==this.F(i,o))return!1}return!0},t.prototype.j=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),\"SortedSet(\"+t.toString()+\")\"},t.prototype.rt=function(e){var n=new t(this.F);return n.data=e,n},t}(),Ce=function(){function t(t){this.$t=t}return t.prototype.wt=function(){return this.$t.wt().key},t.prototype.It=function(){return this.$t.It()},t}(),Pe=function(){function t(t){this.Mt=t}return t.fromBase64String=function(e){return new t(Fn.Lt().atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e=\"\",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return Fn.Lt().btoa(this.Mt)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Mt)},t.prototype.Ot=function(){return 2*this.Mt.length},t.prototype.D=function(t){return K(this.Mt,t.Mt)},t.prototype.isEqual=function(t){return this.Mt===t.Mt},t}();Pe.xt=new Pe(\"\");var Ve=new RegExp(/^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.(\\d+))?Z$/),Ue=function(){function t(){}return t.prototype.Bt=function(t,e){return function(t,e){var n={fields:{__type__:{stringValue:\"server_timestamp\"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(e,t)},t.prototype.Ut=function(t,e){return e},t.prototype.qt=function(){return null},t.prototype.isEqual=function(e){return e instanceof t},t}();Ue.instance=new Ue;var Me=function(){function t(t){this.elements=t}return t.prototype.Bt=function(t){return this.apply(t)},t.prototype.Ut=function(t){return this.apply(t)},t.prototype.apply=function(t){for(var e=A(t),n=function(t){e.some(function(e){return l(e,t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.qt=function(){return null},t.prototype.isEqual=function(e){return e instanceof t&&W(this.elements,e.elements,l)},t}(),je=function(){function t(t){this.elements=t}return t.prototype.Bt=function(t){return this.apply(t)},t.prototype.Ut=function(t){return this.apply(t)},t.prototype.apply=function(t){for(var e=A(t),n=function(t){e=e.filter(function(e){return!l(e,t)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.qt=function(){return null},t.prototype.isEqual=function(e){return e instanceof t&&W(this.elements,e.elements,l)},t}(),Fe=function(){function t(t,e){this.serializer=t,this.Qt=e}return t.prototype.Bt=function(t){var e=this.qt(t),n=this.asNumber(e)+this.asNumber(this.Qt);return _(e)&&_(this.Qt)?this.serializer.Wt(n):this.serializer.jt(n)},t.prototype.Ut=function(t,e){return e},t.prototype.qt=function(t){return _(e=t)||e&&\"doubleValue\"in e?t:{integerValue:0};var e},t.prototype.isEqual=function(e){return e instanceof t&&l(this.Qt,e.Qt)},t.prototype.asNumber=function(t){return g(t.integerValue||t.doubleValue)},t}(),qe=function(){function t(t){this.fields=t}return t.Kt=function(e){return new t(e)},t.Gt=function(e){var n=new Le(De.F);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.zt=function(t){var e=!1;return this.fields.forEach(function(n){n.q(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),Be=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),Ge=function(t,e){this.version=t,this.transformResults=e},ze=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,\"Ht\",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Jt=function(t){return void 0===this.updateTime?void 0===this.exists||this.exists===t instanceof tn:t instanceof tn&&t.version.isEqual(this.updateTime)},t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();ze.NONE=new ze;var Ke=function(){function t(){}return t.prototype.Yt=function(){},t.Xt=function(t){return t instanceof tn?t.version:Ie.MIN},t}(),We=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Zt=r,i.type=0,i}return ae.__extends(e,t),e.prototype.Ut=function(t,e){this.Yt(t);var n=e.version;return new tn(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.Bt=function(t){if(this.Yt(t),!this.Zt.Jt(t))return t;var e=Ke.Xt(t);return new tn(this.key,e,this.value,{te:!0})},e.prototype.ee=function(){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},e}(Ke),He=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.se=r,o.Zt=i,o.type=1,o}return ae.__extends(e,t),e.prototype.Ut=function(t,e){if(this.Yt(t),!this.Zt.Jt(t))return new nn(this.key,e.version);var n=this.ne(t);return new tn(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.Bt=function(t){if(this.Yt(t),!this.Zt.Jt(t))return t;var e=Ke.Xt(t),n=this.ne(t);return new tn(this.key,e,n,{te:!0})},e.prototype.ee=function(){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},e.prototype.ne=function(t){var e;return e=t instanceof tn?t.data():Qe.EMPTY,this.ie(e)},e.prototype.ie=function(t){var e=this,n=t.re();return this.se.fields.forEach(function(t){if(!t.U()){var r=e.data.field(t);null===r?n.delete(t):n.set(t,r)}}),n.oe()},e}(Ke),Ye=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Zt=ze.exists(!0),r}return ae.__extends(e,t),e.prototype.Ut=function(t,e){if(this.Yt(t),z(null!=e.transformResults,\"Transform results missing for TransformMutation.\"),!this.Zt.Jt(t))return new nn(this.key,e.version);var n=this.he(t),r=this.ae(t,e.transformResults),i=e.version,o=this.ue(n.data(),r);return new tn(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.Bt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var r=this.he(t),i=this.ce(n,t,e),o=this.ue(r.data(),i);return new tn(this.key,r.version,o,{te:!0})},e.prototype.ee=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof tn?t.field(i.field):void 0,s=i.transform.qt(o||null);null!=s&&(e=null==e?Qe._e().set(i.field,s):e.set(i.field,s))}return e?e.oe():null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&W(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},e.prototype.he=function(t){return t},e.prototype.ae=function(t,e){var n=[];z(this.fieldTransforms.length===e.length,\"server transform result count (\"+e.length+\") should match field transform count (\"+this.fieldTransforms.length+\")\");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof tn&&(s=t.field(i.field)),n.push(o.Ut(s,e[r]))}return n},e.prototype.ce=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof tn&&(a=e.field(s.field)),null===a&&n instanceof tn&&(a=n.field(s.field)),r.push(u.Bt(a,t))}return r},e.prototype.ue=function(t,e){for(var n,r=t.re(),i=0;i<this.fieldTransforms.length;i++)n=this.fieldTransforms[i].field,r.set(n,e[i]);return r.oe()},e}(Ke),Xe=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Zt=n,r.type=3,r}return ae.__extends(e,t),e.prototype.Ut=function(t,e){return this.Yt(t),new en(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.Bt=function(t){return this.Yt(t),this.Zt.Jt(t)?new en(this.key,Ie.S()):t},e.prototype.ee=function(){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},e}(Ke),Je=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Zt=n,r.type=4,r}return ae.__extends(e,t),e.prototype.Ut=function(){G(\"VerifyMutation should only be used in Transactions.\")},e.prototype.Bt=function(){G(\"VerifyMutation should only be used in Transactions.\")},e.prototype.ee=function(){G(\"VerifyMutation should only be used in Transactions.\")},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},e}(Ke),Qe=function(){function t(t){this.proto=t}return t._e=function(){return t.EMPTY.re()},t.prototype.field=function(t){if(t.U())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!N(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.B()])||null},t.prototype.se=function(){return this.le(this.proto.mapValue)},t.prototype.le=function(t){var e=this,n=new Le(De.F);return i(t.fields||{},function(t,r){var i=new De([t]);if(10===f(r)){var o=e.le(r.mapValue).fields;o.U()?n=n.add(i):o.forEach(function(t){n=n.add(i.child(t))})}else n=n.add(i)}),qe.Kt(n)},t.prototype.isEqual=function(t){return l(this.proto,t.proto)},t.prototype.re=function(){return new Ze(this)},t}();Qe.EMPTY=new Qe({mapValue:{}});var Ze=function(){function t(t){this.de=t,this.fe=new Map}return t.prototype.set=function(t,e){return this.Te(t,e),this},t.prototype.delete=function(t){return this.Te(t,null),this},t.prototype.Te=function(t,e){for(var n=this.fe,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===f(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.B(),e)},t.prototype.oe=function(){var t=this.me(De.H,this.fe);return null==t?this.de:new Qe(t)},t.prototype.me=function(t,e){var n=this,r=!1,i=this.de.field(t),o=N(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.me(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null===e?o.hasOwnProperty(i)&&(delete o[i],r=!0):(o[i]=e,r=!0)}),r?{mapValue:{fields:o}}:null},t}(),$e=function(){function t(t,e){this.key=t,this.version=e}return t.Ee=function(t,e){return ke.F(t.key,e.key)},t}(),tn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).we=r,o.te=!!i.te,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return ae.__extends(e,t),e.prototype.field=function(t){return this.we.field(t)},e.prototype.data=function(){return this.we},e.prototype.Ie=function(){return this.we.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},e.prototype.toString=function(){return\"Document(\"+this.key+\", \"+this.version+\", \"+this.we.toString()+\", {hasLocalMutations: \"+this.te+\"}), {hasCommittedMutations: \"+this.hasCommittedMutations+\"})\"},Object.defineProperty(e.prototype,\"hasPendingWrites\",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.Re=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?d(r,i):G(\"Trying to compare documents on fields that don't exist\")},e}($e),en=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=r&&r.hasCommittedMutations,i}return ae.__extends(e,t),e.prototype.toString=function(){return\"NoDocument(\"+this.key+\", \"+this.version+\")\"},Object.defineProperty(e.prototype,\"hasPendingWrites\",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}($e),nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ae.__extends(e,t),e.prototype.toString=function(){return\"UnknownDocument(\"+this.key+\", \"+this.version+\")\"},Object.defineProperty(e.prototype,\"hasPendingWrites\",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}($e),rn=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Ae=null}return t.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.K();null!==this.collectionGroup&&(t+=\"|cg:\"+this.collectionGroup),t+=\"|f:\",t+=this.filters.map(function(t){return t.canonicalId()}).join(\",\"),t+=\"|ob:\",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(\",\"),s(this.limit)||(t+=\"|l:\",t+=this.limit),this.startAt&&(t+=\"|lb:\",t+=this.startAt.canonicalId()),this.endAt&&(t+=\"|ub:\",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},t.prototype.toString=function(){var t=this.path.K();return null!==this.collectionGroup&&(t+=\" collectionGroup=\"+this.collectionGroup),0<this.filters.length&&(t+=\", filters: [\"+this.filters.join(\", \")+\"]\"),s(this.limit)||(t+=\", limit: \"+this.limit),0<this.orderBy.length&&(t+=\", orderBy: [\"+this.orderBy.join(\", \")+\"]\"),this.startAt&&(t+=\", startAt: \"+this.startAt.canonicalId()),this.endAt&&(t+=\", endAt: \"+this.endAt.canonicalId()),\"Target(\"+t+\")\"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!(null===this.startAt?null!==t.startAt:!this.startAt.isEqual(t.startAt))&&(null===this.endAt?null===t.endAt:this.endAt.isEqual(t.endAt))},t.prototype.Pe=function(){return ke.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),on=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=\"F\"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=r,this.limit=i,this.ge=o,this.startAt=s,this.endAt=u,this.pe=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}return t.ve=function(e){return new t(e)},Object.defineProperty(t.prototype,\"orderBy\",{get:function(){if(null===this.pe){var t=this.Se(),e=this.De();if(null!==t&&null===e)this.pe=t.Y()?[gn]:[new mn(t),gn];else{this.pe=[];for(var n,r=!1,i=0,o=this.Ve;i<o.length;i++)n=o[i],this.pe.push(n),n.field.Y()&&(r=!0);if(!r){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:pn.ASCENDING;this.pe.push(s===pn.ASCENDING?gn:wn)}}}return this.pe},enumerable:!0,configurable:!0}),t.prototype.Ce=function(e){var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.Ve.slice(),n,this.limit,this.ge,this.startAt,this.endAt)},t.prototype.ke=function(e){var n=this.Ve.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.ge,this.startAt,this.endAt)},t.prototype.Ne=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),e,\"F\",this.startAt,this.endAt)},t.prototype.Fe=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),e,\"L\",this.startAt,this.endAt)},t.prototype.$e=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,e,this.endAt)},t.prototype.Me=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,this.startAt,e)},t.prototype.Le=function(e){return new t(e,null,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,this.startAt,this.endAt)},t.prototype.Oe=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.Y())},t.prototype.canonicalId=function(){return this.xe().canonicalId()+\"|lt:\"+this.ge},t.prototype.toString=function(){return\"Query(target=\"+this.xe().toString()+\"; limitType=\"+this.ge+\")\"},t.prototype.isEqual=function(t){return this.xe().isEqual(t.xe())&&this.ge===t.ge},t.prototype.Be=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},t.prototype.matches=function(t){return this.Ue(t)&&this.qe(t)&&this.Qe(t)&&this.We(t)},t.prototype.je=function(){return!s(this.limit)&&\"F\"===this.ge},t.prototype.Ke=function(){return!s(this.limit)&&\"L\"===this.ge},t.prototype.De=function(){return 0<this.Ve.length?this.Ve[0].field:null},t.prototype.Se=function(){for(var t,e=0,n=this.filters;e<n.length;e++)if((t=n[e])instanceof un&&t.Ge())return t.field;return null},t.prototype.ze=function(t){for(var e,n=0,r=this.filters;n<r.length;n++)if((e=r[n])instanceof un&&0<=t.indexOf(e.op))return e.op;return null},t.prototype.Pe=function(){return this.xe().Pe()},t.prototype.He=function(){return null!==this.collectionGroup},t.prototype.xe=function(){if(!this.ye)if(\"F\"===this.ge)this.ye=new rn(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===pn.DESCENDING?pn.ASCENDING:pn.DESCENDING;t.push(new mn(r.field,i))}var o=this.endAt?new vn(this.endAt.position,!this.endAt.before):null,s=this.startAt?new vn(this.startAt.position,!this.startAt.before):null;this.ye=new rn(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},t.prototype.Ue=function(t){var e=t.key.path;return null===this.collectionGroup?ke.st(this.path)?this.path.isEqual(e):this.path.W(e):t.key.et(this.collectionGroup)&&this.path.q(e)},t.prototype.qe=function(t){for(var e,n=0,r=this.Ve;n<r.length;n++)if(!(e=r[n]).field.Y()&&null===t.field(e.field))return!1;return!0},t.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.We=function(t){return!(this.startAt&&!this.startAt.Je(this.orderBy,t)||this.endAt&&this.endAt.Je(this.orderBy,t))},t.prototype.be=function(){},t}(),sn=function(){function t(t){this.name=t}return t.G=function(e){return\"<\"===e?t.LESS_THAN:\"<=\"===e?t.LESS_THAN_OR_EQUAL:\"==\"===e?t.EQUAL:\">=\"===e?t.GREATER_THAN_OR_EQUAL:\">\"===e?t.GREATER_THAN:\"array-contains\"===e?t.ARRAY_CONTAINS:\"in\"===e?t.IN:\"array-contains-any\"===e?t.ARRAY_CONTAINS_ANY:G(\"Unknown FieldFilter operator: \"+e)},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t}();\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */sn.LESS_THAN=new sn(\"<\"),sn.LESS_THAN_OR_EQUAL=new sn(\"<=\"),sn.EQUAL=new sn(\"==\"),sn.GREATER_THAN=new sn(\">\"),sn.GREATER_THAN_OR_EQUAL=new sn(\">=\"),sn.ARRAY_CONTAINS=new sn(\"array-contains\"),sn.IN=new sn(\"in\"),sn.ARRAY_CONTAINS_ANY=new sn(\"array-contains-any\");var un=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return ae.__extends(e,t),e.create=function(t,n,r){if(t.Y())return n===sn.IN?new hn(t,r):new an(t,n,r);if(T(r)){if(n!==sn.EQUAL)throw new me(ve.INVALID_ARGUMENT,\"Invalid query. Null supports only equality comparisons.\");return new e(t,n,r)}if(I(r)){if(n!==sn.EQUAL)throw new me(ve.INVALID_ARGUMENT,\"Invalid query. NaN supports only equality comparisons.\");return new e(t,n,r)}return n===sn.ARRAY_CONTAINS?new cn(t,r):n===sn.IN?new fn(t,r):n===sn.ARRAY_CONTAINS_ANY?new ln(t,r):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&f(this.value)===f(e)&&this.Ye(d(e,this.value))},e.prototype.Ye=function(t){switch(this.op){case sn.LESS_THAN:return 0>t;case sn.LESS_THAN_OR_EQUAL:return 0>=t;case sn.EQUAL:return 0===t;case sn.GREATER_THAN:return 0<t;case sn.GREATER_THAN_OR_EQUAL:return 0<=t;default:return G(\"Unknown FieldFilter operator: \"+this.op)}},e.prototype.Ge=function(){return 0<=[sn.LESS_THAN,sn.LESS_THAN_OR_EQUAL,sn.GREATER_THAN,sn.GREATER_THAN_OR_EQUAL].indexOf(this.op)},e.prototype.canonicalId=function(){return this.field.K()+this.op.toString()+v(this.value)},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&l(this.value,t.value)},e.prototype.toString=function(){return this.field.K()+\" \"+this.op+\" \"+v(this.value)},e}(function(){}),an=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ke.tt(r.referenceValue),i}return ae.__extends(e,t),e.prototype.matches=function(t){var e=ke.F(t.key,this.key);return this.Ye(e)},e}(un),hn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,sn.IN,n)||this).keys=(n.arrayValue.values||[]).map(function(t){return ke.tt(t.referenceValue)}),r}return ae.__extends(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(un),cn=function(t){function e(e,n){return t.call(this,e,sn.ARRAY_CONTAINS,n)||this}return ae.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return E(e)&&p(e.arrayValue,this.value)},e}(un),fn=function(t){function e(e,n){return t.call(this,e,sn.IN,n)||this}return ae.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&p(this.value.arrayValue,e)},e}(un),ln=function(t){function e(e,n){return t.call(this,e,sn.ARRAY_CONTAINS_ANY,n)||this}return ae.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return E(n)&&n.arrayValue.values&&n.arrayValue.values.some(function(t){return p(e.value.arrayValue,t)})},e}(un),pn=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t}();pn.ASCENDING=new pn(\"asc\"),pn.DESCENDING=new pn(\"desc\");var dn,yn,vn=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){return(this.before?\"b\":\"a\")+\":\"+this.position.map(function(t){return v(t)}).join(\",\")},t.prototype.Je=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.Y()?ke.F(ke.tt(o.referenceValue),e.key):d(o,e.field(i.field)),i.dir===pn.DESCENDING&&(n*=-1),0!==n)break}return this.before?0>=n:0>n},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!l(this.position[e],t.position[e]))return!1;return!0},t}(),mn=function(){function t(t,e){this.field=t,void 0===e&&(e=pn.ASCENDING),this.dir=e,this.Xe=t.Y()}return t.prototype.compare=function(t,e){var n=this.Xe?tn.Ee(t,e):tn.Re(this.field,t,e);switch(this.dir){case pn.ASCENDING:return n;case pn.DESCENDING:return-1*n;default:return G(\"Unknown direction: \"+this.dir)}},t.prototype.canonicalId=function(){return this.field.K()+this.dir.toString()},t.prototype.toString=function(){return this.field.K()+\" (\"+this.dir+\")\"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),gn=new mn(De.X(),pn.ASCENDING),wn=new mn(De.X(),pn.DESCENDING),bn=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Ie.MIN),void 0===o&&(o=Ie.MIN),void 0===s&&(s=Pe.xt),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=r,this.ts=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.es=function(e){return new t(this.target,this.targetId,this.Ze,e,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.ss=function(e,n){return new t(this.target,this.targetId,this.Ze,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.ns=function(e){return new t(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,e,this.resumeToken)},t}(),_n=function(t){this.count=t};(yn=dn||(dn={}))[yn.OK=0]=\"OK\",yn[yn.CANCELLED=1]=\"CANCELLED\",yn[yn.UNKNOWN=2]=\"UNKNOWN\",yn[yn.INVALID_ARGUMENT=3]=\"INVALID_ARGUMENT\",yn[yn.DEADLINE_EXCEEDED=4]=\"DEADLINE_EXCEEDED\",yn[yn.NOT_FOUND=5]=\"NOT_FOUND\",yn[yn.ALREADY_EXISTS=6]=\"ALREADY_EXISTS\",yn[yn.PERMISSION_DENIED=7]=\"PERMISSION_DENIED\",yn[yn.UNAUTHENTICATED=16]=\"UNAUTHENTICATED\",yn[yn.RESOURCE_EXHAUSTED=8]=\"RESOURCE_EXHAUSTED\",yn[yn.FAILED_PRECONDITION=9]=\"FAILED_PRECONDITION\",yn[yn.ABORTED=10]=\"ABORTED\",yn[yn.OUT_OF_RANGE=11]=\"OUT_OF_RANGE\",yn[yn.UNIMPLEMENTED=12]=\"UNIMPLEMENTED\",yn[yn.INTERNAL=13]=\"INTERNAL\",yn[yn.UNAVAILABLE=14]=\"UNAVAILABLE\",yn[yn.DATA_LOSS=15]=\"DATA_LOSS\";\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar En=new xe(ke.F),Tn=new xe(ke.F),In=new xe(ke.F),Nn=new Le(ke.F),An=new Le(K),Sn=function(){function t(t){this.F=t?function(e,n){return t(e,n)||ke.F(e.key,n.key)}:function(t,e){return ke.F(t.key,e.key)},this.rs=O(),this.os=new xe(this.F)}return t.hs=function(e){return new t(e.F)},t.prototype.has=function(t){return null!=this.rs.get(t)},t.prototype.get=function(t){return this.rs.get(t)},t.prototype.first=function(){return this.os.ht()},t.prototype.last=function(){return this.os.at()},t.prototype.U=function(){return this.os.U()},t.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.os.indexOf(e):-1},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.os.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.os.ut(function(e){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.it(t.key,t),e.os.it(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.os.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.os._t(),r=e.os._t();n.It();){var i=n.wt().key,o=r.wt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?\"DocumentSet ()\":\"DocumentSet (\\n  \"+t.join(\"  \\n\")+\"\\n)\"},t.prototype.rt=function(e,n){var r=new t;return r.F=this.F,r.rs=e,r.os=n,r},t}(),Dn=function(){function t(){this.as=new xe(ke.F)}return t.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);n?0!==t.type&&3===n.type?this.as=this.as.it(e,t):3===t.type&&1!==n.type?this.as=this.as.it(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.it(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.it(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.it(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.it(e,{type:2,doc:t.doc}):G(\"unsupported combination of changes: \"+JSON.stringify(t)+\" after \"+JSON.stringify(n)):this.as=this.as.it(e,t)},t.prototype.us=function(){var t=[];return this.as.ut(function(e,n){t.push(n)}),t},t}(),kn=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=r,this._s=i,this.fromCache=o,this.ls=s,this.ds=u}return t.fs=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Sn.hs(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return!this._s.U()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ls===t.ls&&this._s.isEqual(t._s)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),xn=function(){function t(t,e,n,r,i){this.ts=t,this.Ts=e,this.ms=n,this.Es=r,this.ws=i}return t.Is=function(e,n){var r=new Map;return r.set(e,On.Rs(e,n)),new t(Ie.MIN,r,C(),k(),L())},t}(),On=function(){function t(t,e,n,r,i){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=r,this.gs=i}return t.Rs=function(e,n){return new t(Pe.xt,n,L(),L(),L())},t}(),Rn=function(t,e,n,r){this.ps=t,this.removedTargetIds=e,this.key=n,this.ys=r},Ln=function(t,e){this.targetId=t,this.bs=e},Cn=function(t,e,n,r){void 0===n&&(n=Pe.xt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Pn=function(){function t(){this.vs=0,this.Ss=V(),this.Ds=Pe.xt,this.Cs=!1,this.ks=!0}return Object.defineProperty(t.prototype,\"As\",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"resumeToken\",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"Ns\",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"Fs\",{get:function(){return this.ks},enumerable:!0,configurable:!0}),t.prototype.$s=function(t){0<t.Ot()&&(this.ks=!0,this.Ds=t)},t.prototype.Ms=function(){var t=L(),e=L(),n=L();return this.Ss.forEach(function(r,i){0===i?t=t.add(r):2===i?e=e.add(r):1===i?n=n.add(r):G(\"Encountered invalid change type: \"+i)}),new On(this.Ds,this.Cs,t,e,n)},t.prototype.Ls=function(){this.ks=!1,this.Ss=V()},t.prototype.Os=function(t,e){this.ks=!0,this.Ss=this.Ss.it(t,e)},t.prototype.xs=function(t){this.ks=!0,this.Ss=this.Ss.remove(t)},t.prototype.Bs=function(){this.vs+=1},t.prototype.Us=function(){this.vs-=1},t.prototype.qs=function(){this.ks=!0,this.Cs=!0},t}(),Vn=function(){function t(t){this.Qs=t,this.Ws=new Map,this.js=k(),this.Ks=P(),this.Gs=new Le(K)}return t.prototype.zs=function(t){for(var e,n=0,r=t.ps;n<r.length;n++)e=r[n],t.ys instanceof tn?this.Hs(e,t.ys):t.ys instanceof en&&this.Js(e,t.key,t.ys);for(var i,o=0,s=t.removedTargetIds;o<s.length;o++)i=s[o],this.Js(i,t.key,t.ys)},t.prototype.Ys=function(t){var e=this;this.Xs(t,function(n){var r=e.Zs(n);switch(t.state){case 0:e.tn(n)&&r.$s(t.resumeToken);break;case 1:r.Us(),r.Ns||r.Ls(),r.$s(t.resumeToken);break;case 2:r.Us(),r.Ns||e.removeTarget(n);break;case 3:e.tn(n)&&(r.qs(),r.$s(t.resumeToken));break;case 4:e.tn(n)&&(e.en(n),r.$s(t.resumeToken));break;default:G(\"Unknown target watch change state: \"+t.state)}})},t.prototype.Xs=function(t,e){var n=this;0<t.targetIds.length?t.targetIds.forEach(e):this.Ws.forEach(function(t,r){n.tn(r)&&e(r)})},t.prototype.sn=function(t){var e=t.targetId,n=t.bs.count,r=this.nn(e);if(r){var i=r.target;if(i.Pe())if(0===n){var o=new ke(i.path);this.Js(e,o,new en(o,Ie.S()))}else z(1===n,\"Single document existence filter with count: \"+n);else this.in(e)!==n&&(this.en(e),this.Gs=this.Gs.add(e))}},t.prototype.rn=function(t){var e=this,n=new Map;this.Ws.forEach(function(r,i){var o=e.nn(i);if(o){if(r.As&&o.target.Pe()){var s=new ke(o.target.path);null!==e.js.get(s)||e.on(i,s)||e.Js(i,s,new en(s,t))}r.Fs&&(n.set(i,r.Ms()),r.Ls())}});var r=L();this.Ks.forEach(function(t,n){var i=!0;n.kt(function(t){var n=e.nn(t);return!n||2===n.Ze||(i=!1,!1)}),i&&(r=r.add(t))});var i=new xn(t,n,this.Gs,this.js,r);return this.js=k(),this.Ks=P(),this.Gs=new Le(K),i},t.prototype.Hs=function(t,e){if(this.tn(t)){var n=this.on(t,e.key)?2:0;this.Zs(t).Os(e.key,n),this.js=this.js.it(e.key,e),this.Ks=this.Ks.it(e.key,this.hn(e.key).add(t))}},t.prototype.Js=function(t,e,n){if(this.tn(t)){var r=this.Zs(t);this.on(t,e)?r.Os(e,1):r.xs(e),this.Ks=this.Ks.it(e,this.hn(e).delete(t)),n&&(this.js=this.js.it(e,n))}},t.prototype.removeTarget=function(t){this.Ws.delete(t)},t.prototype.in=function(t){var e=this.Zs(t).Ms();return this.Qs.an(t).size+e.Ps.size-e.gs.size},t.prototype.Bs=function(t){this.Zs(t).Bs()},t.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new Pn,this.Ws.set(t,e)),e},t.prototype.hn=function(t){var e=this.Ks.get(t);return e||(e=new Le(K),this.Ks=this.Ks.it(t,e)),e},t.prototype.tn=function(t){var e=null!==this.nn(t);return e||F(\"WatchChangeAggregator\",\"Detected inactive target\",t),e},t.prototype.nn=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.un(t)},t.prototype.en=function(t){var e=this;this.Ws.set(t,new Pn),this.Qs.an(t).forEach(function(n){e.Js(t,n,null)})},t.prototype.on=function(t,e){return this.Qs.an(t).has(e)},t}(),Un=function(){var t={};return t[pn.ASCENDING.name]=\"ASCENDING\",t[pn.DESCENDING.name]=\"DESCENDING\",t}(),Mn=function(){var t={};return t[sn.LESS_THAN.name]=\"LESS_THAN\",t[sn.LESS_THAN_OR_EQUAL.name]=\"LESS_THAN_OR_EQUAL\",t[sn.GREATER_THAN.name]=\"GREATER_THAN\",t[sn.GREATER_THAN_OR_EQUAL.name]=\"GREATER_THAN_OR_EQUAL\",t[sn.EQUAL.name]=\"EQUAL\",t[sn.ARRAY_CONTAINS.name]=\"ARRAY_CONTAINS\",t[sn.IN.name]=\"IN\",t[sn.ARRAY_CONTAINS_ANY.name]=\"ARRAY_CONTAINS_ANY\",t}(),jn=function(){function t(t,e){this.cn=t,this.options=e}return t.prototype._n=function(t){var e=void 0===t.code?ve.UNKNOWN:D(t.code);return new me(e,t.message||\"\")},t.prototype.ln=function(t){return this.options.dn||s(t)?t:{value:t}},t.prototype.fn=function(t){var e;return s(e=\"object\"==typeof t?t.value:t)?null:e},t.prototype.Wt=function(t){return{integerValue:\"\"+t}},t.prototype.jt=function(t){if(this.options.dn){if(isNaN(t))return{doubleValue:\"NaN\"};if(t===1/0)return{doubleValue:\"Infinity\"};if(t===-1/0)return{doubleValue:\"-Infinity\"}}return{doubleValue:u(t)?\"-0\":t}},t.prototype.Tn=function(t){return a(t)?this.Wt(t):this.jt(t)},t.prototype.k=function(t){return this.options.dn?new Date(1e3*t.seconds).toISOString().replace(/\\.\\d*/,\"\").replace(\"Z\",\"\")+\".\"+(\"000000000\"+t.nanoseconds).slice(-9)+\"Z\":{seconds:\"\"+t.seconds,nanos:t.nanoseconds}},t.prototype.v=function(t){var e=m(t);return new Te(e.seconds,e.nanos)},t.prototype.mn=function(t){return this.options.dn?t.toBase64():t.toUint8Array()},t.prototype.En=function(t){return this.options.dn?(z(void 0===t||\"string\"==typeof t,\"value must be undefined or a string when using proto3 Json\"),Pe.fromBase64String(t||\"\")):(z(void 0===t||t instanceof Uint8Array,\"value must be undefined or Uint8Array\"),Pe.fromUint8Array(t||new Uint8Array))},t.prototype.toVersion=function(t){return this.k(t.k())},t.prototype.fromVersion=function(t){return z(!!t,\"Trying to deserialize version that isn't set\"),Ie.v(this.v(t))},t.prototype.wn=function(t,e){return this.In(e||this.cn).child(\"documents\").child(t).K()},t.prototype.Rn=function(t){var e=Ae.G(t);return z(U(e),\"Tried to deserialize invalid key \"+e.toString()),e},t.prototype.An=function(t){return this.wn(t.path)},t.prototype.tt=function(t){var e=this.Rn(t);return z(e.get(1)===this.cn.projectId,\"Tried to deserialize key from different project: \"+e.get(1)+\" vs \"+this.cn.projectId),z(!e.get(3)&&!this.cn.database||e.get(3)===this.cn.database,\"Tried to deserialize key from different database: \"+e.get(3)+\" vs \"+this.cn.database),new ke(this.Pn(e))},t.prototype.Vn=function(t){return this.wn(t)},t.prototype.gn=function(t){var e=this.Rn(t);return 4===e.length?Ae.H:this.Pn(e)},Object.defineProperty(t.prototype,\"pn\",{get:function(){return new Ae([\"projects\",this.cn.projectId,\"databases\",this.cn.database]).K()},enumerable:!0,configurable:!0}),t.prototype.In=function(t){return new Ae([\"projects\",t.projectId,\"databases\",t.database])},t.prototype.Pn=function(t){return z(4<t.length&&\"documents\"===t.get(4),\"tried to deserialize invalid key \"+t.toString()),t.M(5)},t.prototype.yn=function(t,e){return{name:this.An(t),fields:e.proto.mapValue.fields}},t.prototype.bn=function(t){return{name:this.An(t.key),fields:t.Ie().mapValue.fields,updateTime:this.k(t.version.k())}},t.prototype.vn=function(t,e){var n=this.tt(t.name),r=this.fromVersion(t.updateTime),i=new Qe({mapValue:{fields:t.fields}});return new tn(n,r,i,{hasCommittedMutations:!!e})},t.prototype.Sn=function(t){z(!!t.found,\"Tried to deserialize a found document from a missing document.\"),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),r=new Qe({mapValue:{fields:t.found.fields}});return new tn(e,n,r,{})},t.prototype.Dn=function(t){z(!!t.missing,\"Tried to deserialize a missing document from a found document.\"),z(!!t.readTime,\"Tried to deserialize a missing document without a read time.\");var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new en(e,n)},t.prototype.Cn=function(t){return\"found\"in t?this.Sn(t):\"missing\"in t?this.Dn(t):G(\"invalid batch get response: \"+JSON.stringify(t))},t.prototype.kn=function(t){var e;if(\"targetChange\"in t){t.targetChange;var n=this.Nn(t.targetChange.targetChangeType||\"NO_CHANGE\"),r=t.targetChange.targetIds||[],i=this.En(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this._n(o);e=new Cn(n,r,i,s||null)}else if(\"documentChange\"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.tt(u.document.name),h=this.fromVersion(u.document.updateTime),c=new Qe({mapValue:{fields:u.document.fields}}),f=new tn(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new Rn(l,p,f.key,f)}else if(\"documentDelete\"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.tt(d.document),v=d.readTime?this.fromVersion(d.readTime):Ie.S(),m=new en(y,v),g=d.removedTargetIds||[];e=new Rn([],g,m.key,m)}else if(\"documentRemove\"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.tt(w.document),_=w.removedTargetIds||[];e=new Rn([],_,b,null)}else{if(!(\"filter\"in t))return G(\"Unknown change type \"+JSON.stringify(t));t.filter;var E=t.filter;E.targetId;var T=E.count||0,I=new _n(T),N=E.targetId;e=new Ln(N,I)}return e},t.prototype.Nn=function(t){return\"NO_CHANGE\"===t?0:\"ADD\"===t?1:\"REMOVE\"===t?2:\"CURRENT\"===t?3:\"RESET\"===t?4:G(\"Got unexpected TargetChange.state: \"+t)},t.prototype.Fn=function(t){if(!(\"targetChange\"in t))return Ie.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ie.MIN:e.readTime?this.fromVersion(e.readTime):Ie.MIN},t.prototype.$n=function(t){var e,n=this;if(t instanceof We)e={update:this.yn(t.key,t.value)};else if(t instanceof Xe)e={delete:this.An(t.key)};else if(t instanceof He)e={update:this.yn(t.key,t.data),updateMask:this.Mn(t.se)};else if(t instanceof Ye)e={transform:{document:this.An(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ln(t)})}};else{if(!(t instanceof Je))return G(\"Unknown mutation type \"+t.type);e={verify:this.An(t.key)}}return t.Zt.Ht||(e.currentDocument=this.On(t.Zt)),e},t.prototype.xn=function(t){var e=this,n=t.currentDocument?this.Bn(t.currentDocument):ze.NONE;if(t.update){t.update.name;var r=this.tt(t.update.name),i=new Qe({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.Un(t.updateMask);return new He(r,i,o,n)}return new We(r,i,n)}if(t.delete){var s=this.tt(t.delete);return new Xe(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.qn(t)});return z(!0===n.exists,'Transforms only support precondition \"exists == true\"'),new Ye(u,a)}if(t.verify){var h=this.tt(t.verify);return new Je(h,n)}return G(\"unknown mutation proto: \"+JSON.stringify(t))},t.prototype.On=function(t){return void 0===t.updateTime?void 0===t.exists?G(\"Unknown precondition\"):{exists:t.exists}:{updateTime:this.toVersion(t.updateTime)}},t.prototype.Bn=function(t){return void 0===t.updateTime?void 0===t.exists?ze.NONE:ze.exists(t.exists):ze.updateTime(this.fromVersion(t.updateTime))},t.prototype.Qn=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Ie.MIN)&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ge(n,r)},t.prototype.Wn=function(t,e){var n=this;return t&&0<t.length?(z(void 0!==e,\"Received a write result without a commit time\"),t.map(function(t){return n.Qn(t,e)})):[]},t.prototype.Ln=function(t){var e=t.transform;if(e instanceof Ue)return{fieldPath:t.field.K(),setToServerValue:\"REQUEST_TIME\"};if(e instanceof Me)return{fieldPath:t.field.K(),appendMissingElements:{values:e.elements}};if(e instanceof je)return{fieldPath:t.field.K(),removeAllFromArray:{values:e.elements}};if(e instanceof Fe)return{fieldPath:t.field.K(),increment:e.Qt};throw G(\"Unknown transform: \"+t.transform)},t.prototype.qn=function(t){var e=null;if(\"setToServerValue\"in t)z(\"REQUEST_TIME\"===t.setToServerValue,\"Unknown server value transform proto: \"+JSON.stringify(t)),e=Ue.instance;else if(\"appendMissingElements\"in t){var n=t.appendMissingElements.values||[];e=new Me(n)}else if(\"removeAllFromArray\"in t){var r=t.removeAllFromArray.values||[];e=new je(r)}else\"increment\"in t?e=new Fe(this,t.increment):G(\"Unknown transform proto: \"+JSON.stringify(t));var i=De.Z(t.fieldPath);return new Be(i,e)},t.prototype.jn=function(t){return{documents:[this.Vn(t.path)]}},t.prototype.Kn=function(t){var e=t.documents.length;z(1===e,\"DocumentsTarget contained other than 1 document: \"+e);var n=t.documents[0];return on.ve(this.gn(n)).xe()},t.prototype.Gn=function(t){var e={structuredQuery:{}},n=t.path;null===t.collectionGroup?(e.parent=this.Vn(n.L()),e.structuredQuery.from=[{collectionId:n.B()}]):(e.parent=this.Vn(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]);var r=this.zn(t.filters);r&&(e.structuredQuery.where=r);var i=this.Hn(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ln(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Jn(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Jn(t.endAt)),e},t.prototype.Yn=function(t){var e=this.gn(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){z(1===r,\"StructuredQuery.from with more than one collection is not supported.\");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xn(n.where));var u=[];n.orderBy&&(u=this.Zn(n.orderBy));var a=null;n.limit&&(a=this.fn(n.limit));var h=null;n.startAt&&(h=this.ti(n.startAt));var c=null;return n.endAt&&(c=this.ti(n.endAt)),new on(e,i,u,s,a,\"F\",h,c).xe()},t.prototype.ei=function(t){var e=this.si(t.Ze);return null==e?null:{\"goog-listen-tags\":e}},t.prototype.si=function(t){return 0===t?null:1===t?\"existence-filter-mismatch\":2===t?\"limbo-document\":G(\"Unrecognized query purpose: \"+t)},t.prototype.xe=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.jn(n)}:{query:this.Gn(n)}).targetId=t.targetId,0<t.resumeToken.Ot()&&(e.resumeToken=this.mn(t.resumeToken)),e},t.prototype.zn=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof un?e.ni(t):G(\"Unrecognized filter: \"+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:\"AND\",filters:n}}}},t.prototype.Xn=function(t){var e=this;return t?void 0===t.unaryFilter?void 0===t.fieldFilter?void 0===t.compositeFilter?G(\"Unknown filter: \"+JSON.stringify(t)):t.compositeFilter.filters.map(function(t){return e.Xn(t)}).reduce(function(t,e){return t.concat(e)}):[this.ri(t)]:[this.ii(t)]:[]},t.prototype.Hn=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.oi(t)})},t.prototype.Zn=function(t){var e=this;return t.map(function(t){return e.hi(t)})},t.prototype.Jn=function(t){return{before:t.before,values:t.position}},t.prototype.ti=function(t){var e=!!t.before,n=t.values||[];return new vn(n,e)},t.prototype.ai=function(t){return Un[t.name]},t.prototype.ui=function(t){return\"ASCENDING\"===t?pn.ASCENDING:\"DESCENDING\"===t?pn.DESCENDING:void 0},t.prototype.ci=function(t){return Mn[t.name]},t.prototype._i=function(t){return\"EQUAL\"===t?sn.EQUAL:\"GREATER_THAN\"===t?sn.GREATER_THAN:\"GREATER_THAN_OR_EQUAL\"===t?sn.GREATER_THAN_OR_EQUAL:\"LESS_THAN\"===t?sn.LESS_THAN:\"LESS_THAN_OR_EQUAL\"===t?sn.LESS_THAN_OR_EQUAL:\"ARRAY_CONTAINS\"===t?sn.ARRAY_CONTAINS:\"IN\"===t?sn.IN:\"ARRAY_CONTAINS_ANY\"===t?sn.ARRAY_CONTAINS_ANY:G(\"OPERATOR_UNSPECIFIED\"===t?\"Unspecified operator\":\"Unknown operator\")},t.prototype.li=function(t){return{fieldPath:t.K()}},t.prototype.di=function(t){return De.Z(t.fieldPath)},t.prototype.oi=function(t){return{field:this.li(t.field),direction:this.ai(t.dir)}},t.prototype.hi=function(t){return new mn(this.di(t.field),this.ui(t.direction))},t.prototype.ri=function(t){return un.create(this.di(t.fieldFilter.field),this._i(t.fieldFilter.op),t.fieldFilter.value)},t.prototype.ni=function(t){if(t.op===sn.EQUAL){if(I(t.value))return{unaryFilter:{field:this.li(t.field),op:\"IS_NAN\"}};if(T(t.value))return{unaryFilter:{field:this.li(t.field),op:\"IS_NULL\"}}}return{fieldFilter:{field:this.li(t.field),op:this.ci(t.op),value:t.value}}},t.prototype.ii=function(t){switch(t.unaryFilter.op){case\"IS_NAN\":var e=this.di(t.unaryFilter.field);return un.create(e,sn.EQUAL,{doubleValue:NaN});case\"IS_NULL\":var n=this.di(t.unaryFilter.field);return un.create(n,sn.EQUAL,{nullValue:\"NULL_VALUE\"});case\"OPERATOR_UNSPECIFIED\":return G(\"Unspecified filter\");default:return G(\"Unknown filter\")}},t.prototype.Mn=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.K())}),{fieldPaths:e}},t.prototype.Un=function(t){var e=(t.fieldPaths||[]).map(function(t){return De.Z(t)});return qe.Gt(e)},t}(),Fn=function(){function t(){}return t.fi=function(e){t.platform&&G(\"Platform already defined\"),t.platform=e},t.Lt=function(){return t.platform||G(\"Platform not set\"),t.platform},t}(),qn=new ce.Logger(\"@firebase/firestore\"),Bn=function(){function t(){}return t.mi=function(){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",e=\"\",n=0;20>n;n++)e+=t.charAt(se(Math.random()*t.length));return e},t}(),Gn=function(t,e,n,r,i){this.cn=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},zn=function(){function t(t,e){this.projectId=t,this.database=e||\"(default)\"}return Object.defineProperty(t.prototype,\"Ei\",{get:function(){return\"(default)\"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.D=function(t){return K(this.projectId,t.projectId)||K(this.database,t.database)},t}(),Kn=function(){function t(t){this.wi=t,this.Ii={}}return t.prototype.get=function(t){var e=this.wi(t),n=this.Ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.wi(t),r=this.Ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.wi(t),n=this.Ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.Ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){i(this.Ii,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}})},t.prototype.U=function(){return o(this.Ii)},t}(),Wn=function(){function t(t,e,n,r){this.batchId=t,this.Ri=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ut=function(t,e,n){for(var r,i=n.Ai,o=0;o<this.mutations.length;o++)if((r=this.mutations[o]).key.isEqual(t)){var s=i[o];e=r.Ut(e,s)}return e},t.prototype.Bt=function(t,e){for(var n,r=0,i=this.baseMutations;r<i.length;r++)(n=i[r]).key.isEqual(t)&&(e=n.Bt(e,e,this.Ri));for(var o,s=e,u=0,a=this.mutations;u<a.length;u++)(o=a[u]).key.isEqual(t)&&(e=o.Bt(e,s,this.Ri));return e},t.prototype.Pi=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.Bt(r.key,t.get(r.key));i&&(n=n.it(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},L())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&W(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&W(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},t}(),Hn=function(){function t(t,e,n,r,i){this.batch=t,this.Vi=e,this.Ai=n,this.streamToken=r,this.gi=i}return t.from=function(e,n,r,i){z(e.mutations.length===r.length,\"Mutations sent \"+e.mutations.length+\" must equal results received \"+r.length);for(var o=R(),s=e.mutations,u=0;u<s.length;u++)o=o.it(s[u].key,r[u].version);return new t(e,n,r,i,o)},t}(),Yn=function(){function t(){this.pi=new Le(Xn.Ee),this.yi=new Le(Xn.bi)}return t.prototype.U=function(){return this.pi.U()},t.prototype.vi=function(t,e){var n=new Xn(t,e);this.pi=this.pi.add(n),this.yi=this.yi.add(n)},t.prototype.Si=function(t,e){var n=this;t.forEach(function(t){return n.vi(t,e)})},t.prototype.Di=function(t,e){this.Ci(new Xn(t,e))},t.prototype.ki=function(t,e){var n=this;t.forEach(function(t){return n.Di(t,e)})},t.prototype.Ni=function(t){var e=this,n=ke.EMPTY,r=new Xn(n,t),i=new Xn(n,t+1),o=[];return this.yi.Ct([r,i],function(t){e.Ci(t),o.push(t.key)}),o},t.prototype.Fi=function(){var t=this;this.pi.forEach(function(e){return t.Ci(e)})},t.prototype.Ci=function(t){this.pi=this.pi.delete(t),this.yi=this.yi.delete(t)},t.prototype.$i=function(t){var e=ke.EMPTY,n=new Xn(e,t),r=new Xn(e,t+1),i=L();return this.yi.Ct([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Mi=function(t){var e=new Xn(t,0),n=this.pi.Nt(e);return null!==n&&t.isEqual(n.key)},t}(),Xn=function(){function t(t,e){this.key=t,this.Li=e}return t.Ee=function(t,e){return ke.F(t.key,e.key)||K(t.Li,e.Li)},t.bi=function(t,e){return K(t.Li,e.Li)||ke.F(t.key,e.key)},t}(),Jn=function(){function t(t){var e=this;this.Oi=null,this.xi=null,this.result=void 0,this.error=void 0,this.Bi=!1,this.Ui=!1,t(function(t){e.Bi=!0,e.result=t,e.Oi&&e.Oi(t)},function(t){e.Bi=!0,e.error=t,e.xi&&e.xi(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Ui&&G(\"Called next() or catch() twice for PersistencePromise\"),this.Ui=!0,this.Bi?this.error?this.qi(n,this.error):this.Qi(e,this.result):new t(function(t,i){r.Oi=function(n){r.Qi(e,n).next(t,i)},r.xi=function(e){r.qi(n,e).next(t,i)}})},t.prototype.Wi=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.ji=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Qi=function(e,n){return e?this.ji(function(){return e(n)}):t.resolve(n)},t.prototype.qi=function(e,n){return e?this.ji(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.Ki=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i==r&&t()},function(t){return n(t)})}),o=!0,i==r&&t()})},t.Gi=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.Ki(r)},t}(),Qn=function(){function t(){this.zi=new Kn(function(t){return t.toString()}),this.Hi=!1}return Object.defineProperty(t.prototype,\"readTime\",{get:function(){return this.Ji},set:function(t){this.Ji=t},enumerable:!0,configurable:!0}),t.prototype.Yi=function(t,e){this.Xi(),this.readTime=e,this.zi.set(t.key,t)},t.prototype.Zi=function(t,e){this.Xi(),e&&(this.readTime=e),this.zi.set(t,null)},t.prototype.tr=function(t,e){this.Xi();var n=this.zi.get(e);return void 0===n?this.er(t,e):Jn.resolve(n)},t.prototype.getEntries=function(t,e){return this.sr(t,e)},t.prototype.apply=function(t){return this.Xi(),this.Hi=!0,this.nr(t)},t.prototype.Xi=function(){},t}(),Zn=\"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.\",$n=function(){function t(){this.ir=[]}return t.prototype.rr=function(t){this.ir.push(t)},t.prototype.or=function(){this.ir.forEach(function(t){return t()})},t}(),tr=function(){function t(t,e,n){this.hr=t,this.ar=e,this.ur=n}return t.prototype.cr=function(t,e){var n=this;return this.ar._r(t,e).next(function(r){return n.lr(t,e,r)})},t.prototype.lr=function(t,e,n){return this.hr.tr(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Bt(e,t);return t})},t.prototype.dr=function(t,e,n){var r=x();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Bt(t,e);r=r.it(t,e)}),r},t.prototype.Tr=function(t,e){var n=this;return this.hr.getEntries(t,e).next(function(e){return n.mr(t,e)})},t.prototype.mr=function(t,e){var n=this;return this.ar.Er(t,e).next(function(r){var i=n.dr(t,e,r),o=k();return i.forEach(function(t,e){e||(e=new en(t,Ie.S())),o=o.it(t,e)}),o})},t.prototype.wr=function(t,e,n){return e.Pe()?this.Ir(t,e.path):e.He()?this.Rr(t,e,n):this.Ar(t,e,n)},t.prototype.Ir=function(t,e){return this.cr(t,new ke(e)).next(function(t){var e=O();return t instanceof tn&&(e=e.it(t.key,t)),e})},t.prototype.Rr=function(t,e,n){var r=this,i=e.collectionGroup,o=O();return this.ur.Pr(t,i).next(function(s){return Jn.forEach(s,function(s){var u=e.Le(s.child(i));return r.Ar(t,u,n).next(function(t){t.forEach(function(t,e){o=o.it(t,e)})})}).next(function(){return o})})},t.prototype.Ar=function(t,e,n){var r,i,o=this;return this.hr.wr(t,e,n).next(function(n){return r=n,o.ar.Vr(t,e)}).next(function(e){return i=e,o.gr(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],h=a.key,c=r.get(h),f=a.Bt(c,c,o.Ri);r=f instanceof tn?r.it(h,f):r.remove(h)}})}).next(function(){return r.forEach(function(t,n){e.matches(n)||(r=r.remove(t))}),r})},t.prototype.gr=function(t,e,n){for(var r=L(),i=0,o=e;i<o.length;i++)for(var s,u=0,a=o[i].mutations;u<a.length;u++)(s=a[u])instanceof He&&null===n.get(s.key)&&(r=r.add(s.key));var h=n;return this.hr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof tn&&(h=h.it(t,e))}),h})},t}(),er=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.pr=n,this.yr=r}return t.br=function(e,n){for(var r,i=L(),o=L(),s=0,u=n.docChanges;s<u.length;s++)switch(r=u[s],r.type){case 0:i=i.add(r.doc.key);break;case 1:o=o.add(r.doc.key)}return new t(e,n.fromCache,i,o)},t}(),nr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.vr=function(t){return n.Sr(t)},this.Dr=function(t){return e.Cr(t)})}return t.prototype.Sr=function(t){return this.previousValue=oe(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.Dr&&this.Dr(t),t},t}();nr.kr=-1;\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar rr=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},ir=function(){function t(t,e,n,r,i){this.Nr=t,this.Fr=e,this.$r=n,this.op=r,this.Mr=i,this.Lr=new rr,this.then=this.Lr.promise.then.bind(this.Lr.promise),this.catch=this.Lr.promise.catch.bind(this.Lr.promise),this.Lr.promise.catch(function(){})}return t.Or=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.xr=setTimeout(function(){return e.Br()},t)},t.prototype.Ur=function(){return this.Br()},t.prototype.cancel=function(t){null!==this.xr&&(this.clearTimeout(),this.Lr.reject(new me(ve.CANCELLED,\"Operation cancelled\"+(t?\": \"+t:\"\"))))},t.prototype.Br=function(){var t=this;this.Nr.qr(function(){return null===t.xr?Promise.resolve():(t.clearTimeout(),t.op().then(function(e){return t.Lr.resolve(e)}))})},t.prototype.clearTimeout=function(){null!==this.xr&&(this.Mr(this),clearTimeout(this.xr),this.xr=null)},t}(),or=function(){function t(){this.Qr=Promise.resolve(),this.Wr=!1,this.jr=[],this.Kr=null,this.Gr=!1,this.zr=[]}return Object.defineProperty(t.prototype,\"Hr\",{get:function(){return this.Wr},enumerable:!0,configurable:!0}),t.prototype.qr=function(t){this.enqueue(t)},t.prototype.Jr=function(t){this.Yr(),this.Xr(t)},t.prototype.Zr=function(t){return this.Yr(),this.Xr(t)},t.prototype.to=function(t){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(e){switch(e.label){case 0:return this.Yr(),this.Wr?[3,2]:(this.Wr=!0,[4,this.Zr(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.enqueue=function(t){return this.Yr(),this.Wr?new Promise(function(){}):this.Xr(t)},t.prototype.Xr=function(t){var e=this,n=this.Qr.then(function(){return e.Gr=!0,t().catch(function(t){throw e.Kr=t,e.Gr=!1,q(\"INTERNAL UNHANDLED ERROR: \",t.stack||t.message||\"\"),t}).then(function(t){return e.Gr=!1,t})});return this.Qr=n,n},t.prototype.eo=function(t,e,n){var r=this;this.Yr(),-1<this.zr.indexOf(t)&&(e=0);var i=ir.Or(this,t,e,n,function(t){return r.so(t)});return this.jr.push(i),i},t.prototype.Yr=function(){this.Kr&&G(\"AsyncQueue is already failed: \"+(this.Kr.stack||this.Kr.message))},t.prototype.no=function(){},t.prototype.io=function(){return ae.__awaiter(this,void 0,void 0,function(){var t;return ae.__generator(this,function(e){switch(e.label){case 0:return[4,t=this.Qr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Qr)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.ro=function(t){for(var e=0,n=this.jr;e<n.length;e++)if(n[e].Fr===t)return!0;return!1},t.prototype.oo=function(t){var e=this;return this.io().then(function(){e.jr.sort(function(t,e){return t.$r-e.$r});for(var n,r=0,i=e.jr;r<i.length&&((n=i[r]).Ur(),\"all\"===t||n.Fr!==t);r++);return e.io()})},t.prototype.ho=function(t){this.zr.push(t)},t.prototype.so=function(t){var e=this.jr.indexOf(t);this.jr.splice(e,1)},t}(),sr=function(){function t(t){this.ao=t,this.buffer=new Le(Y),this.uo=0}return t.prototype.co=function(){return++this.uo},t.prototype._o=function(t){var e=[t,this.co()];if(this.buffer.size<this.ao)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();0>Y(e,n)&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,\"maxValue\",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),ur={lo:!1,do:0,fo:0,To:0},ar=function(){function t(t,e,n){this.mo=t,this.Eo=e,this.wo=n}return t.Io=function(e){return new t(e,t.Ro,t.Ao)},t}();ar.Po=-1,ar.Vo=1048576,ar.po=41943040,ar.Ro=10,ar.Ao=1e3,ar.yo=new ar(ar.po,ar.Ro,ar.Ao),ar.DISABLED=new ar(ar.Po,0,0);var hr=function(){function t(t,e){this.bo=t,this.Nr=e,this.vo=!1,this.So=null}return t.prototype.start=function(t){this.bo.Do.mo!==ar.Po&&this.Co(t)},t.prototype.stop=function(){this.So&&(this.So.cancel(),this.So=null)},Object.defineProperty(t.prototype,\"ko\",{get:function(){return null!==this.So},enumerable:!0,configurable:!0}),t.prototype.Co=function(t){var e=this,n=this.vo?3e5:6e4;F(\"LruGarbageCollector\",\"Garbage collection scheduled in \"+n+\"ms\"),this.So=this.Nr.eo(\"lru_garbage_collection\",n,function(){return e.So=null,e.vo=!0,t.No(e.bo).then(function(){return e.Co(t)}).catch(X)})},t}(),cr=function(){function t(t,e){this.Fo=t,this.Do=e}return t.prototype.$o=function(t,e){return this.Fo.Mo(t).next(function(t){return se(e/100*t)})},t.prototype.Lo=function(t,e){var n=this;if(0===e)return Jn.resolve(nr.kr);var r=new sr(e);return this.Fo.Xs(t,function(t){return r._o(t.sequenceNumber)}).next(function(){return n.Fo.Oo(t,function(t){return r._o(t)})}).next(function(){return r.maxValue})},t.prototype.xo=function(t,e,n){return this.Fo.xo(t,e,n)},t.prototype.Bo=function(t,e){return this.Fo.Bo(t,e)},t.prototype.Uo=function(t,e){var n=this;return this.Do.mo===ar.Po?(F(\"LruGarbageCollector\",\"Garbage collection skipped; disabled\"),Jn.resolve(ur)):this.qo(t).next(function(r){return r<n.Do.mo?(F(\"LruGarbageCollector\",\"Garbage collection skipped; Cache size \"+r+\" is lower than threshold \"+n.Do.mo),ur):n.Qo(t,e)})},t.prototype.qo=function(t){return this.Fo.qo(t)},t.prototype.Qo=function(t,e){var n,r,i,o,s,u,a,h=this,c=Date.now();return this.$o(t,this.Do.Eo).next(function(e){return e>h.Do.wo?(F(\"LruGarbageCollector\",\"Capping sequence numbers to collect down to the maximum of \"+h.Do.wo+\" from \"+e),r=h.Do.wo):r=e,o=Date.now(),h.Lo(t,r)}).next(function(r){return n=r,s=Date.now(),h.xo(t,n,e)}).next(function(e){return i=e,u=Date.now(),h.Bo(t,n)}).next(function(t){return a=Date.now(),M()<=ce.LogLevel.DEBUG&&F(\"LruGarbageCollector\",\"LRU Garbage Collection\\n\\tCounted targets in \"+(o-c)+\"ms\\n\\tDetermined least recently used \"+r+\" in \"+(s-o)+\"ms\\n\\tRemoved \"+i+\" targets in \"+(u-s)+\"ms\\n\\tRemoved \"+t+\" documents in \"+(a-u)+\"ms\\nTotal Duration: \"+(a-c)+\"ms\"),Jn.resolve({lo:!0,do:r,fo:i,To:t})})},t}(),fr=function(){function t(t,e,n){this.persistence=t,this.Wo=e,this.jo=new Yn,this.Ko=new xe(K),this.Go=new Kn(function(t){return t.canonicalId()}),this.zo=Ie.MIN,this.persistence.Jo.Ho(this.jo),this.ar=t.Yo(n),this.Xo=t.Zo(),this.th=t.eh(),this.sh=new tr(this.Xo,this.ar,this.persistence.nh()),this.Wo.ih(this.sh)}return t.prototype.start=function(){return this.rh()},t.prototype.oh=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r,i=this;return ae.__generator(this,function(o){switch(o.label){case 0:return e=this.ar,n=this.sh,[4,this.persistence.runTransaction(\"Handle user change\",\"readonly\",function(r){var o;return i.ar.hh(r).next(function(s){return o=s,e=i.persistence.Yo(t),n=new tr(i.Xo,e,i.persistence.nh()),e.hh(r)}).next(function(t){for(var e,i=[],s=[],u=L(),a=0,h=o;a<h.length;a++){e=h[a],i.push(e.batchId);for(var c,f=0,l=e.mutations;f<l.length;f++)c=l[f],u=u.add(c.key)}for(var p,d=0,y=t;d<y.length;d++){p=y[d],s.push(p.batchId);for(var v,m=0,g=p.mutations;m<g.length;m++)v=g[m],u=u.add(v.key)}return n.Tr(r,u).next(function(t){return{ah:t,uh:i,_h:s}})})})];case 1:return r=o.sent(),[2,(this.ar=e,this.sh=n,this.Wo.ih(this.sh),r)]}})})},t.prototype.lh=function(t){var e,n=this,r=Te.now(),i=t.reduce(function(t,e){return t.add(e.key)},L());return this.persistence.runTransaction(\"Locally write mutations\",\"readwrite\",function(o){return n.sh.Tr(o,i).next(function(i){e=i;for(var s=[],u=0,a=t;u<a.length;u++){var h=a[u],c=h.ee(e.get(h.key));null!=c&&s.push(new He(h.key,c,c.se(),ze.exists(!0)))}return n.ar.dh(o,r,s,t)})}).then(function(t){var n=t.Pi(e);return{batchId:t.batchId,zi:n}})},t.prototype.fh=function(t){var e=this;return this.persistence.runTransaction(\"Lookup mutation documents\",\"readonly\",function(n){return e.ar.Th(n,t).next(function(t){return t?e.sh.Tr(n,t):Jn.resolve(null)})})},t.prototype.mh=function(t){var e=this;return this.persistence.runTransaction(\"Acknowledge batch\",\"readwrite-primary\",function(n){var r=t.batch.keys(),i=e.Xo.Eh({wh:!0});return e.ar.mh(n,t.batch,t.streamToken).next(function(){return e.Ih(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.ar.Rh(n)}).next(function(){return e.sh.Tr(n,r)})})},t.prototype.Ah=function(t){var e=this;return this.persistence.runTransaction(\"Reject batch\",\"readwrite-primary\",function(n){var r;return e.ar.Ph(n,t).next(function(t){return z(null!==t,\"Attempt to reject nonexistent batch!\"),r=t.keys(),e.ar.Vh(n,t)}).next(function(){return e.ar.Rh(n)}).next(function(){return e.sh.Tr(n,r)})})},t.prototype.gh=function(){var t=this;return this.persistence.runTransaction(\"Get highest unacknowledged batch id\",\"readonly\",function(e){return t.ar.gh(e)})},t.prototype.ph=function(){var t=this;return this.persistence.runTransaction(\"Get last stream token\",\"readonly\",function(e){return t.ar.ph(e)})},t.prototype.yh=function(t){var e=this;return this.persistence.runTransaction(\"Set last stream token\",\"readwrite-primary\",function(n){return e.ar.yh(n,t)})},t.prototype.bh=function(){var t=this;return this.persistence.runTransaction(\"Get last remote snapshot version\",\"readonly\",function(e){return t.th.bh(e)})},t.prototype.vh=function(e){var n=this,r=e.ts,i=this.Ko;return this.persistence.runTransaction(\"Apply remote event\",\"readwrite-primary\",function(o){var s=n.Xo.Eh({wh:!0});i=n.Ko;var u=[];e.Ts.forEach(function(e,s){var a=i.get(s);if(a){u.push(n.th.Sh(o,e.gs,s).next(function(){return n.th.Dh(o,e.Ps,s)}));var h=e.resumeToken;if(0<h.Ot()){var c=a.ss(h,r).es(o.Ch);i=i.it(s,c),t.kh(a,c,e)&&u.push(n.th.Nh(o,c))}}});var a=k(),h=L();if(e.Es.forEach(function(t){h=h.add(t)}),u.push(s.getEntries(o,h).next(function(t){e.Es.forEach(function(i,h){var c=t.get(i);h instanceof en&&h.version.isEqual(Ie.MIN)?(s.Zi(i,r),a=a.it(i,h)):null==c||0<h.version.D(c.version)||0===h.version.D(c.version)&&c.hasPendingWrites?(s.Yi(h,r),a=a.it(i,h)):F(\"LocalStore\",\"Ignoring outdated watch update for \",i,\". Current version:\",c.version,\" Watch version:\",h.version),e.ws.has(i)&&u.push(n.persistence.Jo.Fh(o,i))})})),!r.isEqual(Ie.MIN)){var c=n.th.bh(o).next(function(){return n.th.$h(o,o.Ch,r)});u.push(c)}return Jn.Ki(u).next(function(){return s.apply(o)}).next(function(){return n.sh.mr(o,a)})}).then(function(t){return n.Ko=i,t})},t.kh=function(t,e,n){return z(0<e.resumeToken.Ot(),\"Attempted to persist target data with no resume token\"),0===t.resumeToken.Ot()||e.ts.C()-t.ts.C()>=this.Mh||0<n.Ps.size+n.Vs.size+n.gs.size},t.prototype.Lh=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.jo.Si(i.pr,o),this.jo.ki(i.yr,o),!i.fromCache){var s=this.Ko.get(o),u=s.ts,a=s.ns(u);this.Ko=this.Ko.it(o,a)}}return this.persistence.runTransaction(\"notifyLocalViewChanges\",\"readwrite\",function(n){return Jn.forEach(t,function(t){return Jn.forEach(t.yr,function(t){return e.persistence.Jo.Di(n,t)})})})},t.prototype.Oh=function(t){var e=this;return this.persistence.runTransaction(\"Get next mutation batch\",\"readonly\",function(n){return void 0===t&&(t=-1),e.ar.xh(n,t)})},t.prototype.Bh=function(t){var e=this;return this.persistence.runTransaction(\"read document\",\"readonly\",function(n){return e.sh.cr(n,t)})},t.prototype.Uh=function(t){var e=this;return this.persistence.runTransaction(\"Allocate target\",\"readwrite\",function(n){var r;return e.th.qh(n,t).next(function(i){return i?(r=i,Jn.resolve(r)):e.th.Qh(n).next(function(i){return r=new bn(t,i,0,n.Ch),e.th.Wh(n,r).next(function(){return r})})})}).then(function(n){return null===e.Ko.get(n.targetId)&&(e.Ko=e.Ko.it(n.targetId,n),e.Go.set(t,n.targetId)),n})},t.prototype.qh=function(t,e){var n=this.Go.get(e);return void 0===n?this.th.qh(t,e):Jn.resolve(this.Ko.get(n))},t.prototype.jh=function(t,e){var n=this,r=this.Ko.get(t),i=e?\"readwrite\":\"readwrite-primary\";return this.persistence.runTransaction(\"Release target\",i,function(i){var o=n.jo.Ni(t);return e?Jn.resolve():Jn.forEach(o,function(t){return n.persistence.Jo.Di(i,t)}).next(function(){n.persistence.Jo.removeTarget(i,r)})}).then(function(){n.Ko=n.Ko.remove(t),n.Go.delete(r.target)})},t.prototype.Kh=function(t,e){var n=this,r=Ie.MIN,i=L();return this.persistence.runTransaction(\"Execute query\",\"readonly\",function(o){return n.qh(o,t.xe()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.th.Gh(o,t.targetId).next(function(t){i=t})}).next(function(){return n.Wo.wr(o,t,e?r:Ie.MIN,e?i:L())}).next(function(t){return{documents:t,zh:i}})})},t.prototype.Hh=function(t){var e=this;return this.persistence.runTransaction(\"Remote document keys\",\"readonly\",function(n){return e.th.Gh(n,t)})},t.prototype.Jh=function(){return this.persistence.Jh()},t.prototype.Yh=function(t){this.ar.Xh(t)},t.prototype.Zh=function(t){this.persistence.Zh(t)},t.prototype.Ih=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=Jn.resolve();return o.forEach(function(r){s=s.next(function(){return n.tr(t,r)}).next(function(t){var o=t,s=e.gi.get(r);z(null!==s,\"ackVersions should contain every doc in the write.\"),(!o||0>o.version.D(s))&&(o=i.Ut(r,o,e))&&n.Yi(o,e.Vi)})}),s.next(function(){return r.ar.Vh(t,i)})},t.prototype.No=function(t){var e=this;return this.persistence.runTransaction(\"Collect garbage\",\"readwrite-primary\",function(n){return t.Uo(n,e.Ko)})},t.prototype.ta=function(t){var e=this,n=this.Ko.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction(\"Get target data\",\"readonly\",function(n){return e.th.un(n,t).next(function(t){return t?t.target:null})})},t.prototype.ea=function(){var t=this;return this.persistence.runTransaction(\"Get new document changes\",\"readonly\",function(e){return t.Xo.ea(e,t.zo)}).then(function(e){var n=e.sa,r=e.readTime;return t.zo=r,n})},t.prototype.rh=function(){return ae.__awaiter(this,void 0,void 0,function(){var t,e=this;return ae.__generator(this,function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction(\"Synchronize last document change read time\",\"readonly\",function(t){return e.Xo.na(t)})];case 1:return t.zo=n.sent(),[2]}})})},t}();fr.Mh=3e8;var lr=function(){function t(t){vt(),this.ra=t}return t.fromBase64String=function(e){Q(\"Blob.fromBase64String\",arguments,1),tt(\"Blob.fromBase64String\",\"string\",1,e),vt();try{return new t(Pe.fromBase64String(e))}catch(e){throw new me(ve.INVALID_ARGUMENT,\"Failed to construct Blob from Base64 string: \"+e)}},t.fromUint8Array=function(e){if(Q(\"Blob.fromUint8Array\",arguments,1),yt(),!(e instanceof Uint8Array))throw ct(\"Blob.fromUint8Array\",\"Uint8Array\",1,e);return new t(Pe.fromUint8Array(e))},t.prototype.toBase64=function(){return Q(\"Blob.toBase64\",arguments,0),vt(),this.ra.toBase64()},t.prototype.toUint8Array=function(){return Q(\"Blob.toUint8Array\",arguments,0),yt(),this.ra.toUint8Array()},t.prototype.toString=function(){return\"Blob(base64: \"+this.toBase64()+\")\"},t.prototype.isEqual=function(t){return this.ra.isEqual(t.ra)},t}(),pr=dt(lr,\"Use Blob.fromUint8Array() or Blob.fromBase64String() instead.\"),dr=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e){if(!(e instanceof Array)||1>e.length)throw new me(ve.INVALID_ARGUMENT,\"Function FieldPath() requires its fieldNames argument to be an array with at least \"+pt(1,\"element\")+\".\")}(0,t);for(var n=0;n<t.length;++n)if(tt(\"FieldPath\",\"string\",n,t[n]),0===t[n].length)throw new me(ve.INVALID_ARGUMENT,\"Invalid field name at argument $(i + 1). Field names must not be empty.\");this.oa=new De(t)}return t.documentId=function(){return t.ha},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ct(\"isEqual\",\"FieldPath\",1,e);return this.oa.isEqual(e.oa)},t}();dr.ha=new dr(De.X().K());var yr=/[~\\*/\\[\\]]/,vr=function(){function t(t){this.aa=t}return t.delete=function(){return J(\"FieldValue.delete\",arguments),mr.instance},t.serverTimestamp=function(){return J(\"FieldValue.serverTimestamp\",arguments),gr.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Z(\"FieldValue.arrayUnion\",arguments,1),new wr(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Z(\"FieldValue.arrayRemove\",arguments,1),new br(t)},t.increment=function(t){return tt(\"FieldValue.increment\",\"number\",1,t),Q(\"FieldValue.increment\",arguments,1),new _r(t)},t.prototype.isEqual=function(t){return this===t},t}(),mr=function(t){function e(){return t.call(this,\"FieldValue.delete\")||this}return ae.__extends(e,t),e}(vr);\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */mr.instance=new mr;var gr=function(t){function e(){return t.call(this,\"FieldValue.serverTimestamp\")||this}return ae.__extends(e,t),e}(vr);gr.instance=new gr;var wr=function(t){function e(e){var n=this;return(n=t.call(this,\"FieldValue.arrayUnion\")||this).ua=e,n}return ae.__extends(e,t),e}(vr),br=function(t){function e(e){var n=this;return(n=t.call(this,\"FieldValue.arrayRemove\")||this).ua=e,n}return ae.__extends(e,t),e}(vr),_r=function(t){function e(e){var n=this;return(n=t.call(this,\"FieldValue.increment\")||this).ca=e,n}return ae.__extends(e,t),e}(vr),Er=dt(vr,\"Use FieldValue.<field>() instead.\"),Tr=function(){function t(t,e){if(Q(\"GeoPoint\",arguments,2),tt(\"GeoPoint\",\"number\",1,t),tt(\"GeoPoint\",\"number\",2,e),!isFinite(t)||-90>t||90<t)throw new me(ve.INVALID_ARGUMENT,\"Latitude must be a number between -90 and 90, but was: \"+t);if(!isFinite(e)||-180>e||180<e)throw new me(ve.INVALID_ARGUMENT,\"Longitude must be a number between -180 and 180, but was: \"+e);this._a=t,this.la=e}return Object.defineProperty(t.prototype,\"latitude\",{get:function(){return this._a},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"longitude\",{get:function(){return this.la},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._a===t._a&&this.la===t.la},t.prototype.p=function(t){return K(this._a,t._a)||K(this.la,t.la)},t}(),Ir=/^__.*__$/,Nr=function(){function t(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}return t.prototype.da=function(t,e){var n=[];return null===this.se?n.push(new We(t,this.data,e)):n.push(new He(t,this.data,this.se,e)),0<this.fieldTransforms.length&&n.push(new Ye(t,this.fieldTransforms)),n},t}(),Ar=function(){function t(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}return t.prototype.da=function(t,e){var n=[new He(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new Ye(t,this.fieldTransforms)),n},t}(),Sr=function(){function t(t,e,n,r,i,o){this.fa=t,this.methodName=e,this.path=n,this.Ta=r,void 0===i&&this.ma(),this.Ta=void 0!==r&&r,this.fieldTransforms=i||[],this.se=o||[]}return t.prototype.Ea=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.fa,this.methodName,n,!1,this.fieldTransforms,this.se);return r.wa(e),r},t.prototype.Ia=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.fa,this.methodName,n,!1,this.fieldTransforms,this.se);return r.ma(),r},t.prototype.Ra=function(){return new t(this.fa,this.methodName,null,!0,this.fieldTransforms,this.se)},t.prototype.Aa=function(t){var e=null===this.path||this.path.U()?\"\":\" (found in field \"+this.path.toString()+\")\";return new me(ve.INVALID_ARGUMENT,\"Function \"+this.methodName+\"() called with invalid data. \"+t+e)},t.prototype.contains=function(t){return void 0!==this.se.find(function(e){return t.q(e)})||void 0!==this.fieldTransforms.find(function(e){return t.q(e.field)})},t.prototype.ma=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.wa(this.path.get(t))},t.prototype.wa=function(t){if(0===t.length)throw this.Aa(\"Document fields must not be empty\");if(mt(this.fa)&&Ir.test(t))throw this.Aa('Document fields cannot begin and end with \"__\"')},t}(),Dr=function(t,e){this.cn=t,this.key=e},kr=function(){function t(t,e){this.serializer=t,this.Pa=e}return t.prototype.Va=function(t,e){var n=new Sr(0,t,De.H);wt(\"Data must be an object, but it was:\",n,e);var r=this.ga(e,n);return new Nr(new Qe(r),null,n.fieldTransforms)},t.prototype.pa=function(t,e,n){var r=new Sr(2,t,De.H);wt(\"Data must be an object, but it was:\",r,e);var i,o,s=this.ga(e,r);if(n){for(var u=new Le(De.F),a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof dr)f=c.oa;else{if(\"string\"!=typeof c)throw G(\"Expected stringOrFieldPath to be a string or a FieldPath\");f=_t(t,c)}if(!r.contains(f))throw new me(ve.INVALID_ARGUMENT,\"Field '\"+f+\"' is specified in your field mask but missing from your input data.\");u=u.add(f)}i=qe.Kt(u),o=r.fieldTransforms.filter(function(t){return i.zt(t.field)})}else i=qe.Gt(r.se),o=r.fieldTransforms;return new Nr(new Qe(s),i,o)},t.prototype.ya=function(t,e){var n=this,r=new Sr(1,t,De.H);wt(\"Data must be an object, but it was:\",r,e);var o=new Le(De.F),s=Qe._e();i(e,function(e,i){var u=_t(t,e),a=r.Ia(u);if((i=n.ba(i,a))instanceof mr)o=o.add(u);else{var h=n.va(i,a);null!=h&&(o=o.add(u),s.set(u,h))}});var u=qe.Kt(o);return new Ar(s.oe(),u,r.fieldTransforms)},t.prototype.Sa=function(t,e,n,r){var i=new Sr(1,t,De.H),o=[bt(t,e)],s=[n];if(0!=r.length%2)throw new me(ve.INVALID_ARGUMENT,\"Function \"+t+\"() needs to be called with an even number of arguments that alternate between field names and values.\");for(var u=0;u<r.length;u+=2)o.push(bt(t,r[u])),s.push(r[u+1]);for(var a=new Le(De.F),h=Qe._e(),c=0;c<o.length;++c){var f=o[c],l=i.Ia(f),p=this.ba(s[c],l);if(p instanceof mr)a=a.add(f);else{var d=this.va(p,l);null!=d&&(a=a.add(f),h.set(f,d))}}var y=qe.Kt(a);return new Ar(h.oe(),y,i.fieldTransforms)},t.prototype.Da=function(t,e,n){void 0===n&&(n=!1);var r=new Sr(n?4:3,t,De.H);return this.va(e,r)},t.prototype.ba=function(t,e){try{return this.Pa(t)}catch(t){var n=Et(t);throw e.Aa(n)}},t.prototype.va=function(t,e){if(gt(t=this.ba(t,e)))return wt(\"Unsupported field value:\",e,t),this.ga(t,e);if(t instanceof vr)return this.Ca(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.Ta&&4!==e.fa)throw e.Aa(\"Nested arrays are not supported\");return this.ka(t,e)}return this.Na(t,e)},t.prototype.ga=function(t,e){var n=this,r={};return o(t)?e.path&&0<e.path.length&&e.se.push(e.path):i(t,function(t,i){var o=n.va(i,e.Ea(t));null!=o&&(r[t]=o)}),{mapValue:{fields:r}}},t.prototype.ka=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],u=this.va(s,e.Ra(r));null==u&&(u={nullValue:\"NULL_VALUE\"}),n.push(u),r++}return{arrayValue:{values:n}}},t.prototype.Ca=function(t,e){if(!mt(e.fa))throw e.Aa(t.aa+\"() can only be used with update() and set()\");if(null===e.path)throw e.Aa(t.aa+\"() is not currently supported inside arrays\");if(t instanceof mr){if(2!==e.fa)throw 1===e.fa?e.Aa(\"FieldValue.delete() can only appear at the top level of your update data\"):e.Aa(\"FieldValue.delete() cannot be used with set() unless you pass {merge:true}\");e.se.push(e.path)}else if(t instanceof gr)e.fieldTransforms.push(new Be(e.path,Ue.instance));else if(t instanceof wr){var n=this.Fa(t.aa,t.ua),r=new Me(n);e.fieldTransforms.push(new Be(e.path,r))}else if(t instanceof br){var i=this.Fa(t.aa,t.ua),o=new je(i);e.fieldTransforms.push(new Be(e.path,o))}else if(t instanceof _r){var s=this.Da(\"FieldValue.increment\",t.ca),u=new Fe(this.serializer,s);e.fieldTransforms.push(new Be(e.path,u))}else G(\"Unknown FieldValue type: \"+t)},t.prototype.Na=function(t,e){if(null===t)return{nullValue:\"NULL_VALUE\"};if(\"number\"==typeof t)return this.serializer.Tn(t);if(\"boolean\"==typeof t)return{booleanValue:t};if(\"string\"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Te.fromDate(t);return{timestampValue:this.serializer.k(n)}}if(t instanceof Te){var r=new Te(t.seconds,1e3*se(t.nanoseconds/1e3));return{timestampValue:this.serializer.k(r)}}if(t instanceof Tr)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof lr)return{bytesValue:this.serializer.mn(t)};if(t instanceof Dr)return{referenceValue:this.serializer.wn(t.key.path,t.cn)};throw e.Aa(\"Unsupported field value: \"+ut(t))},t.prototype.Fa=function(t,e){var n=this;return e.map(function(e,r){var i=new Sr(3,t,De.H);return n.va(e,i.Ra(r))})},t}(),xr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.$a=t,this.Fr=e,this.Ma=n,this.La=r,this.Oa=i,this.xa=0,this.Ba=null,this.Ua=Date.now(),this.reset()}return t.prototype.reset=function(){this.xa=0},t.prototype.qa=function(){this.xa=this.Oa},t.prototype.Qa=function(t){var e=this;this.cancel();var n=se(this.xa+this.Wa()),r=oe(0,Date.now()-this.Ua),i=oe(0,n-r);0<this.xa&&F(\"ExponentialBackoff\",\"Backing off for \"+i+\" ms (base delay: \"+this.xa+\" ms, delay with jitter: \"+n+\" ms, last attempt: \"+r+\" ms ago)\"),this.Ba=this.$a.eo(this.Fr,i,function(){return e.Ua=Date.now(),t()}),this.xa*=this.La,this.xa<this.Ma&&(this.xa=this.Ma),this.xa>this.Oa&&(this.xa=this.Oa)},t.prototype.cancel=function(){null!==this.Ba&&(this.Ba.cancel(),this.Ba=null)},t.prototype.Wa=function(){return(Math.random()-.5)*this.xa},t}(),Or=function(){function t(t,e,n,r,i,o){this.$a=t,this.ja=n,this.Ka=r,this.Ga=i,this.listener=o,this.state=0,this.za=0,this.Ha=null,this.stream=null,this.Ja=new xr(t,e)}return t.prototype.Ya=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Xa=function(){return 2===this.state},t.prototype.start=function(){3===this.state?this.Za():this.auth()},t.prototype.stop=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.Ya()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.tu=function(){this.state=0,this.Ja.reset()},t.prototype.eu=function(){var t=this;this.Xa()&&null===this.Ha&&(this.Ha=this.$a.eo(this.ja,6e4,function(){return t.su()}))},t.prototype.nu=function(t){this.iu(),this.stream.send(t)},t.prototype.su=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){return this.Xa()?[2,this.close(0)]:[2]})})},t.prototype.iu=function(){this.Ha&&(this.Ha.cancel(),this.Ha=null)},t.prototype.close=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(n){switch(n.label){case 0:return this.iu(),this.Ja.cancel(),this.za++,3===t?e&&e.code===ve.RESOURCE_EXHAUSTED?(q(e.toString()),q(\"Using maximum backoff delay to prevent overloading the backend.\"),this.Ja.qa()):e&&e.code===ve.UNAUTHENTICATED&&this.Ga._():this.Ja.reset(),null!==this.stream&&(this.ru(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.ou(e)];case 1:return n.sent(),[2]}})})},t.prototype.ru=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hu(this.za),n=this.za;this.Ga.getToken().then(function(e){t.za===n&&t.au(e)},function(n){e(function(){var e=new me(ve.UNKNOWN,\"Fetching auth token failed: \"+n.message);return t.uu(e)})})},t.prototype.au=function(t){var e=this,n=this.hu(this.za);this.stream=this.cu(t),this.stream._u(function(){n(function(){return e.state=2,e.listener._u()})}),this.stream.ou(function(t){n(function(){return e.uu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Za=function(){var t=this;this.state=4,this.Ja.Qa(function(){return ae.__awaiter(t,void 0,void 0,function(){return ae.__generator(this,function(){return this.state=0,this.start(),[2]})})})},t.prototype.uu=function(t){return F(\"PersistentStream\",\"close with error: \"+t),this.stream=null,this.close(3,t)},t.prototype.hu=function(t){var e=this;return function(n){e.$a.qr(function(){return e.za===t?n():(F(\"PersistentStream\",\"stream callback skipped by getCloseGuardedDispatcher.\"),Promise.resolve())})}},t}(),Rr=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,\"listen_stream_connection_backoff\",\"listen_stream_idle\",n,r,o)||this).serializer=i,s}return ae.__extends(e,t),e.prototype.cu=function(t){return this.Ka.lu(\"Listen\",t)},e.prototype.onMessage=function(t){this.Ja.reset();var e=this.serializer.kn(t),n=this.serializer.Fn(t);return this.listener.du(e,n)},e.prototype.fu=function(t){var e={database:this.serializer.pn,addTarget:this.serializer.xe(t)},n=this.serializer.ei(t);n&&(e.labels=n),this.nu(e)},e.prototype.Tu=function(t){var e={};e.database=this.serializer.pn,e.removeTarget=t,this.nu(e)},e}(Or),Lr=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,\"write_stream_connection_backoff\",\"write_stream_idle\",n,r,o)||this).serializer=i,s.mu=!1,s.lastStreamToken=Pe.xt,s}return ae.__extends(e,t),Object.defineProperty(e.prototype,\"Eu\",{get:function(){return this.mu},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.mu=!1,t.prototype.start.call(this)},e.prototype.ru=function(){this.mu&&this.wu([])},e.prototype.cu=function(t){return this.Ka.lu(\"Write\",t)},e.prototype.onMessage=function(t){if(z(!!t.streamToken,\"Got a write response without a stream token\"),this.lastStreamToken=this.serializer.En(t.streamToken),this.mu){this.Ja.reset();var e=this.serializer.Wn(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Iu(n,e)}return z(!t.writeResults||0===t.writeResults.length,\"Got mutation results for handshake\"),this.mu=!0,this.listener.Ru()},e.prototype.Au=function(){var t={};t.database=this.serializer.pn,this.nu(t)},e.prototype.wu=function(t){var e=this,n={streamToken:this.serializer.mn(this.lastStreamToken),writes:t.map(function(t){return e.serializer.$n(t)})};this.nu(n)},e}(Or),Cr=function(){function t(t,e,n,r){this.$a=t,this.Ka=e,this.credentials=n,this.serializer=r}return t.prototype.Pu=function(t){return new Lr(this.$a,this.Ka,this.credentials,this.serializer,t)},t.prototype.Vu=function(t){return new Rr(this.$a,this.Ka,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.pn,writes:t.map(function(t){return e.serializer.$n(t)})};return this.gu(\"Commit\",n).then(function(t){return e.serializer.Wn(t.writeResults,t.commitTime)})},t.prototype.pu=function(t){var e=this,n={database:this.serializer.pn,documents:t.map(function(t){return e.serializer.An(t)})};return this.yu(\"BatchGetDocuments\",n).then(function(n){var r=k();n.forEach(function(t){var n=e.serializer.Cn(t);r=r.it(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);z(!!e,\"Missing entity in write response for \"+t),i.push(e)}),i})},t.prototype.gu=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.Ka.gu(t,e,r)}).catch(function(t){throw t.code===ve.UNAUTHENTICATED&&n.credentials._(),t})},t.prototype.yu=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.Ka.yu(t,e,r)}).catch(function(t){throw t.code===ve.UNAUTHENTICATED&&n.credentials._(),t})},t}(),Pr=function(){function t(t){this.bu=t,this.vu=R(),this.mutations=[],this.Su=!1,this.Du=null,this.Cu=new Set}return t.prototype.pu=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n=this;return ae.__generator(this,function(r){switch(r.label){case 0:if(this.ku(),0<this.mutations.length)throw new me(ve.INVALID_ARGUMENT,\"Firestore transactions require all reads to be executed before all writes.\");return[4,this.bu.pu(t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof en||t instanceof tn?n.Nu(t):G(\"Document in a transaction was a \"+t.constructor.name)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.da(t,this.Zt(t))),this.Cu.add(t)},t.prototype.update=function(t,e){try{this.write(e.da(t,this.Fu(t)))}catch(t){this.Du=t}this.Cu.add(t)},t.prototype.delete=function(t){this.write([new Xe(t,this.Zt(t))]),this.Cu.add(t)},t.prototype.commit=function(){return ae.__awaiter(this,void 0,void 0,function(){var t,e=this;return ae.__generator(this,function(n){switch(n.label){case 0:if(this.ku(),this.Du)throw this.Du;return t=this.vu,this.mutations.forEach(function(e){t=t.remove(e.key)}),t.forEach(function(t){e.mutations.push(new Je(t,e.Zt(t)))}),[4,this.bu.commit(this.mutations)];case 1:return n.sent(),this.Su=!0,[2]}})})},t.prototype.Nu=function(t){var e;if(t instanceof tn)e=t.version;else{if(!(t instanceof en))throw G(\"Document in a transaction was a \"+t.constructor.name);e=Ie.S()}var n=this.vu.get(t.key);if(null===n)this.vu=this.vu.it(t.key,e);else if(!e.isEqual(n))throw new me(ve.ABORTED,\"Document version changed between two reads.\")},t.prototype.Zt=function(t){var e=this.vu.get(t);return!this.Cu.has(t)&&e?ze.updateTime(e):ze.NONE},t.prototype.Fu=function(t){var e=this.vu.get(t);if(!this.Cu.has(t)&&e){if(e.isEqual(Ie.S()))throw new me(ve.INVALID_ARGUMENT,\"Can't update a document that doesn't exist.\");return ze.updateTime(e)}return ze.exists(!0)},t.prototype.write=function(t){this.ku(),this.mutations=this.mutations.concat(t)},t.prototype.ku=function(){},t}(),Vr=function(){function t(t,e){this.Nr=t,this.$u=e,this.state=\"Unknown\",this.Mu=0,this.Lu=null,this.Ou=!0}return t.prototype.xu=function(){var t=this;0===this.Mu&&(this.Bu(\"Unknown\"),this.Lu=this.Nr.eo(\"online_state_timeout\",1e4,function(){return t.Lu=null,t.Uu(\"Backend didn't respond within 10 seconds.\"),t.Bu(\"Offline\"),Promise.resolve()}))},t.prototype.qu=function(t){\"Online\"===this.state?this.Bu(\"Unknown\"):(this.Mu++,1<=this.Mu&&(this.Qu(),this.Uu(\"Connection failed 1 times. Most recent error: \"+t.toString()),this.Bu(\"Offline\")))},t.prototype.set=function(t){this.Qu(),this.Mu=0,\"Online\"===t&&(this.Ou=!1),this.Bu(t)},t.prototype.Bu=function(t){t!==this.state&&(this.state=t,this.$u(t))},t.prototype.Uu=function(t){var e=\"Could not reach Cloud Firestore backend. \"+t+\"\\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.\";this.Ou?(q(e),this.Ou=!1):F(\"OnlineStateTracker\",e)},t.prototype.Qu=function(){null!==this.Lu&&(this.Lu.cancel(),this.Lu=null)},t}(),Ur=function(){function t(t,e,n,r,i){var o=this;this.Wu=t,this.bu=e,this.ju=[],this.Ku=new Map,this.Gu=null,this.networkEnabled=!1,this.isPrimary=!1,this.zu=i,this.zu.Hu(function(){n.qr(function(){return ae.__awaiter(o,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.Ju()?(F(\"RemoteStore\",\"Restarting streams for network reachability change.\"),[4,this.Yu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xu=new Vr(n,r),this.Zu=this.bu.Vu({_u:this.tc.bind(this),ou:this.ec.bind(this),du:this.sc.bind(this)}),this.nc=this.bu.Pu({_u:this.ic.bind(this),ou:this.rc.bind(this),Ru:this.oc.bind(this),Iu:this.Iu.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return ae.__awaiter(this,void 0,void 0,function(){var t;return ae.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.Ju()?(t=this.nc,[4,this.Wu.ph()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.hc()?this.ac():this.Xu.set(\"Unknown\"),[4,this.uc()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.cc()];case 1:return t.sent(),this.Xu.set(\"Offline\"),[2]}})})},t.prototype.cc=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return[4,this.nc.stop()];case 1:return t.sent(),[4,this.Zu.stop()];case 2:return t.sent(),0<this.ju.length&&(F(\"RemoteStore\",\"Stopping write stream with \"+this.ju.length+\" pending writes\"),this.ju=[]),this._c(),[2]}})})},t.prototype.lc=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return F(\"RemoteStore\",\"RemoteStore shutting down.\"),this.networkEnabled=!1,[4,this.cc()];case 1:return t.sent(),this.zu.lc(),this.Xu.set(\"Unknown\"),[2]}})})},t.prototype.listen=function(t){this.Ku.has(t.targetId)||(this.Ku.set(t.targetId,t),this.hc()?this.ac():this.Zu.Xa()&&this.dc(t))},t.prototype.fc=function(t){this.Ku.delete(t),this.Zu.Xa()&&this.Tc(t),0===this.Ku.size&&(this.Zu.Xa()?this.Zu.eu():this.Ju()&&this.Xu.set(\"Unknown\"))},t.prototype.un=function(t){return this.Ku.get(t)||null},t.prototype.an=function(t){return this.mc.an(t)},t.prototype.dc=function(t){this.Gu.Bs(t.targetId),this.Zu.fu(t)},t.prototype.Tc=function(t){this.Gu.Bs(t),this.Zu.Tu(t)},t.prototype.ac=function(){this.Gu=new Vn(this),this.Zu.start(),this.Xu.xu()},t.prototype.hc=function(){return this.Ju()&&!this.Zu.Ya()&&0<this.Ku.size},t.prototype.Ju=function(){return this.isPrimary&&this.networkEnabled},t.prototype._c=function(){this.Gu=null},t.prototype.tc=function(){return ae.__awaiter(this,void 0,void 0,function(){var t=this;return ae.__generator(this,function(){return this.Ku.forEach(function(e){t.dc(e)}),[2]})})},t.prototype.ec=function(t){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){return this._c(),this.hc()?(this.Xu.qu(t),this.ac()):this.Xu.set(\"Unknown\"),[2]})})},t.prototype.sc=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){var n;return ae.__generator(this,function(r){switch(r.label){case 0:return this.Xu.set(\"Online\"),t instanceof Cn&&2===t.state&&t.cause?[2,this.Ec(t)]:(t instanceof Rn?this.Gu.zs(t):t instanceof Ln?this.Gu.sn(t):this.Gu.Ys(t),e.isEqual(Ie.MIN)?[3,4]:[4,this.Wu.bh()]);case 1:return n=r.sent(),0<=e.D(n)?[4,this.wc(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:r.label=4;case 4:return[2]}})})},t.prototype.wc=function(t){var e=this,n=this.Gu.rn(t);return n.Ts.forEach(function(n,r){if(0<n.resumeToken.Ot()){var i=e.Ku.get(r);i&&e.Ku.set(r,i.ss(n.resumeToken,t))}}),n.ms.forEach(function(t){var n=e.Ku.get(t);if(n){e.Ku.set(t,n.ss(Pe.xt,n.ts)),e.Tc(t);var r=new bn(n.target,t,1,n.sequenceNumber);e.dc(r)}}),this.mc.vh(n)},t.prototype.Ec=function(t){var e=this,n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return ae.__awaiter(e,void 0,void 0,function(){return ae.__generator(this,function(){return this.Ku.has(t)?[2,(this.Ku.delete(t),this.Gu.removeTarget(t),this.mc.Ic(t,n))]:[2]})})})}),r},t.prototype.uc=function(){return ae.__awaiter(this,void 0,void 0,function(){var t,e;return ae.__generator(this,function(n){switch(n.label){case 0:return this.Rc()?(t=0<this.ju.length?this.ju[this.ju.length-1].batchId:-1,[4,this.Wu.Oh(t)]):[3,5];case 1:return null===(e=n.sent())?(0===this.ju.length&&this.nc.eu(),[3,4]):[3,2];case 2:return this.Ac(e),[4,this.uc()];case 3:n.sent(),n.label=4;case 4:n.label=5;case 5:return this.Pc()&&this.Vc(),[2]}})})},t.prototype.Rc=function(){return this.Ju()&&10>this.ju.length},t.prototype.gc=function(){return this.ju.length},t.prototype.Ac=function(t){this.ju.push(t),this.nc.Xa()&&this.nc.Eu&&this.nc.wu(t.mutations)},t.prototype.Pc=function(){return this.Ju()&&!this.nc.Ya()&&0<this.ju.length},t.prototype.Vc=function(){this.nc.start()},t.prototype.ic=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){return this.nc.Au(),[2]})})},t.prototype.oc=function(){var t=this;return this.Wu.yh(this.nc.lastStreamToken).then(function(){for(var e,n=0,r=t.ju;n<r.length;n++)e=r[n],t.nc.wu(e.mutations)}).catch(X)},t.prototype.Iu=function(t,e){var n=this,r=this.ju.shift(),i=Hn.from(r,t,e,this.nc.lastStreamToken);return this.mc.pc(i).then(function(){return n.uc()})},t.prototype.rc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n=this;return ae.__generator(this,function(){return t&&0<this.ju.length?[2,(e=this.nc.Eu?this.yc(t):this.bc(t),e.then(function(){n.Pc()&&n.Vc()}))]:[2]})})},t.prototype.bc=function(t){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){return S(t.code)?[2,(F(\"RemoteStore\",\"RemoteStore error before completed handshake; resetting stream token: \",this.nc.lastStreamToken),this.nc.lastStreamToken=Pe.xt,this.Wu.yh(Pe.xt).catch(X))]:[2]})})},t.prototype.yc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return ae.__generator(this,function(){return S(n=t.code)&&n!==ve.ABORTED?(e=this.ju.shift(),[2,(this.nc.tu(),this.mc.vc(e.batchId,t).then(function(){return r.uc()}))]):[2]})})},t.prototype.Sc=function(){return new Pr(this.bu)},t.prototype.Yu=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.cc()];case 1:return t.sent(),this.Xu.set(\"Unknown\"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.Dc=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.Ju()?(F(\"RemoteStore\",\"RemoteStore restarting streams for new credential\"),[4,this.Yu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Cc=function(t){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:[4,this.cc()];case 3:e.sent(),this.Xu.set(\"Unknown\"),e.label=4;case 4:e.label=5;case 5:return[2]}})})},t}(),Mr=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.kc=function(e,n,r){var i,o=JSON.parse(r),s=\"object\"==typeof o&&-1!==[\"pending\",\"acknowledged\",\"rejected\"].indexOf(o.state)&&(void 0===o.error||\"object\"==typeof o.error);return s&&o.error&&(s=\"string\"==typeof o.error.message&&\"string\"==typeof o.error.code)&&(i=new me(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(q(\"SharedClientState\",\"Failed to parse mutation state for ID '\"+n+\"': \"+r),null)},t.prototype.Nc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),jr=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.kc=function(e,n){var r,i=JSON.parse(n),o=\"object\"==typeof i&&-1!==[\"not-current\",\"current\",\"rejected\"].indexOf(i.state)&&(void 0===i.error||\"object\"==typeof i.error);return o&&i.error&&(o=\"string\"==typeof i.error.message&&\"string\"==typeof i.error.code)&&(r=new me(i.error.code,i.error.message)),o?new t(e,i.state,r):(q(\"SharedClientState\",\"Failed to parse target state for ID '\"+e+\"': \"+n),null)},t.prototype.Nc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Fr=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.kc=function(e,n){for(var r=JSON.parse(n),i=\"object\"==typeof r&&r.activeTargetIds instanceof Array,o=C(),s=0;i&&s<r.activeTargetIds.length;++s)i=a(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(q(\"SharedClientState\",\"Failed to parse client data for instance '\"+e+\"': \"+n),null)},t}(),qr=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.kc=function(e){var n=JSON.parse(e);return\"object\"==typeof n&&-1!==[\"Unknown\",\"Online\",\"Offline\"].indexOf(n.onlineState)&&\"string\"==typeof n.clientId?new t(n.clientId,n.onlineState):(q(\"SharedClientState\",\"Failed to parse online state: \"+e),null)},t}(),Br=function(){function t(){this.activeTargetIds=C()}return t.prototype.Fc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.$c=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Nc=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Gr=function(){function t(e,n,r,i,o){if(this.$a=e,this.platform=n,this.persistenceKey=r,this.Mc=i,this.mc=null,this.$u=null,this.vr=null,this.Lc={},this.Oc=this.xc.bind(this),this.ko=!1,this.Bc=[],!t.Uc(this.platform))throw new me(ve.UNIMPLEMENTED,\"LocalStorage is not available on this platform.\");var s=r.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\");this.storage=this.platform.window.localStorage,this.currentUser=o,this.qc=Tt(this.persistenceKey,this.Mc),this.Qc=function(t){return\"firestore_sequence_number_\"+t}(this.persistenceKey),this.Lc[this.Mc]=new Br,this.Wc=new RegExp(\"^firestore_clients_\"+s+\"_([^_]*)$\"),this.jc=new RegExp(\"^firestore_mutations_\"+s+\"_(\\\\d+)(?:_(.*))?$\"),this.Kc=new RegExp(\"^firestore_targets_\"+s+\"_(\\\\d+)$\"),this.Gc=function(t){return\"firestore_online_state_\"+t}(this.persistenceKey),this.platform.window.addEventListener(\"storage\",this.Oc)}return t.Uc=function(t){return t.window&&null!=t.window.localStorage},t.prototype.start=function(){return ae.__awaiter(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,h,c,f=this;return ae.__generator(this,function(l){switch(l.label){case 0:return[4,this.mc.Jh()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Mc&&(i=this.getItem(Tt(this.persistenceKey,r)))&&(o=Fr.kc(r,i))&&(this.Lc[o.clientId]=o);for(this.zc(),(s=this.storage.getItem(this.Gc))&&(u=this.Hc(s))&&this.Jc(u),a=0,h=this.Bc;a<h.length;a++)c=h[a],this.xc(c);return this.Bc=[],this.platform.window.addEventListener(\"unload\",function(){return f.lc()}),this.ko=!0,[2]}})})},t.prototype.Cr=function(t){this.setItem(this.Qc,JSON.stringify(t))},t.prototype.Yc=function(){var t=C();return i(this.Lc,function(e,n){t=t.Ft(n.activeTargetIds)}),t},t.prototype.Xc=function(t){for(var e in this.Lc)if(this.Lc.hasOwnProperty(e)&&this.Lc[e].activeTargetIds.has(t))return!0;return!1},t.prototype.Zc=function(t){this.t_(t,\"pending\")},t.prototype.e_=function(t,e,n){this.t_(t,e,n),this.s_(t)},t.prototype.n_=function(t){var e=\"not-current\";if(this.Xc(t)){var n=this.storage.getItem(Nt(this.persistenceKey,t));if(n){var r=jr.kc(t,n);r&&(e=r.state)}}return this.i_.Fc(t),this.zc(),e},t.prototype.r_=function(t){this.i_.$c(t),this.zc()},t.prototype.o_=function(t){return this.i_.activeTargetIds.has(t)},t.prototype.h_=function(t){this.removeItem(Nt(this.persistenceKey,t))},t.prototype.a_=function(t,e,n){this.u_(t,e,n)},t.prototype.oh=function(t,e,n){var r=this;e.forEach(function(t){r.s_(t)}),this.currentUser=t,n.forEach(function(t){r.Zc(t)})},t.prototype.c_=function(t){this.__(t)},t.prototype.lc=function(){this.ko&&(this.platform.window.removeEventListener(\"storage\",this.Oc),this.removeItem(this.qc),this.ko=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return F(\"SharedClientState\",\"READ\",t,e),e},t.prototype.setItem=function(t,e){F(\"SharedClientState\",\"SET\",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){F(\"SharedClientState\",\"REMOVE\",t),this.storage.removeItem(t)},t.prototype.xc=function(t){var e=this;if(t.storageArea===this.storage){if(F(\"SharedClientState\",\"EVENT\",t.key,t.newValue),t.key===this.qc)return void q(\"Received WebStorage notification for local change. Another client might have garbage-collected our state\");this.$a.qr(function(){return ae.__awaiter(e,void 0,void 0,function(){var e,n,r,i,o,s;return ae.__generator(this,function(){if(this.ko){if(null!==t.key)if(this.Wc.test(t.key)){if(null==t.newValue)return e=this.l_(t.key),[2,this.d_(e,null)];if(n=this.f_(t.key,t.newValue))return[2,this.d_(n.clientId,n)]}else if(this.jc.test(t.key)){if(null!==t.newValue&&(r=this.T_(t.key,t.newValue)))return[2,this.m_(r)]}else if(this.Kc.test(t.key)){if(null!==t.newValue&&(i=this.E_(t.key,t.newValue)))return[2,this.w_(i)]}else if(t.key!==this.Gc)t.key===this.Qc&&(s=function(t){var e=nr.kr;if(null!=t)try{var n=JSON.parse(t);z(\"number\"==typeof n,\"Found non-numeric sequence number\"),e=n}catch(n){q(\"SharedClientState\",\"Failed to read sequence number from WebStorage\",n)}return e}(t.newValue))!==nr.kr&&this.vr(s);else if(null!==t.newValue&&(o=this.Hc(t.newValue)))return[2,this.Jc(o)]}else this.Bc.push(t);return[2]})})})}},Object.defineProperty(t.prototype,\"i_\",{get:function(){return this.Lc[this.Mc]},enumerable:!0,configurable:!0}),t.prototype.zc=function(){this.setItem(this.qc,this.i_.Nc())},t.prototype.t_=function(t,e,n){var r=new Mr(this.currentUser,t,e,n),i=It(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Nc())},t.prototype.s_=function(t){var e=It(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.__=function(t){var e={clientId:this.Mc,onlineState:t};this.storage.setItem(this.Gc,JSON.stringify(e))},t.prototype.u_=function(t,e,n){var r=Nt(this.persistenceKey,t),i=new jr(t,e,n);this.setItem(r,i.Nc())},t.prototype.l_=function(t){var e=this.Wc.exec(t);return e?e[1]:null},t.prototype.f_=function(t,e){var n=this.l_(t);return Fr.kc(n,e)},t.prototype.T_=function(t,e){var n=this.jc.exec(t),r=+n[1],i=void 0===n[2]?null:n[2];return Mr.kc(new ye(i),r,e)},t.prototype.E_=function(t,e){var n=+this.Kc.exec(t)[1];return jr.kc(n,e)},t.prototype.Hc=function(t){return qr.kc(t)},t.prototype.m_=function(t){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){return t.user.uid===this.currentUser.uid?[2,this.mc.I_(t.batchId,t.state,t.error)]:(F(\"SharedClientState\",\"Ignoring mutation for non-active user \"+t.user.uid),[2])})})},t.prototype.w_=function(t){return this.mc.R_(t.targetId,t.state,t.error)},t.prototype.d_=function(t,e){var n=this,r=this.Yc();e?this.Lc[t]=e:delete this.Lc[t];var i=this.Yc(),o=[],s=[];return i.forEach(function(t){return ae.__awaiter(n,void 0,void 0,function(){return ae.__generator(this,function(){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return ae.__awaiter(n,void 0,void 0,function(){return ae.__generator(this,function(){return i.has(t)||s.push(t),[2]})})}),this.mc.A_(o,s)},t.prototype.Jc=function(t){this.Lc[t.clientId]&&this.$u(t.onlineState)},t}(),zr=function(){function t(){this.P_=new Br,this.V_={},this.mc=null,this.$u=null,this.vr=null}return t.prototype.Zc=function(){},t.prototype.e_=function(){},t.prototype.n_=function(t){return this.P_.Fc(t),this.V_[t]||\"not-current\"},t.prototype.a_=function(t,e){this.V_[t]=e},t.prototype.r_=function(t){this.P_.$c(t)},t.prototype.o_=function(t){return this.P_.activeTargetIds.has(t)},t.prototype.h_=function(t){delete this.V_[t]},t.prototype.Yc=function(){return this.P_.activeTargetIds},t.prototype.Xc=function(t){return this.P_.activeTargetIds.has(t)},t.prototype.start=function(){return this.P_=new Br,Promise.resolve()},t.prototype.oh=function(){},t.prototype.c_=function(){},t.prototype.lc=function(){},t.prototype.Cr=function(){},t}(),Kr=function(){function t(t){this.g_=t}return t.prototype.next=function(){return this.g_+=2,this.g_},t.p_=function(){return new t(0)},t.y_=function(){return new t(-1)},t}(),Wr=function(t){this.key=t},Hr=function(t){this.key=t},Yr=function(){function t(t,e){this.query=t,this.b_=e,this.v_=null,this.As=!1,this.S_=L(),this._s=L(),this.D_=new Sn(t.Be.bind(t))}return Object.defineProperty(t.prototype,\"C_\",{get:function(){return this.b_},enumerable:!0,configurable:!0}),t.prototype.k_=function(t,e){var n=this,r=e?e.N_:new Dn,i=e?e.D_:this.D_,o=e?e._s:this._s,s=i,u=!1,a=this.query.je()&&i.size===this.query.limit?i.last():null,h=this.query.Ke()&&i.size===this.query.limit?i.first():null;if(t.ut(function(t,e){var c=i.get(t),f=e instanceof tn?e:null;f&&(f=n.query.matches(f)?f:null);var l=!!c&&n._s.has(c.key),p=!!f&&(f.te||n._s.has(f.key)&&f.hasCommittedMutations),d=!1;c&&f?c.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.F_(c,f)||(r.track({type:2,doc:f}),d=!0,(a&&0<n.query.Be(f,a)||h&&0>n.query.Be(f,h))&&(u=!0)):!c&&f?(r.track({type:0,doc:f}),d=!0):c&&!f&&(r.track({type:1,doc:c}),d=!0,(a||h)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),this.query.je()||this.query.Ke())for(;s.size>this.query.limit;){var c=this.query.je()?s.last():s.first();s=s.delete(c.key),o=o.delete(c.key),r.track({type:1,doc:c})}return{D_:s,N_:r,M_:u,_s:o}},t.prototype.F_=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},t.prototype.nr=function(t,e,n){var r=this,i=this.D_;this.D_=t.D_,this._s=t._s;var o=t.N_.us();o.sort(function(t,e){return function(t,e){var n=function(t){return 0===t?1:2===t||3===t?2:1===t?0:G(\"Unknown ChangeType: \"+t)};return n(t)-n(e)}(t.type,e.type)||r.query.Be(t.doc,e.doc)}),this.L_(n);var s=e?this.O_():[],u=0===this.S_.size&&this.As?1:0,a=u!==this.v_;return this.v_=u,0!==o.length||a?{snapshot:new kn(this.query,t.D_,i,o,t._s,0==u,a,!1),x_:s}:{x_:s}},t.prototype.B_=function(t){return this.As&&\"Offline\"===t?(this.As=!1,this.nr({D_:this.D_,N_:new Dn,_s:this._s,M_:!1},!1)):{x_:[]}},t.prototype.U_=function(t){return!this.b_.has(t)&&!!this.D_.has(t)&&!this.D_.get(t).te},t.prototype.L_=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.b_=e.b_.add(t)}),t.Vs.forEach(function(){}),t.gs.forEach(function(t){return e.b_=e.b_.delete(t)}),this.As=t.As)},t.prototype.O_=function(){var t=this;if(!this.As)return[];var e=this.S_;this.S_=L(),this.D_.forEach(function(e){t.U_(e.key)&&(t.S_=t.S_.add(e.key))});var n=[];return e.forEach(function(e){t.S_.has(e)||n.push(new Hr(e))}),this.S_.forEach(function(t){e.has(t)||n.push(new Wr(t))}),n},t.prototype.q_=function(t){this.b_=t.zh,this.S_=L();var e=this.k_(t.documents);return this.nr(e,!0)},t.prototype.Q_=function(){return kn.fs(this.query,this.D_,this._s,0===this.v_)},t}(),Xr=function(){function t(t,e,n,r){this.Nr=t,this.W_=e,this.updateFunction=n,this.Lr=r,this.j_=5,this.Ja=new xr(this.Nr,\"retry_transaction\")}return t.prototype.K_=function(){this.G_()},t.prototype.G_=function(){var t=this;this.Ja.Qa(function(){return ae.__awaiter(t,void 0,void 0,function(){var t,e,n=this;return ae.__generator(this,function(){return t=this.W_.Sc(),(e=this.z_(t))&&e.then(function(e){n.Nr.qr(function(){return t.commit().then(function(){n.Lr.resolve(e)}).catch(function(t){n.H_(t)})})}).catch(function(t){n.H_(t)}),[2]})})})},t.prototype.z_=function(t){try{var e=this.updateFunction(t);return!s(e)&&e.catch&&e.then?e:(this.Lr.reject(Error(\"Transaction callback must return a Promise\")),null)}catch(t){return this.Lr.reject(t),null}},t.prototype.H_=function(t){var e=this;0<this.j_&&this.J_(t)?(this.j_-=1,this.Nr.qr(function(){return e.G_(),Promise.resolve()})):this.Lr.reject(t)},t.prototype.J_=function(t){if(\"FirebaseError\"===t.name){var e=t.code;return\"aborted\"===e||\"failed-precondition\"===e||!S(e)}return!1},t}(),Jr=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Qr=function(t){this.key=t,this.Y_=!1},Zr=function(){function t(t,e,n,r,i){this.Wu=t,this.W_=e,this.X_=n,this.currentUser=r,this.Z_=i,this.tl=null,this.el=new Kn(function(t){return t.canonicalId()}),this.sl=new Map,this.nl=[],this.il=new xe(ke.F),this.rl=new Map,this.ol=new Yn,this.hl={},this.al=new Map,this.ul=Kr.y_(),this.isPrimary=void 0,this.onlineState=\"Unknown\"}return Object.defineProperty(t.prototype,\"cl\",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.tl=t},t.prototype.listen=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o;return ae.__generator(this,function(s){switch(s.label){case 0:return this._l(\"listen()\"),(r=this.el.get(t))?(e=r.targetId,this.X_.n_(e),n=r.view.Q_(),[3,4]):[3,1];case 1:return[4,this.Wu.Uh(t.xe())];case 2:return i=s.sent(),o=this.X_.n_(i.targetId),e=i.targetId,[4,this.ll(t,e,\"current\"===o)];case 3:n=s.sent(),this.isPrimary&&this.W_.listen(i),s.label=4;case 4:return[2,(this.tl.du([n]),e)]}})})},t.prototype.ll=function(t,e,n){return ae.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,a;return ae.__generator(this,function(h){switch(h.label){case 0:return[4,this.Wu.Kh(t,!0)];case 1:return r=h.sent(),i=new Yr(t,r.zh),o=i.k_(r.documents),s=On.Rs(e,n&&\"Offline\"!==this.onlineState),u=i.nr(o,!0===this.isPrimary,s),a=new Jr(t,e,i),[2,(this.el.set(t,a),this.sl.has(e)?this.sl.get(e).push(t):this.sl.set(e,[t]),u.snapshot)]}})})},t.prototype.dl=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n;return ae.__generator(this,function(r){switch(r.label){case 0:return[4,this.Wu.Kh(t.query,!0)];case 1:return e=r.sent(),n=t.view.q_(e),[2,(this.isPrimary&&this.fl(t.targetId,n.x_),n)]}})})},t.prototype.fc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return ae.__generator(this,function(i){switch(i.label){case 0:return this._l(\"unlisten()\"),e=this.el.get(t),1<(n=this.sl.get(e.targetId)).length?[2,(this.sl.set(e.targetId,n.filter(function(e){return!e.isEqual(t)})),void this.el.delete(t))]:this.isPrimary?(this.X_.r_(e.targetId),this.X_.Xc(e.targetId)?[3,2]:[4,this.Wu.jh(e.targetId,!1).then(function(){r.X_.h_(e.targetId),r.W_.fc(e.targetId),r.Tl(e.targetId)}).catch(X)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.Tl(e.targetId),[4,this.Wu.jh(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){var n;return ae.__generator(this,function(r){switch(r.label){case 0:return this._l(\"write()\"),[4,this.Wu.lh(t)];case 1:return n=r.sent(),this.X_.Zc(n.batchId),this.ml(n.batchId,e),[4,this.El(n.zi)];case 2:return r.sent(),[4,this.W_.uc()];case 3:return r.sent(),[2]}})})},t.prototype.runTransaction=function(t,e,n){new Xr(t,this.W_,e,n).K_()},t.prototype.vh=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n=this;return ae.__generator(this,function(r){switch(r.label){case 0:this._l(\"applyRemoteEvent()\"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.Wu.vh(t)];case 2:return e=r.sent(),t.Ts.forEach(function(t,e){var r=n.rl.get(e);r&&(z(1>=t.Ps.size+t.Vs.size+t.gs.size,\"Limbo resolution for single document contains multiple changes.\"),0<t.Ps.size?r.Y_=!0:0<t.Vs.size?z(r.Y_,\"Received change for limbo target document without add.\"):0<t.gs.size&&(z(r.Y_,\"Received remove for limbo target document without add.\"),r.Y_=!1))}),[4,this.El(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,X(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.B_=function(t,e){if(this.isPrimary&&0===e||!this.isPrimary&&1===e){this._l(\"applyOnlineStateChange()\");var n=[];this.el.forEach(function(e,r){var i=r.view.B_(t);i.snapshot&&n.push(i.snapshot)}),this.tl.wl(t),this.tl.du(n),this.onlineState=t,this.isPrimary&&this.X_.c_(t)}},t.prototype.Ic=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u=this;return ae.__generator(this,function(a){switch(a.label){case 0:return this._l(\"rejectListens()\"),this.X_.a_(t,\"rejected\",e),n=this.rl.get(t),(r=n&&n.key)?(this.il=this.il.remove(r),this.rl.delete(t),this.Il(),i=(i=new xe(ke.F)).it(r,new en(r,Ie.S())),o=L().add(r),s=new xn(Ie.MIN,new Map,new Le(K),i,o),[2,this.vh(s)]):[4,this.Wu.jh(t,!1).then(function(){return u.Tl(t,e)}).catch(X)];case 1:return a.sent(),[2]}})})},t.prototype.I_=function(t,e,n){return ae.__awaiter(this,void 0,void 0,function(){var r;return ae.__generator(this,function(i){switch(i.label){case 0:return this._l(\"applyBatchState()\"),[4,this.Wu.fh(t)];case 1:return null===(r=i.sent())?[3,6]:\"pending\"===e?[4,this.W_.uc()]:[3,3];case 2:return i.sent(),[3,4];case 3:\"acknowledged\"===e||\"rejected\"===e?(this.Rl(t,n||null),this.Wu.Yh(t)):G(\"Unknown batchState: \"+e),i.label=4;case 4:return[4,this.El(r)];case 5:return i.sent(),[3,7];case 6:F(\"SyncEngine\",\"Cannot apply mutation batch with id: \"+t),i.label=7;case 7:return[2]}})})},t.prototype.pc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n;return ae.__generator(this,function(r){switch(r.label){case 0:this._l(\"applySuccessfulWrite()\"),e=t.batch.batchId,this.Rl(e,null),this.Al(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.Wu.mh(t)];case 2:return n=r.sent(),this.X_.e_(e,\"acknowledged\"),[4,this.El(n)];case 3:return r.sent(),[3,6];case 4:return[4,X(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.vc=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){var n;return ae.__generator(this,function(r){switch(r.label){case 0:this._l(\"rejectFailedWrite()\"),this.Rl(t,e),this.Al(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.Wu.Ah(t)];case 2:return n=r.sent(),this.X_.e_(t,\"rejected\",e),[4,this.El(n)];case 3:return r.sent(),[3,6];case 4:return[4,X(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.Pl=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n;return ae.__generator(this,function(r){switch(r.label){case 0:return this.W_.Ju()||F(\"SyncEngine\",\"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.\"),[4,this.Wu.gh()];case 1:return-1===(e=r.sent())?[2,void t.resolve()]:((n=this.al.get(e)||[]).push(t),this.al.set(e,n),[2])}})})},t.prototype.Al=function(t){(this.al.get(t)||[]).forEach(function(t){t.resolve()}),this.al.delete(t)},t.prototype.Vl=function(t){this.al.forEach(function(e){e.forEach(function(e){e.reject(new me(ve.CANCELLED,t))})}),this.al.clear()},t.prototype.ml=function(t,e){var n=this.hl[this.currentUser.s()];n||(n=new xe(K)),n=n.it(t,e),this.hl[this.currentUser.s()]=n},t.prototype.Rl=function(t,e){var n=this.hl[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.hl[this.currentUser.s()]=n}},t.prototype.Tl=function(t,e){var n=this;void 0===e&&(e=null),this.X_.r_(t);for(var r,i=0,o=this.sl.get(t);i<o.length;i++)r=o[i],this.el.delete(r),e&&this.tl.gl(r,e);if(this.sl.delete(t),this.isPrimary){var s=this.ol.$i(t);this.ol.Ni(t),s.forEach(function(t){n.ol.Mi(t)||n.pl(t)})}},t.prototype.pl=function(t){var e=this.il.get(t);null!==e&&(this.W_.fc(e),this.il=this.il.remove(t),this.rl.delete(e),this.Il())},t.prototype.fl=function(t,e){for(var n,r=0,i=e;r<i.length;r++)(n=i[r])instanceof Wr?(this.ol.vi(n.key,t),this.yl(n)):n instanceof Hr?(F(\"SyncEngine\",\"Document no longer in limbo: \"+n.key),this.ol.Di(n.key,t),this.ol.Mi(n.key)||this.pl(n.key)):G(\"Unknown limbo change: \"+JSON.stringify(n))},t.prototype.yl=function(t){var e=t.key;this.il.get(e)||(F(\"SyncEngine\",\"New document in limbo: \"+e),this.nl.push(e),this.Il())},t.prototype.Il=function(){for(;0<this.nl.length&&this.il.size<this.Z_;){var t=this.nl.shift(),e=this.ul.next();this.rl.set(e,new Qr(t)),this.il=this.il.it(t,e),this.W_.listen(new bn(on.ve(t.path).xe(),e,2,nr.kr))}},t.prototype.bl=function(){return this.il},t.prototype.vl=function(){return this.nl},t.prototype.El=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return ae.__generator(this,function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.el.forEach(function(s,u){i.push(Promise.resolve().then(function(){var e=u.view.k_(t);return e.M_?o.Wu.Kh(u.query,!1).then(function(t){var n=t.documents;return u.view.k_(n,e)}):e}).then(function(t){var i=e&&e.Ts.get(u.targetId),s=u.view.nr(t,!0===o.isPrimary,i);if(o.fl(u.targetId,s.x_),s.snapshot){o.isPrimary&&o.X_.a_(u.targetId,s.snapshot.fromCache?\"not-current\":\"current\"),n.push(s.snapshot);var a=er.br(u.targetId,s.snapshot);r.push(a)}}))}),[4,Promise.all(i)];case 1:return s.sent(),this.tl.du(n),[4,this.Wu.Lh(r)];case 2:return s.sent(),[2]}})})},t.prototype._l=function(){},t.prototype.Dc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n;return ae.__generator(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.Vl(\"'waitForPendingWrites' promise is rejected due to a user change.\"),[4,this.Wu.oh(t)]):[3,3];case 1:return n=r.sent(),this.X_.oh(t,n.uh,n._h),[4,this.El(n.ah)];case 2:r.sent(),r.label=3;case 3:return[4,this.W_.Dc()];case 4:return r.sent(),[2]}})})},t.prototype.Cc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return ae.__generator(this,function(h){switch(h.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.W_.Cc(!0)]);case 1:return h.sent(),e=this.X_.Yc(),[4,this.Sl(e.j())];case 2:for(n=h.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.W_.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),this.sl.forEach(function(t,e){a.X_.o_(e)?s.push(e):u=u.then(function(){return a.Tl(e),a.Wu.jh(e,!0)}),a.W_.fc(e)}),[4,u]);case 4:return h.sent(),[4,this.Sl(s)];case 5:return h.sent(),this.Dl(),[4,this.W_.Cc(!1)];case 6:h.sent(),h.label=7;case 7:return[2]}})})},t.prototype.Dl=function(){var t=this;this.rl.forEach(function(e,n){t.W_.fc(n)}),this.ol.Fi(),this.rl=new Map,this.il=new xe(ke.F)},t.prototype.Sl=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return ae.__generator(this,function(d){switch(d.label){case 0:e=[],n=[],r=0,i=t,d.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.sl.get(o))&&0!==u.length?[4,this.Wu.jh(o,!0)]:[3,8]):[3,14];case 2:return d.sent(),[4,this.Wu.Uh(u[0].xe())];case 3:s=d.sent(),a=0,h=u,d.label=4;case 4:return a<h.length?(c=h[a],f=this.el.get(c),[4,this.dl(f)]):[3,7];case 5:(l=d.sent()).snapshot&&n.push(l.snapshot),d.label=6;case 6:return a++,[3,4];case 7:return[3,12];case 8:return[4,this.Wu.ta(o)];case 9:return p=d.sent(),[4,this.Wu.Uh(p)];case 10:return s=d.sent(),[4,this.ll(this.Cl(p),o,!1)];case 11:d.sent(),d.label=12;case 12:e.push(s),d.label=13;case 13:return r++,[3,1];case 14:return[2,(this.tl.du(n),e)]}})})},t.prototype.Cl=function(t){return new on(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,\"F\",t.startAt,t.endAt)},t.prototype.Jh=function(){return this.Wu.Jh()},t.prototype.R_=function(t,e,n){return ae.__awaiter(this,void 0,void 0,function(){var r,i;return ae.__generator(this,function(o){switch(o.label){case 0:return this.isPrimary?(F(\"SyncEngine\",\"Ignoring unexpected query state notification.\"),[3,8]):[3,1];case 1:return this.sl.has(t)?\"current\"===e||\"not-current\"===e?[3,2]:\"rejected\"===e?[3,5]:[3,7]:[3,8];case 2:return[4,this.Wu.ea()];case 3:return r=o.sent(),i=xn.Is(t,\"current\"===e),[4,this.El(r,i)];case 4:return o.sent(),[3,8];case 5:return[4,this.Wu.jh(t,!0)];case 6:return o.sent(),this.Tl(t,n),[3,8];case 7:G(\"Unexpected target state: \"+e),o.label=8;case 8:return[2]}})})},t.prototype.A_=function(t,e){return ae.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,a,h,c,f,l=this;return ae.__generator(this,function(p){switch(p.label){case 0:if(!this.isPrimary)return[3,10];n=0,r=t,p.label=1;case 1:return n<r.length?(i=r[n],[4,this.Wu.ta(i)]):[3,6];case 2:return o=p.sent(),[4,this.Wu.Uh(o)];case 3:return s=p.sent(),[4,this.ll(this.Cl(o),s.targetId,!1)];case 4:p.sent(),this.W_.listen(s),p.label=5;case 5:return n++,[3,1];case 6:u=function(t){return ae.__generator(this,function(e){switch(e.label){case 0:return a.sl.has(t)?[4,a.Wu.jh(t,!1).then(function(){l.W_.fc(t),l.Tl(t)}).catch(X)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},a=this,h=0,c=e,p.label=7;case 7:return h<c.length?(f=c[h],[5,u(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.Wu.Zh(!0),this.W_.enableNetwork()},t.prototype.disableNetwork=function(){return this.Wu.Zh(!1),this.W_.disableNetwork()},t.prototype.an=function(t){var e=this.rl.get(t);if(e&&e.Y_)return L().add(e.key);var n=L(),r=this.sl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.el.get(s);n=n.Ft(u.view.C_)}return n},t}(),$r=function(){this.kl=null,this.targetId=0,this.Nl=[]},ti=function(){function t(t){this.mc=t,this.Fl=new Kn(function(t){return t.canonicalId()}),this.onlineState=\"Unknown\",this.$l=new Set,this.mc.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.Fl.get(e);return r||(n=!0,r=new $r,this.Fl.set(e,r)),r.Nl.push(t),t.B_(this.onlineState),r.kl&&t.Ml(r.kl)&&this.Ll(),n?this.mc.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.fc=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return ae.__generator(this,function(){return e=t.query,n=!1,(r=this.Fl.get(e))&&0<=(i=r.Nl.indexOf(t))&&(r.Nl.splice(i,1),n=0===r.Nl.length),n?[2,(this.Fl.delete(e),this.mc.fc(e))]:[2]})})},t.prototype.du=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Fl.get(o);if(s){for(var u=0,a=s.Nl;u<a.length;u++)a[u].Ml(i)&&(e=!0);s.kl=i}}e&&this.Ll()},t.prototype.gl=function(t,e){var n=this.Fl.get(t);if(n)for(var r=0,i=n.Nl;r<i.length;r++)i[r].onError(e);this.Fl.delete(t)},t.prototype.wl=function(t){this.onlineState=t;var e=!1;this.Fl.forEach(function(n,r){for(var i=0,o=r.Nl;i<o.length;i++)o[i].B_(t)&&(e=!0)}),e&&this.Ll()},t.prototype.Ol=function(t){this.$l.add(t),t.next()},t.prototype.xl=function(t){this.$l.delete(t)},t.prototype.Ll=function(){this.$l.forEach(function(t){t.next()})},t}(),ei=function(){function t(t,e,n){this.query=t,this.Bl=e,this.Ul=!1,this.ql=null,this.onlineState=\"Unknown\",this.options=n||{}}return t.prototype.Ml=function(t){if(!this.options.includeMetadataChanges){for(var e,n=[],r=0,i=t.docChanges;r<i.length;r++)3!==(e=i[r]).type&&n.push(e);t=new kn(t.query,t.docs,t.cs,n,t._s,t.fromCache,t.ls,!0)}var o=!1;return this.Ul?this.Ql(t)&&(this.Bl.next(t),o=!0):this.Wl(t,this.onlineState)&&(this.jl(t),o=!0),this.ql=t,o},t.prototype.onError=function(t){this.Bl.error(t)},t.prototype.B_=function(t){this.onlineState=t;var e=!1;return this.ql&&!this.Ul&&this.Wl(this.ql,t)&&(this.jl(this.ql),e=!0),e},t.prototype.Wl=function(t,e){return!t.fromCache||!(this.options.Kl&&\"Offline\"!==e||t.docs.U()&&\"Offline\"!==e)},t.prototype.Ql=function(t){if(0<t.docChanges.length)return!0;var e=this.ql&&this.ql.hasPendingWrites!==t.hasPendingWrites;return(t.ls||e)&&!0===this.options.includeMetadataChanges},t.prototype.jl=function(t){t=kn.fs(t.query,t.docs,t._s,t.fromCache),this.Ul=!0,this.Bl.next(t)},t}(),ni=function(){function t(){}return t.prototype.ih=function(t){this.Gl=t},t.prototype.wr=function(t,e,n,r){var i=this;return e.Oe()||n.isEqual(Ie.MIN)?this.zl(t,e):this.Gl.Tr(t,r).next(function(o){var s=i.Hl(e,o);return(e.je()||e.Ke())&&i.M_(e.ge,s,r,n)?i.zl(t,e):(M()<=ce.LogLevel.DEBUG&&F(\"IndexFreeQueryEngine\",\"Re-using previous result from %s to execute query: %s\",n.toString(),e.toString()),i.Gl.wr(t,e,n).next(function(t){return s.forEach(function(e){t=t.it(e.key,e)}),t}))})},t.prototype.Hl=function(t,e){var n=new Le(function(e,n){return t.Be(e,n)});return e.forEach(function(e,r){r instanceof tn&&t.matches(r)&&(n=n.add(r))}),n},t.prototype.M_=function(t,e,n,r){if(n.size!==e.size)return!0;var i=\"F\"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.D(r))},t.prototype.zl=function(t,e){return M()<=ce.LogLevel.DEBUG&&F(\"IndexFreeQueryEngine\",\"Using full collection scan to execute query: %s\",e.toString()),this.Gl.wr(t,e,Ie.MIN)},t}(),ri=function(){function t(e){this.db=e,12.2===t.Jl(fe.getUA())&&q(\"Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\")}return t.Yl=function(e,n,r){return F(\"SimpleDb\",\"Opening database:\",e),new Jn(function(i,o){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onblocked=function(){o(new me(ve.FAILED_PRECONDITION,\"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed.\"))},s.onerror=function(t){var e=t.target.error;\"VersionError\"===e.name?o(new me(ve.FAILED_PRECONDITION,\"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.\")):o(e)},s.onupgradeneeded=function(t){F(\"SimpleDb\",'Database \"'+e+'\" requires upgrade from version:',t.oldVersion);var n=t.target.result;r.createOrUpgrade(n,s.transaction,t.oldVersion,pi).next(function(){F(\"SimpleDb\",\"Database upgrade to version \"+pi+\" complete\")})}}).Wi()},t.delete=function(t){return F(\"SimpleDb\",\"Removing database:\",t),xt(window.indexedDB.deleteDatabase(t)).Wi()},t.Uc=function(){if(\"undefined\"==typeof window||null==window.indexedDB)return!1;if(t.Xl())return!0;if(void 0===window.navigator)return!1;var e=fe.getUA(),n=t.Jl(e),r=t.Zl(e);return!(0<e.indexOf(\"MSIE \")||0<e.indexOf(\"Trident/\")||0<e.indexOf(\"Edge/\")||0<n&&10>n||0<r&&4.5>r)},t.Xl=function(){var t;return\"undefined\"!=typeof __PRIVATE_process&&\"YES\"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.td)},t.ed=function(t,e){return t.store(e)},t.Jl=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\\d_]+)/i);return+(e?e[1].split(\"_\").slice(0,2).join(\".\"):\"-1\")},t.Zl=function(t){var e=t.match(/Android ([\\d.]+)/i);return+(e?e[1].split(\".\").slice(0,2).join(\".\"):\"-1\")},t.prototype.sd=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return ae.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u;return ae.__generator(this,function(a){switch(a.label){case 0:r=\"readonly\"===t,i=0,o=function(){var t,o,u,a,h;return ae.__generator(this,function(c){switch(c.label){case 0:++i,t=oi.open(s.db,r?\"readonly\":\"readwrite\",e),c.label=1;case 1:return c.trys.push([1,3,,4]),o=n(t).catch(function(e){return t.abort(e),Jn.reject(e)}).Wi(),u={},o.catch(function(){}),[4,t.nd];case 2:return[2,(u.value=(c.sent(),o),u)];case 3:return a=c.sent(),h=\"FirebaseError\"!==a.name&&3>i,F(\"SimpleDb\",\"Transaction failed with error: %s. Retrying: %s.\",a.message,h),h?[3,4]:[2,{value:Promise.reject(a)}];case 4:return[2]}})},s=this,a.label=1;case 1:return[5,o()];case 2:if(\"object\"==typeof(u=a.sent()))return[2,u.value];a.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db.close()},t}(),ii=function(){function t(t){this.rd=t,this.od=!1,this.hd=null}return Object.defineProperty(t.prototype,\"Bi\",{get:function(){return this.od},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"ad\",{get:function(){return this.hd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"cursor\",{set:function(t){this.rd=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.od=!0},t.prototype.ud=function(t){this.hd=t},t.prototype.delete=function(){return xt(this.rd.delete())},t}(),oi=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this._d=new rr,this.transaction.oncomplete=function(){e._d.resolve()},this.transaction.onabort=function(){t.error?e._d.reject(t.error):e._d.resolve()},this.transaction.onerror=function(t){var n=Ot(t.target.error);e._d.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,\"nd\",{get:function(){return this._d.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this._d.reject(t),this.aborted||(F(\"SimpleDb\",\"Aborting transaction:\",t?t.message:\"Client-initiated abort\"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new si(e)},t}(),si=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0===e?(F(\"SimpleDb\",\"PUT\",this.store.name,\"<auto-key>\",t),n=this.store.put(t)):(F(\"SimpleDb\",\"PUT\",this.store.name,t,e),n=this.store.put(e,t)),xt(n)},t.prototype.add=function(t){return F(\"SimpleDb\",\"ADD\",this.store.name,t,t),xt(this.store.add(t))},t.prototype.get=function(t){var e=this;return xt(this.store.get(t)).next(function(n){return void 0===n&&(n=null),F(\"SimpleDb\",\"GET\",e.store.name,t,n),n})},t.prototype.delete=function(t){return F(\"SimpleDb\",\"DELETE\",this.store.name,t),xt(this.store.delete(t))},t.prototype.count=function(){return F(\"SimpleDb\",\"COUNT\",this.store.name),xt(this.store.count())},t.prototype.ld=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.dd(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.fd=function(t,e){F(\"SimpleDb\",\"DELETE ALL\",this.store.name);var n=this.options(t,e);n.Td=!1;var r=this.cursor(n);return this.dd(r,function(t,e,n){return n.delete()})},t.prototype.md=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.dd(r,e)},t.prototype.Ed=function(t){var e=this.cursor({});return new Jn(function(n,r){e.onerror=function(t){var e=Ot(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.dd=function(t,e){var n=[];return new Jn(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ii(i),s=e(i.primaryKey,i.value,o);if(s instanceof Jn){var u=s.catch(function(t){return o.done(),Jn.reject(t)});n.push(u)}o.Bi?r():null===o.ad?i.continue():i.continue(o.ad)}else r()}}).next(function(){return Jn.Ki(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&(\"string\"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e=\"next\";if(t.reverse&&(e=\"prev\"),t.index){var n=this.store.index(t.index);return t.Td?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),ui=!1,ai=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.ur=n,this.Jo=r,this.wd={}}return t.Id=function(e,n,r,i){return z(\"\"!==e.uid,\"UserID must not be an empty string.\"),new t(e.t()?e.uid:\"\",n,r,i)},t.prototype.Rd=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,ie],[this.userId,re]);return Ct(t).md({index:gi.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.mh=function(t,e,n){return this.Ad(t).next(function(e){return e.lastStreamToken=n.toBase64(),Vt(t).put(e)})},t.prototype.ph=function(t){return this.Ad(t).next(function(t){return Pe.fromBase64String(t.lastStreamToken)})},t.prototype.yh=function(t,e){return this.Ad(t).next(function(n){return n.lastStreamToken=e.toBase64(),Vt(t).put(n)})},t.prototype.dh=function(t,e,n,r){var i=this,o=Pt(t),s=Ct(t);return s.add({}).next(function(u){z(\"number\"==typeof u,\"Auto-generated key is not a number\");for(var a=new Wn(u,e,n,r),h=i.serializer.Pd(i.userId,a),c=[],f=new Le(function(t,e){return K(t.K(),e.K())}),l=0,p=r;l<p.length;l++){var d=p[l],y=wi.key(i.userId,d.key.path,u);f=f.add(d.key.path.L()),c.push(s.put(h)),c.push(o.put(y,wi.PLACEHOLDER))}return f.forEach(function(e){c.push(i.ur.Vd(t,e))}),t.rr(function(){i.wd[u]=a.keys()}),Jn.Ki(c).next(function(){return a})})},t.prototype.Ph=function(t,e){var n=this;return Ct(t).get(e).next(function(t){return t?(z(t.userId===n.userId,\"Unexpected user '\"+t.userId+\"' for mutation batch \"+e),n.serializer.gd(t)):null})},t.prototype.Th=function(t,e){var n=this;return this.wd[e]?Jn.resolve(this.wd[e]):this.Ph(t,e).next(function(t){if(t){var r=t.keys();return n.wd[e]=r,r}return null})},t.prototype.xh=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ct(t).md({index:gi.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(z(e.batchId>=r,\"Should have found mutation after \"+r),o=n.serializer.gd(e)),i.done()}).next(function(){return o})},t.prototype.gh=function(t){var e=IDBKeyRange.upperBound([this.userId,re]),n=-1;return Ct(t).md({index:gi.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.hh=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,re]);return Ct(t).ld(gi.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.gd(t)})})},t.prototype._r=function(t,e){var n=this,r=wi.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Pt(t).md({range:i},function(r,i,s){var u=r[0],a=r[1],h=r[2],c=kt(a);return u===n.userId&&e.path.isEqual(c)?Ct(t).get(h).next(function(t){if(!t)throw G(\"Dangling document-mutation reference found: \"+r+\" which points to \"+h);z(t.userId===n.userId,\"Unexpected user '\"+t.userId+\"' for mutation batch \"+h),o.push(n.serializer.gd(t))}):void s.done()}).next(function(){return o})},t.prototype.Er=function(t,e){var n=this,r=new Le(K),i=[];return e.forEach(function(e){var o=wi.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Pt(t).md({range:s},function(t,i,o){var s=t[0],u=t[1],a=t[2],h=kt(u);s===n.userId&&e.path.isEqual(h)?r=r.add(a):o.done()});i.push(u)}),Jn.Ki(i).next(function(){return n.pd(t,r)})},t.prototype.Vr=function(t,e){var n=this,r=e.path,i=r.length+1,o=wi.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Le(K);return Pt(t).md({range:s},function(t,e,o){var s=t[0],a=t[1],h=t[2],c=kt(a);s===n.userId&&r.q(c)?c.length===i&&(u=u.add(h)):o.done()}).next(function(){return n.pd(t,u)})},t.prototype.pd=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Ct(t).get(e).next(function(t){if(null===t)throw G(\"Dangling document-mutation reference found, which points to \"+e);z(t.userId===n.userId,\"Unexpected user '\"+t.userId+\"' for mutation batch \"+e),r.push(n.serializer.gd(t))}))}),Jn.Ki(i).next(function(){return r})},t.prototype.Vh=function(t,e){var n=this;return Lt(t.yd,this.userId,e).next(function(r){return t.rr(function(){n.Xh(e.batchId)}),Jn.forEach(r,function(e){return n.Jo.bd(t,e)})})},t.prototype.Xh=function(t){delete this.wd[t]},t.prototype.Rh=function(t){var e=this;return this.Rd(t).next(function(n){if(!n)return Jn.resolve();var r=IDBKeyRange.lowerBound(wi.prefixForUser(e.userId)),i=[];return Pt(t).md({range:r},function(t,n,r){if(t[0]===e.userId){var o=kt(t[1]);i.push(o)}else r.done()}).next(function(){z(0===i.length,\"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: \"+i.map(function(t){return t.K()}))})})},t.prototype.Mi=function(t,e){return Rt(t,this.userId,e)},t.prototype.Ad=function(t){var e=this;return Vt(t).get(this.userId).next(function(t){return t||new mi(e.userId,-1,\"\")})},t}(),hi=function(){function t(t,e){this.Jo=t,this.serializer=e}return t.prototype.Qh=function(t){var e=this;return this.vd(t).next(function(n){var r=new Kr(n.highestTargetId);return n.highestTargetId=r.next(),e.Sd(t,n).next(function(){return n.highestTargetId})})},t.prototype.bh=function(t){return this.vd(t).next(function(t){return Ie.v(new Te(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Dd=function(t){return jt(t.yd)},t.prototype.$h=function(t,e,n){var r=this;return this.vd(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.k()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Sd(t,i)})},t.prototype.Wh=function(t,e){var n=this;return this.Cd(t,e).next(function(){return n.vd(t).next(function(r){return r.targetCount+=1,n.kd(e,r),n.Sd(t,r)})})},t.prototype.Nh=function(t,e){return this.Cd(t,e)},t.prototype.Nd=function(t,e){var n=this;return this.Fd(t,e.targetId).next(function(){return Ut(t).delete(e.targetId)}).next(function(){return n.vd(t)}).next(function(e){return z(0<e.targetCount,\"Removing from an empty target cache\"),e.targetCount-=1,n.Sd(t,e)})},t.prototype.xo=function(t,e,n){var r=this,i=0,o=[];return Ut(t).md(function(s,u){var a=r.serializer.$d(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Nd(t,a)))}).next(function(){return Jn.Ki(o)}).next(function(){return i})},t.prototype.Xs=function(t,e){var n=this;return Ut(t).md(function(t,r){var i=n.serializer.$d(r);e(i)})},t.prototype.vd=function(t){return Mt(t.yd)},t.prototype.Sd=function(t,e){return(n=t,Ci.ed(n,Ai.store)).put(Ai.key,e);var n},t.prototype.Cd=function(t,e){return Ut(t).put(this.serializer.Md(e))},t.prototype.kd=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Ld=function(t){return this.vd(t).next(function(t){return t.targetCount})},t.prototype.qh=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,ie],[r,re]),o=null;return Ut(t).md({range:i,index:Ii.queryTargetsIndexName},function(t,r,i){var s=n.serializer.$d(r);e.isEqual(s.target)&&(o=s,i.done())}).next(function(){return o})},t.prototype.Dh=function(t,e,n){var r=this,i=[],o=Ft(t);return e.forEach(function(e){var s=At(e.path);i.push(o.put(new Ni(n,s))),i.push(r.Jo.vi(t,e))}),Jn.Ki(i)},t.prototype.Sh=function(t,e,n){var r=this,i=Ft(t);return Jn.forEach(e,function(e){var o=At(e.path);return Jn.Ki([i.delete([n,o]),r.Jo.Di(t,e)])})},t.prototype.Fd=function(t,e){var n=Ft(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Gh=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ft(t),i=L();return r.md({range:n,Td:!0},function(t){var e=kt(t[1]),n=new ke(e);i=i.add(n)}).next(function(){return i})},t.prototype.Mi=function(t,e){var n=At(e.path),r=IDBKeyRange.bound([n],[H(n)],!1,!0),i=0;return Ft(t).md({index:Ni.documentTargetsIndex,Td:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},t.prototype.un=function(t,e){var n=this;return Ut(t).get(e).next(function(t){return t?n.serializer.$d(t):null})},t}(),ci=function(){function t(t,e){this.serializer=t,this.ur=e}return t.prototype.Yi=function(t,e,n){return Bt(t).put(Gt(e),n)},t.prototype.Zi=function(t,e){var n=Bt(t),r=Gt(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Od(t,r)})},t.prototype.tr=function(t,e){var n=this;return Bt(t).get(Gt(e)).next(function(t){return n.xd(t)})},t.prototype.Bd=function(t,e){var n=this;return Bt(t).get(Gt(e)).next(function(t){var e=n.xd(t);return e?{Ud:e,size:zt(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=x();return this.qd(t,e,function(t,e){var i=n.xd(e);r=r.it(t,i)}).next(function(){return r})},t.prototype.Qd=function(t,e){var n=this,r=x(),i=new xe(ke.F);return this.qd(t,e,function(t,e){var o=n.xd(e);o?(r=r.it(t,o),i=i.it(t,zt(e))):(r=r.it(t,null),i=i.it(t,0))}).next(function(){return{Wd:r,jd:i}})},t.prototype.qd=function(t,e,n){if(e.U())return Jn.resolve();var r=IDBKeyRange.bound(e.first().path.j(),e.last().path.j()),i=e._t(),o=i.wt();return Bt(t).md({range:r},function(t,e,r){for(var s=ke.nt(t);o&&0>ke.F(o,s);)n(o,null),o=i.wt();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.wt():null),o?r.ud(o.path.j()):r.done()}).next(function(){for(;o;)n(o,null),o=i.It()?i.wt():null})},t.prototype.wr=function(t,e,n){var r=this,i=O(),o=e.path.length+1,s={};if(n.isEqual(Ie.MIN)){var u=e.path.j();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.j(),h=this.serializer.Kd(n);s.range=IDBKeyRange.lowerBound([a,h],!0),s.index=Ei.collectionReadTimeIndex}return Bt(t).md(s,function(t,n,s){if(t.length===o){var u=r.serializer.Gd(n);e.path.q(u.key.path)?u instanceof tn&&e.matches(u)&&(i=i.it(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.ea=function(t,e){var n=this,r=k(),i=this.serializer.Kd(e),o=Bt(t),s=IDBKeyRange.lowerBound(i,!0);return o.md({index:Ei.readTimeIndex,range:s},function(t,e){var o=n.serializer.Gd(e);r=r.it(o.key,o),i=e.readTime}).next(function(){return{sa:r,readTime:n.serializer.zd(i)}})},t.prototype.na=function(t){var e=this,n=Bt(t),r=Ie.MIN;return n.md({index:Ei.readTimeIndex,reverse:!0},function(t,n,i){n.readTime&&(r=e.serializer.zd(n.readTime)),i.done()}).next(function(){return r})},t.prototype.Eh=function(e){return new t.Hd(this,!!e&&e.wh)},t.prototype.Jd=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return qt(t).get(Ti.key).next(function(t){return z(!!t,\"Missing document cache metadata\"),t})},t.prototype.Od=function(t,e){return qt(t).put(Ti.key,e)},t.prototype.xd=function(t){if(t){var e=this.serializer.Gd(t);return e instanceof en&&e.version.isEqual(Ie.S())?null:e}return null},t}();ci.Hd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Yd=e,r.wh=n,r.Xd=new Kn(function(t){return t.toString()}),r}return ae.__extends(e,t),e.prototype.nr=function(t){var e=this,n=[],r=0,i=new Le(function(t,e){return K(t.K(),e.K())});return this.zi.forEach(function(o,s){var u=e.Xd.get(o);if(s){var a=e.Yd.serializer.Zd(s,e.readTime);i=i.add(o.path.L());var h=zt(a);r+=h-u,n.push(e.Yd.Yi(t,o,a))}else if(r-=u,e.wh){var c=e.Yd.serializer.Zd(new en(o,Ie.S()),e.readTime);n.push(e.Yd.Yi(t,o,c))}else n.push(e.Yd.Zi(t,o))}),i.forEach(function(r){n.push(e.Yd.ur.Vd(t,r))}),n.push(this.Yd.updateMetadata(t,r)),Jn.Ki(n)},e.prototype.er=function(t,e){var n=this;return this.Yd.Bd(t,e).next(function(t){return null===t?(n.Xd.set(e,0),null):(n.Xd.set(e,t.size),t.Ud)})},e.prototype.sr=function(t,e){var n=this;return this.Yd.Qd(t,e).next(function(t){var e=t.Wd;return t.jd.forEach(function(t,e){n.Xd.set(t,e)}),e})},e}(Qn);var fi=function(){function t(){this.tf=new li}return t.prototype.Vd=function(t,e){return this.tf.add(e),Jn.resolve()},t.prototype.Pr=function(t,e){return Jn.resolve(this.tf.getEntries(e))},t}(),li=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.B(),n=t.L(),r=this.index[e]||new Le(Ae.F),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.B(),n=t.L(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Le(Ae.F)).j()},t}(),pi=10,di=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;z(n<r&&0<=n&&r<=pi,\"Unexpected schema upgrade from v\"+n+\" to v\"+r+\".\");var o=new oi(e);1>n&&1<=r&&(t.createObjectStore(vi.store),function(t){t.createObjectStore(mi.store,{keyPath:mi.keyPath}),t.createObjectStore(gi.store,{keyPath:gi.keyPath,autoIncrement:!0}).createIndex(gi.userMutationsIndex,gi.userMutationsKeyPath,{unique:!0}),t.createObjectStore(wi.store)}(t),Kt(t),t.createObjectStore(Ei.store));var s=Jn.resolve();return 3>n&&3<=r&&(0!==n&&(function(t){t.deleteObjectStore(Ni.store),t.deleteObjectStore(Ii.store),t.deleteObjectStore(Ai.store)}(t),Kt(t)),s=s.next(function(){return t=o.store(Ai.store),e=new Ai(0,0,Ie.MIN.k(),0),t.put(Ai.key,e);var t,e})),4>n&&4<=r&&(0!==n&&(s=s.next(function(){return e=t,(n=o).store(gi.store).ld().next(function(t){e.deleteObjectStore(gi.store),e.createObjectStore(gi.store,{keyPath:gi.keyPath,autoIncrement:!0}).createIndex(gi.userMutationsIndex,gi.userMutationsKeyPath,{unique:!0});var r=n.store(gi.store),i=t.map(function(t){return r.put(t)});return Jn.Ki(i)});var e,n})),s=s.next(function(){t.createObjectStore(Di.store,{keyPath:Di.keyPath})})),5>n&&5<=r&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),6>n&&6<=r&&(s=s.next(function(){return t.createObjectStore(Ti.store),i.addDocumentGlobal(o)})),7>n&&7<=r&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),8>n&&8<=r&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),9>n&&9<=r&&(s=s.next(function(){var n;(n=t).objectStoreNames.contains(\"remoteDocumentChanges\")&&n.deleteObjectStore(\"remoteDocumentChanges\"),function(t){var e=t.objectStore(Ei.store);e.createIndex(Ei.readTimeIndex,Ei.readTimeIndexPath,{unique:!1}),e.createIndex(Ei.collectionReadTimeIndex,Ei.collectionReadTimeIndexPath,{unique:!1})}(e)})),10>n&&10<=r&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ei.store).md(function(t,n){e+=zt(n)}).next(function(){var n=new Ti(e);return t.store(Ti.store).put(Ti.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(mi.store),r=t.store(gi.store);return n.ld().next(function(n){return Jn.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ld(gi.userMutationsIndex,i).next(function(r){return Jn.forEach(r,function(r){z(r.userId===n.userId,\"Cannot process batch \"+r.batchId+\" from unexpected user\");var i=e.serializer.gd(r);return Lt(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Ni.store),n=t.store(Ei.store);return jt(t).next(function(t){var r=[];return n.md(function(n){var i=new Ae(n),o=[0,At(i)];r.push(e.get(o).next(function(n){return n?Jn.resolve():function(n){return e.put(new Ni(0,At(n),t))}(i)}))}).next(function(){return Jn.Ki(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Si.store,{keyPath:Si.keyPath});var n=e.store(Si.store),r=new li,i=function(t){if(r.add(t)){var e=t.B(),i=t.L();return n.put({collectionId:e,parent:At(i)})}};return e.store(Ei.store).md({Td:!0},function(t){var e=new Ae(t);return i(e.L())}).next(function(){return e.store(wi.store).md({Td:!0},function(t){t[0];var e=t[1],n=(t[2],kt(e));return i(n.L())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Ii.store);return n.md(function(t,r){var i=e.serializer.$d(r),o=e.serializer.Md(i);return n.put(o)})},t}(),yi=function(t,e){this.seconds=t,this.nanoseconds=e},vi=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};vi.store=\"owner\",vi.key=\"owner\";var mi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};mi.store=\"mutationQueues\",mi.keyPath=\"userId\";var gi=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};gi.store=\"mutations\",gi.keyPath=\"batchId\",gi.userMutationsIndex=\"userMutationsIndex\",gi.userMutationsKeyPath=[\"userId\",\"batchId\"];var wi=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,At(e)]},t.key=function(t,e,n){return[t,At(e),n]},t}();wi.store=\"documentMutations\",wi.PLACEHOLDER=new wi;var bi=function(t,e){this.path=t,this.readTime=e},_i=function(t,e){this.path=t,this.version=e},Ei=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ei.store=\"remoteDocuments\",Ei.readTimeIndex=\"readTimeIndex\",Ei.readTimeIndexPath=\"readTime\",Ei.collectionReadTimeIndex=\"collectionReadTimeIndex\",Ei.collectionReadTimeIndexPath=[\"parentPath\",\"readTime\"];var Ti=function(t){this.byteSize=t};Ti.store=\"remoteDocumentGlobal\",Ti.key=\"remoteDocumentGlobalKey\";var Ii=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ii.store=\"targets\",Ii.keyPath=\"targetId\",Ii.queryTargetsIndexName=\"queryTargetsIndex\",Ii.queryTargetsKeyPath=[\"canonicalId\",\"targetId\"];var Ni=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ni.store=\"targetDocuments\",Ni.keyPath=[\"targetId\",\"path\"],Ni.documentTargetsIndex=\"documentTargetsIndex\",Ni.documentTargetsKeyPath=[\"path\",\"targetId\"];var Ai=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ai.key=\"targetGlobalKey\",Ai.store=\"targetGlobal\";var Si=function(t,e){this.collectionId=t,this.parent=e};Si.store=\"collectionParents\",Si.keyPath=[\"collectionId\",\"parent\"];var Di=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Di.store=\"clientMetadata\",Di.keyPath=\"clientId\";var ki=ae.__spreadArrays(ae.__spreadArrays(ae.__spreadArrays([mi.store,gi.store,wi.store,Ei.store,Ii.store,vi.store,Ai.store,Ni.store],[Di.store]),[Ti.store]),[Si.store]),xi=function(){function t(){this.ef=new li}return t.prototype.Vd=function(t,e){var n=this;if(!this.ef.has(e)){var r=e.B(),i=e.L();t.rr(function(){n.ef.add(e)});var o={collectionId:r,parent:At(i)};return Wt(t).put(o)}return Jn.resolve()},t.prototype.Pr=function(t,e){var n=[],r=IDBKeyRange.bound([e,\"\"],[H(e),\"\"],!1,!0);return Wt(t).ld(r).next(function(t){for(var r,i=0,o=t;i<o.length&&(r=o[i]).collectionId===e;i++)n.push(kt(r.parent));return n})},t}(),Oi=function(){function t(t){this.sf=t}return t.prototype.Gd=function(t){if(t.document)return this.sf.vn(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=ke.nt(t.noDocument.path),n=this.nf(t.noDocument.readTime);return new en(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=ke.nt(t.unknownDocument.path),i=this.nf(t.unknownDocument.version);return new nn(r,i)}return G(\"Unexpected DbRemoteDocument\")},t.prototype.Zd=function(t,e){var n=this.Kd(e),r=t.key.path.L().j();if(t instanceof tn){var i=this.sf.bn(t),o=t.hasCommittedMutations;return new Ei(null,null,i,o,n,r)}if(t instanceof en){var s=t.key.path.j(),u=this.if(t.version),a=t.hasCommittedMutations;return new Ei(null,new bi(s,u),null,a,n,r)}if(t instanceof nn){var h=t.key.path.j(),c=this.if(t.version);return new Ei(new _i(h,c),null,null,!0,n,r)}return G(\"Unexpected MaybeDocument\")},t.prototype.Kd=function(t){var e=t.k();return[e.seconds,e.nanoseconds]},t.prototype.zd=function(t){var e=new Te(t[0],t[1]);return Ie.v(e)},t.prototype.if=function(t){var e=t.k();return new yi(e.seconds,e.nanoseconds)},t.prototype.nf=function(t){var e=new Te(t.seconds,t.nanoseconds);return Ie.v(e)},t.prototype.Pd=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.sf.$n(t)}),i=e.mutations.map(function(t){return n.sf.$n(t)});return new gi(t,e.batchId,e.Ri.toMillis(),r,i)},t.prototype.gd=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.sf.xn(t)}),r=t.mutations.map(function(t){return e.sf.xn(t)}),i=Te.fromMillis(t.localWriteTimeMs);return new Wn(t.batchId,i,n,r)},t.prototype.$d=function(t){var e,n=this.nf(t.readTime),r=void 0===t.lastLimboFreeSnapshotVersion?Ie.MIN:this.nf(t.lastLimboFreeSnapshotVersion);return e=void 0===t.query.documents?this.sf.Yn(t.query):this.sf.Kn(t.query),new bn(e,t.targetId,0,t.lastListenSequenceNumber,n,r,Pe.fromBase64String(t.resumeToken))},t.prototype.Md=function(t){var e,n=this.if(t.ts),r=this.if(t.lastLimboFreeSnapshotVersion);e=t.target.Pe()?this.sf.jn(t.target):this.sf.Gn(t.target);var i=t.resumeToken.toBase64();return new Ii(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}(),Ri=\"Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.\",Li=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).yd=e,r.Ch=n,r}return ae.__extends(e,t),e}($n),Ci=function(){function t(e,n,r,i,o,s,u,a){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.$a=s,this.rf=a,this.hf=!1,this.isPrimary=!1,this.networkEnabled=!0,this.af=null,this.inForeground=!1,this.uf=null,this.cf=null,this._f=ie,this.lf=function(){return Promise.resolve()},this.Jo=new Pi(this,o),this.df=n+t.ff,this.serializer=new Oi(u),this.document=i.document,this.th=new hi(this.Jo,this.serializer),this.ur=new xi,this.hr=new ci(this.serializer,this.ur),!i.window||!i.window.localStorage)throw new me(ve.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");this.window=i.window,this.Tf=this.window.localStorage}return t.ed=function(t,e){if(t instanceof Li)return ri.ed(t.yd,e);throw G(\"IndexedDbPersistence must use instances of IndexedDbTransaction\")},t.mf=function(e){if(!t.Uc())throw new me(ve.UNIMPLEMENTED,\"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.\");return new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.Ef,e.$a,e.serializer,e.rf)},t.prototype.start=function(){var t=this;return ri.Yl(this.df,pi,new di(this.serializer)).then(function(e){return t.wf=e,t.If()}).then(function(){return t.Rf(),t.Af(),t.Pf(),t.wf.runTransaction(\"readonly\",[Ai.store],function(t){return jt(t)})}).then(function(e){t.Vf=new nr(e,t.rf)}).then(function(){t.hf=!0}).catch(function(e){return t.wf&&t.wf.close(),Promise.reject(e)})},t.prototype.gf=function(t){var e=this;return this.lf=function(n){return ae.__awaiter(e,void 0,void 0,function(){return ae.__generator(this,function(){return this.ko?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.pf=function(t){var e=this;this.wf.sd(function(n){return ae.__awaiter(e,void 0,void 0,function(){return ae.__generator(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Zh=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.$a.qr(function(){return ae.__awaiter(e,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.ko?[4,this.If()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.If=function(){var t=this;return this.wf.runTransaction(\"readwrite\",ki,function(e){return Yt(e).put(new Di(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.yf(e).next(function(e){e||(t.isPrimary=!1,t.$a.qr(function(){return t.lf(!1)}))})}).next(function(){return t.bf(e)}).next(function(n){return t.isPrimary&&!n?t.vf(e).next(function(){return!1}):!!n&&t.Sf(e).next(function(){return!0})})}).catch(function(e){if(!t.allowTabSynchronization)throw e;return F(\"IndexedDbPersistence\",\"Releasing owner lease after error during lease refresh\",e),!1}).then(function(e){t.isPrimary!==e&&t.$a.qr(function(){return t.lf(e)}),t.isPrimary=e})},t.prototype.yf=function(t){var e=this;return Ht(t).get(vi.key).next(function(t){return Jn.resolve(e.Df(t))})},t.prototype.Cf=function(t){return Yt(t).delete(this.clientId)},t.prototype.kf=function(){return ae.__awaiter(this,void 0,void 0,function(){var e=this;return ae.__generator(this,function(n){switch(n.label){case 0:return!this.isPrimary||this.Nf(this._f,18e5)?[3,2]:(this._f=Date.now(),[4,this.runTransaction(\"maybeGarbageCollectMultiClientState\",\"readwrite-primary\",function(n){var r=t.ed(n,Di.store);return r.ld().next(function(t){var n=e.Ff(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Jn.forEach(i,function(t){return r.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:n.sent().forEach(function(t){e.window.localStorage.removeItem(e.$f(t.clientId))}),n.label=2;case 2:return[2]}})})},t.prototype.Pf=function(){var t=this;this.cf=this.$a.eo(\"client_metadata_refresh\",4e3,function(){return t.If().then(function(){return t.kf()}).then(function(){return t.Pf()})})},t.prototype.Df=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bf=function(t){var e=this;return Ht(t).get(vi.key).next(function(n){if(null!==n&&e.Nf(n.leaseTimestampMs,5e3)&&!e.Mf(n.ownerId)){if(e.Df(n)&&e.networkEnabled)return!0;if(!e.Df(n)){if(!n.allowTabSynchronization)throw new me(ve.FAILED_PRECONDITION,Ri);return!1}}return e.networkEnabled&&e.inForeground||Yt(t).ld().next(function(t){return void 0===e.Ff(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&F(\"IndexedDbPersistence\",\"Client \"+(t?\"is\":\"is not\")+\" eligible for a primary lease.\"),t})},t.prototype.lc=function(){return ae.__awaiter(this,void 0,void 0,function(){var t=this;return ae.__generator(this,function(e){switch(e.label){case 0:return this.hf=!1,this.Lf(),this.cf&&(this.cf.cancel(),this.cf=null),this.Of(),this.xf(),[4,this.wf.runTransaction(\"readwrite\",[vi.store,Di.store],function(e){return t.vf(e).next(function(){return t.Cf(e)})})];case 1:return e.sent(),this.wf.close(),this.Bf(),[2]}})})},t.prototype.Ff=function(t,e){var n=this;return t.filter(function(t){return n.Nf(t.updateTimeMs,e)&&!n.Mf(t.clientId)})},t.prototype.Jh=function(){var t=this;return this.wf.runTransaction(\"readonly\",[Di.store],function(e){return Yt(e).ld().next(function(e){return t.Ff(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return ae.__awaiter(this,void 0,void 0,function(){var n;return ae.__generator(this,function(r){switch(r.label){case 0:return t.Uc()?(n=e+t.ff,[4,ri.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,\"ko\",{get:function(){return this.hf},enumerable:!0,configurable:!0}),t.prototype.Yo=function(t){return ai.Id(t,this.serializer,this.ur,this.Jo)},t.prototype.eh=function(){return this.th},t.prototype.Zo=function(){return this.hr},t.prototype.nh=function(){return this.ur},t.prototype.runTransaction=function(t,e,n){var r=this;F(\"IndexedDbPersistence\",\"Starting transaction:\",t);var i,o=\"readonly\"===e?\"readonly\":\"readwrite\";return this.wf.runTransaction(o,ki,function(o){return i=new Li(o,r.Vf.next()),\"readwrite-primary\"===e?r.yf(o).next(function(t){return!!t||r.bf(o)}).next(function(e){if(!e)throw q(\"Failed to obtain primary lease for action '\"+t+\"'.\"),r.isPrimary=!1,r.$a.qr(function(){return r.lf(!1)}),new me(ve.FAILED_PRECONDITION,Zn);return n(i)}).next(function(t){return r.Sf(o).next(function(){return t})}):r.Uf(o).next(function(){return n(i)})}).then(function(t){return i.or(),t})},t.prototype.Uf=function(t){var e=this;return Ht(t).get(vi.key).next(function(t){if(null!==t&&e.Nf(t.leaseTimestampMs,5e3)&&!e.Mf(t.ownerId)&&!e.Df(t)&&!t.allowTabSynchronization)throw new me(ve.FAILED_PRECONDITION,Ri)})},t.prototype.Sf=function(t){var e=new vi(this.clientId,this.allowTabSynchronization,Date.now());return Ht(t).put(vi.key,e)},t.Uc=function(){return ri.Uc()},t.qf=function(t){var e=t.cn.projectId;return t.cn.Ei||(e+=\".\"+t.cn.database),\"firestore/\"+t.persistenceKey+\"/\"+e+\"/\"},t.prototype.vf=function(t){var e=this,n=Ht(t);return n.get(vi.key).next(function(t){return e.Df(t)?(F(\"IndexedDbPersistence\",\"Releasing primary lease.\"),n.delete(vi.key)):Jn.resolve()})},t.prototype.Nf=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(q(\"Detected an update time that is in the future: \"+t+\" > \"+n),1))},t.prototype.Rf=function(){var t=this;null!==this.document&&\"function\"==typeof this.document.addEventListener&&(this.uf=function(){t.$a.qr(function(){return t.inForeground=\"visible\"===t.document.visibilityState,t.If()})},this.document.addEventListener(\"visibilitychange\",this.uf),this.inForeground=\"visible\"===this.document.visibilityState)},t.prototype.Of=function(){this.uf&&(this.document.removeEventListener(\"visibilitychange\",this.uf),this.uf=null)},t.prototype.Af=function(){var t=this;\"function\"==typeof this.window.addEventListener&&(this.af=function(){t.Lf(),t.$a.qr(function(){return t.lc()})},this.window.addEventListener(\"unload\",this.af))},t.prototype.xf=function(){this.af&&(this.window.removeEventListener(\"unload\",this.af),this.af=null)},t.prototype.Mf=function(t){try{var e=null!==this.Tf.getItem(this.$f(t));return F(\"IndexedDbPersistence\",\"Client '\"+t+\"' \"+(e?\"is\":\"is not\")+\" zombied in LocalStorage\"),e}catch(t){return q(\"IndexedDbPersistence\",\"Failed to get zombied client id.\",t),!1}},t.prototype.Lf=function(){try{this.Tf.setItem(this.$f(this.clientId),Date.now()+\"\")}catch(t){q(\"Failed to set zombie client id.\",t)}},t.prototype.Bf=function(){try{this.Tf.removeItem(this.$f(this.clientId))}catch(t){}},t.prototype.$f=function(t){return\"firestore_zombie_\"+this.persistenceKey+\"_\"+t},t}();Ci.ff=\"main\";var Pi=function(){function t(t,e){this.db=t,this.Qf=null,this.bo=new cr(this,e)}return t.prototype.Mo=function(t){var e=this.Wf(t);return this.db.eh().Ld(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Wf=function(t){var e=0;return this.Oo(t,function(){e++}).next(function(){return e})},t.prototype.Xs=function(t,e){return this.db.eh().Xs(t,e)},t.prototype.Oo=function(t,e){return this.jf(t,function(t,n){return e(n)})},t.prototype.Ho=function(t){this.Qf=t},t.prototype.vi=function(t,e){return Xt(t,e)},t.prototype.Di=function(t,e){return Xt(t,e)},t.prototype.xo=function(t,e,n){return this.db.eh().xo(t,e,n)},t.prototype.bd=function(t,e){return Xt(t,e)},t.prototype.Kf=function(t,e){return this.Qf.Mi(e)?Jn.resolve(!0):function(t,e){var n=!1;return Vt(t).Ed(function(r){return Rt(t,r,e).next(function(t){return t&&(n=!0),Jn.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Bo=function(t,e){var n=this,r=this.db.Zo().Eh(),i=[],o=0;return this.jf(t,function(s,u){if(u<=e){var a=n.Kf(t,s).next(function(e){if(!e)return o++,r.tr(t,s).next(function(){return r.Zi(s),Ft(t).delete([0,At(s.path)])})});i.push(a)}}).next(function(){return Jn.Ki(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.es(t.Ch);return this.db.eh().Nh(t,n)},t.prototype.Fh=function(t,e){return Xt(t,e)},t.prototype.jf=function(t,e){var n,r=Ft(t),i=nr.kr;return r.md({index:Ni.documentTargetsIndex},function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==nr.kr&&e(new ke(kt(n)),i),i=u,n=s):i=nr.kr}).next(function(){i!==nr.kr&&e(new ke(kt(n)),i)})},t.prototype.qo=function(t){return this.db.Zo().Jd(t)},t}(),Vi=function(){function t(t,e){this.ur=t,this.Jo=e,this.ar=[],this.Gf=1,this.lastStreamToken=Pe.xt,this.zf=new Le(Xn.Ee)}return t.prototype.Rd=function(){return Jn.resolve(0===this.ar.length)},t.prototype.mh=function(t,e,n){var r=e.batchId,i=this.Hf(r,\"acknowledged\");return z(0===i,\"Can only acknowledge the first batch in the mutation queue\"),this.ar[i],this.lastStreamToken=n,Jn.resolve()},t.prototype.ph=function(){return Jn.resolve(this.lastStreamToken)},t.prototype.yh=function(t,e){return this.lastStreamToken=e,Jn.resolve()},t.prototype.dh=function(t,e,n,r){var i=this.Gf;this.Gf++,0<this.ar.length&&this.ar[this.ar.length-1];var o=new Wn(i,e,n,r);this.ar.push(o);for(var s,u=0,a=r;u<a.length;u++)s=a[u],this.zf=this.zf.add(new Xn(s.key,i)),this.ur.Vd(t,s.key.path.L());return Jn.resolve(o)},t.prototype.Ph=function(t,e){return Jn.resolve(this.Jf(e))},t.prototype.Th=function(t,e){var n=this.Jf(e);return Jn.resolve(n.keys())},t.prototype.xh=function(t,e){var n=this.Yf(e+1),r=0>n?0:n;return Jn.resolve(this.ar.length>r?this.ar[r]:null)},t.prototype.gh=function(){return Jn.resolve(0===this.ar.length?-1:this.Gf-1)},t.prototype.hh=function(){return Jn.resolve(this.ar.slice())},t.prototype._r=function(t,e){var n=this,r=new Xn(e,0),i=new Xn(e,re),o=[];return this.zf.Ct([r,i],function(t){var e=n.Jf(t.Li);o.push(e)}),Jn.resolve(o)},t.prototype.Er=function(t,e){var n=this,r=new Le(K);return e.forEach(function(t){var e=new Xn(t,0),i=new Xn(t,re);n.zf.Ct([e,i],function(t){r=r.add(t.Li)})}),Jn.resolve(this.Xf(r))},t.prototype.Vr=function(t,e){var n=e.path,r=n.length+1,i=n;ke.st(i)||(i=i.child(\"\"));var o=new Xn(new ke(i),0),s=new Le(K);return this.zf.kt(function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.Li)),!0)},o),Jn.resolve(this.Xf(s))},t.prototype.Xf=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Jf(t);null!==r&&n.push(r)}),n},t.prototype.Vh=function(t,e){var n=this;z(0===this.Hf(e.batchId,\"removed\"),\"Can only remove the first entry of the mutation queue\"),this.ar.shift();var r=this.zf;return Jn.forEach(e.mutations,function(i){var o=new Xn(i.key,e.batchId);return r=r.delete(o),n.Jo.bd(t,i.key)}).next(function(){n.zf=r})},t.prototype.Xh=function(){},t.prototype.Mi=function(t,e){var n=new Xn(e,0),r=this.zf.Nt(n);return Jn.resolve(e.isEqual(r&&r.key))},t.prototype.Rh=function(){return this.ar.length,Jn.resolve()},t.prototype.Hf=function(t){return this.Yf(t)},t.prototype.Yf=function(t){return 0===this.ar.length?0:t-this.ar[0].batchId},t.prototype.Jf=function(t){var e=this.Yf(t);return 0>e||e>=this.ar.length?null:this.ar[e]},t}(),Ui=function(){function t(t,e){this.ur=t,this.Zf=e,this.docs=new xe(ke.F),this.size=0}return t.prototype.Yi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Zf(e);return this.docs=this.docs.it(r,{Ud:e,size:s,readTime:n}),this.size+=s-o,this.ur.Vd(t,r.path.L())},t.prototype.Zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.tr=function(t,e){var n=this.docs.get(e);return Jn.resolve(n?n.Ud:null)},t.prototype.getEntries=function(t,e){var n=this,r=x();return e.forEach(function(t){var e=n.docs.get(t);r=r.it(t,e?e.Ud:null)}),Jn.resolve(r)},t.prototype.wr=function(t,e,n){for(var r=O(),i=new ke(e.path.child(\"\")),o=this.docs.lt(i);o.It();){var s=o.wt(),u=s.key,a=s.value,h=a.Ud,c=a.readTime;if(!e.path.q(u.path))break;0>=c.D(n)||h instanceof tn&&e.matches(h)&&(r=r.it(h.key,h))}return Jn.resolve(r)},t.prototype.tT=function(t,e){return Jn.forEach(this.docs,function(t){return e(t)})},t.prototype.ea=function(){throw new Error(\"getNewDocumentChanges() is not supported with MemoryPersistence\")},t.prototype.na=function(){return Jn.resolve(Ie.MIN)},t.prototype.Eh=function(){return new t.Hd(this)},t.prototype.Jd=function(){return Jn.resolve(this.size)},t}();\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */Ui.Hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).Yd=e,n}return ae.__extends(e,t),e.prototype.nr=function(t){var e=this,n=[];return this.zi.forEach(function(r,i){i?n.push(e.Yd.Yi(t,i,e.readTime)):e.Yd.Zi(r)}),Jn.Ki(n)},e.prototype.er=function(t,e){return this.Yd.tr(t,e)},e.prototype.sr=function(t,e){return this.Yd.getEntries(t,e)},e}(Qn);\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar Mi=function(){function t(t){this.persistence=t,this.eT=new Kn(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Ie.MIN,this.highestTargetId=0,this.sT=0,this.nT=new Yn,this.targetCount=0,this.iT=Kr.p_()}return t.prototype.Xs=function(t,e){return this.eT.forEach(function(t,n){return e(n)}),Jn.resolve()},t.prototype.bh=function(){return Jn.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Dd=function(){return Jn.resolve(this.sT)},t.prototype.Qh=function(){return this.highestTargetId=this.iT.next(),Jn.resolve(this.highestTargetId)},t.prototype.$h=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.sT&&(this.sT=e),Jn.resolve()},t.prototype.Cd=function(t){this.eT.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.iT=new Kr(e),this.highestTargetId=e),t.sequenceNumber>this.sT&&(this.sT=t.sequenceNumber)},t.prototype.Wh=function(t,e){return this.Cd(e),this.targetCount+=1,Jn.resolve()},t.prototype.Nh=function(t,e){return this.Cd(e),Jn.resolve()},t.prototype.Nd=function(t,e){return this.eT.delete(e.target),this.nT.Ni(e.targetId),this.targetCount-=1,Jn.resolve()},t.prototype.xo=function(t,e,n){var r=this,i=0,o=[];return this.eT.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.eT.delete(s),o.push(r.Fd(t,u.targetId)),i++)}),Jn.Ki(o).next(function(){return i})},t.prototype.Ld=function(){return Jn.resolve(this.targetCount)},t.prototype.qh=function(t,e){var n=this.eT.get(e)||null;return Jn.resolve(n)},t.prototype.un=function(){return G(\"Not yet implemented.\")},t.prototype.Dh=function(t,e,n){this.nT.Si(e,n);var r=this.persistence.Jo,i=[];return r&&e.forEach(function(e){i.push(r.vi(t,e))}),Jn.Ki(i)},t.prototype.Sh=function(t,e,n){this.nT.ki(e,n);var r=this.persistence.Jo,i=[];return r&&e.forEach(function(e){i.push(r.Di(t,e))}),Jn.Ki(i)},t.prototype.Fd=function(t,e){return this.nT.Ni(e),Jn.resolve()},t.prototype.Gh=function(t,e){var n=this.nT.$i(e);return Jn.resolve(n)},t.prototype.Mi=function(t,e){return Jn.resolve(this.nT.Mi(e))},t}(),ji=function(){function t(t,e){var n=this;this.clientId=t,this.rT={},this.Vf=new nr(0),this.hf=!1,this.hf=!0,this.Jo=e(this),this.th=new Mi(this),this.ur=new fi,this.hr=new Ui(this.ur,function(t){return n.Jo.oT(t)})}return t.prototype.start=function(){return Promise.resolve()},t.prototype.lc=function(){return this.hf=!1,Promise.resolve()},Object.defineProperty(t.prototype,\"ko\",{get:function(){return this.hf},enumerable:!0,configurable:!0}),t.prototype.Jh=function(){return ae.__awaiter(this,void 0,void 0,function(){return ae.__generator(this,function(){return[2,[this.clientId]]})})},t.prototype.gf=function(t){return t(!0)},t.prototype.pf=function(){},t.prototype.Zh=function(){},t.prototype.nh=function(){return this.ur},t.prototype.Yo=function(t){var e=this.rT[t.s()];return e||(e=new Vi(this.ur,this.Jo),this.rT[t.s()]=e),e},t.prototype.eh=function(){return this.th},t.prototype.Zo=function(){return this.hr},t.prototype.runTransaction=function(t,e,n){var r=this;F(\"MemoryPersistence\",\"Starting transaction:\",t);var i=new Fi(this.Vf.next());return this.Jo.hT(),n(i).next(function(t){return r.Jo.aT(i).next(function(){return t})}).Wi().then(function(t){return i.or(),t})},t.prototype.uT=function(t,e){return Jn.Gi(Object.values(this.rT).map(function(n){return function(){return n.Mi(t,e)}}))},t}(),Fi=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ch=e,n}return ae.__extends(e,t),e}($n),qi=function(){function t(t){this.persistence=t,this.Qf=null,this.cT=null}return t._T=function(e){return new t(e)},Object.defineProperty(t.prototype,\"lT\",{get:function(){if(this.cT)return this.cT;throw G(\"orphanedDocuments is only valid during a transaction.\")},enumerable:!0,configurable:!0}),t.prototype.Ho=function(t){this.Qf=t},t.prototype.vi=function(t,e){return this.lT.delete(e),Jn.resolve()},t.prototype.Di=function(t,e){return this.lT.add(e),Jn.resolve()},t.prototype.bd=function(t,e){return this.lT.add(e),Jn.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.eh();return r.Gh(t,e.targetId).next(function(t){t.forEach(function(t){return n.lT.add(t)})}).next(function(){return r.Nd(t,e)})},t.prototype.hT=function(){this.cT=new Set},t.prototype.aT=function(t){var e=this,n=this.persistence.Zo().Eh();return Jn.forEach(this.lT,function(r){return e.dT(t,r).next(function(t){t||n.Zi(r)})}).next(function(){return e.cT=null,n.apply(t)})},t.prototype.Fh=function(t,e){var n=this;return this.dT(t,e).next(function(t){t?n.lT.delete(e):n.lT.add(e)})},t.prototype.oT=function(){return 0},t.prototype.dT=function(t,e){var n=this;return Jn.Gi([function(){return n.persistence.eh().Mi(t,e)},function(){return n.persistence.uT(t,e)},function(){return Jn.resolve(n.Qf.Mi(e))}])},t}(),Bi=function(){function t(){}return t.prototype.initialize=function(t){return ae.__awaiter(this,void 0,void 0,function(){var e=this;return ae.__generator(this,function(n){switch(n.label){case 0:return this.X_=this.fT(t),this.persistence=this.TT(t),[4,this.persistence.start()];case 1:return n.sent(),this.mT=this.ET(t),this.Wu=this.wT(t),this.W_=this.IT(t),this.mc=this.RT(t),this.AT=this.PT(t),this.X_.$u=function(t){return e.mc.B_(t,1)},this.W_.mc=this.mc,this.X_.mc=this.mc,[4,this.X_.start()];case 2:return n.sent(),[4,this.W_.start()];case 3:return n.sent(),[4,this.Wu.start()];case 4:return n.sent(),[4,this.persistence.gf(function(t){return ae.__awaiter(e,void 0,void 0,function(){return ae.__generator(this,function(e){switch(e.label){case 0:return[4,this.mc.Cc(t)];case 1:return e.sent(),this.mT&&(t&&!this.mT.ko?this.mT.start(this.Wu):t||this.mT.stop()),[2]}})})})];case 5:return n.sent(),[2]}})})},t.prototype.PT=function(){return new ti(this.mc)},t.prototype.ET=function(){return null},t.prototype.wT=function(t){return new fr(this.persistence,new ni,t.VT)},t.prototype.TT=function(t){return new ji(t.clientId,qi._T)},t.prototype.IT=function(t){var e=this;return new Ur(this.Wu,t.bu,t.Nr,function(t){return e.mc.B_(t,0)},t.platform.gT())},t.prototype.fT=function(){return new zr},t.prototype.RT=function(t){return new Zr(this.Wu,this.W_,this.X_,t.VT,t.Z_)},t.prototype.clearPersistence=function(){throw new me(ve.FAILED_PRECONDITION,\"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.\")},t}(),Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ae.__extends(e,t),e.prototype.ET=function(t){var e=this.persistence.Jo.bo;return new hr(e,t.Nr)},e.prototype.TT=function(t){var e=Ci.qf(t.pT),n=t.platform.yT(t.pT.cn);return Ci.mf({allowTabSynchronization:t.bT.synchronizeTabs,persistenceKey:e,clientId:t.clientId,platform:t.platform,$a:t.Nr,serializer:n,Ef:ar.Io(t.bT.cacheSizeBytes),rf:this.X_})},e.prototype.fT=function(t){if(t.bT.synchronizeTabs){if(!Gr.Uc(t.platform))throw new me(ve.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");var e=Ci.qf(t.pT);return new Gr(t.Nr,t.platform,e,t.clientId,t.VT)}return new zr},e.prototype.clearPersistence=function(t){var e=Ci.qf(t);return Ci.clearPersistence(e)},e}(Bi),zi=function(){function t(t,e,n,r){this.platform=t,this.pT=e,this.credentials=n,this.Nr=r,this.clientId=Bn.mi()}return t.prototype.start=function(t,e){var n=this;this.vT();var r=new rr,i=new rr,o=!1;return this.credentials.l(function(s){return o?void n.Nr.qr(function(){return n.Dc(s)}):(o=!0,F(\"FirestoreClient\",\"Initializing. user=\",s.uid),n.ST(t,e,s,i).then(r.resolve,r.reject))}),this.Nr.qr(function(){return r.promise}),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.vT(),this.Nr.enqueue(function(){return t.mc.enableNetwork()})},t.prototype.ST=function(t,e,n,r){return ae.__awaiter(this,void 0,void 0,function(){var i,o,s,u,a=this;return ae.__generator(this,function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),[4,this.platform.DT(this.pT)];case 1:return i=h.sent(),o=this.platform.yT(this.pT.cn),s=new Cr(this.Nr,i,this.credentials,o),[4,t.initialize({Nr:this.Nr,pT:this.pT,platform:this.platform,bu:s,clientId:this.clientId,VT:n,Z_:100,bT:e})];case 2:return h.sent(),this.persistence=t.persistence,this.X_=t.X_,this.Wu=t.Wu,this.W_=t.W_,this.mc=t.mc,this.mT=t.mT,this.CT=t.AT,this.persistence.pf(function(){return ae.__awaiter(a,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),r.resolve(),[3,4];case 3:if(u=h.sent(),r.reject(u),!this.kT(u))throw u;return[2,(console.warn(\"Error enabling offline persistence. Falling back to persistence disabled: \"+u),this.ST(new Bi,{NT:!1},n,r))];case 4:return[2]}})})},t.prototype.kT=function(t){return\"FirebaseError\"===t.name?t.code===ve.FAILED_PRECONDITION||t.code===ve.UNIMPLEMENTED:!(\"undefined\"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.vT=function(){if(this.Nr.Hr)throw new me(ve.FAILED_PRECONDITION,\"The client has already been terminated.\")},t.prototype.Dc=function(t){return this.Nr.no(),F(\"FirestoreClient\",\"Credential Changed. Current user: \"+t.uid),this.mc.Dc(t)},t.prototype.disableNetwork=function(){var t=this;return this.vT(),this.Nr.enqueue(function(){return t.mc.disableNetwork()})},t.prototype.terminate=function(){var t=this;return this.Nr.to(function(){return ae.__awaiter(t,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.mT&&this.mT.stop(),[4,this.W_.lc()];case 1:return t.sent(),[4,this.X_.lc()];case 2:return t.sent(),[4,this.persistence.lc()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},t.prototype.waitForPendingWrites=function(){var t=this;this.vT();var e=new rr;return this.Nr.qr(function(){return t.mc.Pl(e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.vT();var i=new ei(t,e,n);return this.Nr.qr(function(){return r.CT.listen(i)}),i},t.prototype.fc=function(t){var e=this;this.FT||this.Nr.qr(function(){return e.CT.fc(t)})},t.prototype.$T=function(t){var e=this;return this.vT(),this.Nr.enqueue(function(){return e.Wu.Bh(t)}).then(function(t){if(t instanceof tn)return t;if(t instanceof en)return null;throw new me(ve.UNAVAILABLE,\"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)\")})},t.prototype.MT=function(t){var e=this;return this.vT(),this.Nr.enqueue(function(){return ae.__awaiter(e,void 0,void 0,function(){var e,n,r;return ae.__generator(this,function(i){switch(i.label){case 0:return[4,this.Wu.Kh(t,!0)];case 1:return e=i.sent(),n=new Yr(t,e.zh),r=n.k_(e.documents),[2,n.nr(r,!1).snapshot]}})})})},t.prototype.write=function(t){var e=this;this.vT();var n=new rr;return this.Nr.qr(function(){return e.mc.write(t,n)}),n.promise},t.prototype.cn=function(){return this.pT.cn},t.prototype.Ol=function(t){var e=this;this.vT(),this.Nr.qr(function(){return e.CT.Ol(t),Promise.resolve()})},t.prototype.xl=function(t){this.FT||this.CT.xl(t)},Object.defineProperty(t.prototype,\"FT\",{get:function(){return this.Nr.Hr},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.vT();var n=new rr;return this.Nr.qr(function(){return e.mc.runTransaction(e.Nr,t,n),Promise.resolve()}),n.promise},t}(),Ki=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.LT(this.observer.next,t)},t.prototype.error=function(t){this.LT(this.observer.error,t)},t.prototype.OT=function(){this.muted=!0},t.prototype.LT=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Wi=function(){function t(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.xT=n,this.converter=r}return t.prototype.BT=function(t){switch(f(t)){case 0:return null;case 1:return t.booleanValue;case 2:return g(t.integerValue||t.doubleValue);case 3:return this.UT(t.timestampValue);case 4:return this.qT(t);case 5:return t.stringValue;case 6:return new lr(w(t.bytesValue));case 7:return this.QT(t.referenceValue);case 8:return new Tr(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.WT(t.arrayValue);case 10:return this.jT(t.mapValue);default:throw G(\"Invalid value type: \"+JSON.stringify(t))}},t.prototype.jT=function(t){var e=this,n={};return i(t.fields||{},function(t,r){n[t]=e.BT(r)}),n},t.prototype.WT=function(t){var e=this;return(t.values||[]).map(function(t){return e.BT(t)})},t.prototype.qT=function(t){switch(this.xT){case\"previous\":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return h(n)?t(n):n}(t);return null==e?null:this.BT(e);case\"estimate\":return this.UT(c(t));default:return null}},t.prototype.UT=function(t){var e=m(t),n=new Te(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.QT=function(t){var e=Ae.G(t);z(U(e),\"ReferenceValue is not valid \"+t);var n=new zn(e.get(1),e.get(3)),r=new ke(e.M(5));return n.isEqual(this.firestore.KT)||q(\"Document \"+r+\" contains a document reference within a different database (\"+n.projectId+\"/\"+n.database+\") which is not supported. It will be treated as a reference in the current database (\"+this.firestore.KT.projectId+\"/\"+this.firestore.KT.database+\") instead.\"),new Zi(r,this.firestore,this.converter)},t}(),Hi=ar.Po,Yi=function(){function t(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new me(ve.INVALID_ARGUMENT,\"Can't provide ssl option if host option is not set\");this.host=\"firestore.googleapis.com\",this.ssl=!0}else nt(\"settings\",\"non-empty string\",\"host\",t.host),this.host=t.host,rt(\"settings\",\"boolean\",\"ssl\",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ht(\"settings\",t,[\"host\",\"ssl\",\"credentials\",\"timestampsInSnapshots\",\"cacheSizeBytes\",\"experimentalForceLongPolling\"]),rt(\"settings\",\"object\",\"credentials\",t.credentials),this.credentials=t.credentials,rt(\"settings\",\"boolean\",\"timestampsInSnapshots\",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?q(\"The setting 'timestampsInSnapshots: true' is no longer required and should be removed.\"):!1===t.timestampsInSnapshots&&q(\"Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects.\"),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,rt(\"settings\",\"number\",\"cacheSizeBytes\",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ar.po;else{if(t.cacheSizeBytes!==Hi&&t.cacheSizeBytes<ar.Vo)throw new me(ve.INVALID_ARGUMENT,\"cacheSizeBytes must be at least \"+ar.Vo);this.cacheSizeBytes=t.cacheSizeBytes}rt(\"settings\",\"boolean\",\"experimentalForceLongPolling\",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Xi=function(){function t(e,n,r){var i=this;if(void 0===r&&(r=new Bi),this.GT=null,this.zT=new or,this.INTERNAL={delete:function(){return ae.__awaiter(i,void 0,void 0,function(){return ae.__generator(this,function(t){switch(t.label){case 0:return this.HT(),[4,this.JT.terminate()];case 1:return t.sent(),[2]}})})}},\"object\"==typeof e.options){var o=e;this.GT=o,this.KT=t.YT(o),this.XT=o.name,this.ZT=new be(n)}else{var s=e;if(!s.projectId)throw new me(ve.INVALID_ARGUMENT,\"Must provide projectId\");this.KT=new zn(s.projectId,s.database),this.XT=\"[DEFAULT]\",this.ZT=new we}this.tm=r,this.em=new Yi({}),this.sm=this.nm(this.KT)}return t.prototype.settings=function(t){Q(\"Firestore.settings\",arguments,1),tt(\"Firestore.settings\",\"object\",1,t);var e=new Yi(t);if(this.JT&&!this.em.isEqual(e))throw new me(ve.FAILED_PRECONDITION,\"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.\");this.em=e,void 0!==e.credentials&&(this.ZT=function(t){if(!t)return new we;switch(t.type){case\"gapi\":var e=t.im;return z(\"object\"==typeof e&&null!==e&&e.auth&&e.auth.getAuthHeaderValueForFirstParty,\"unexpected gapi interface\"),new Ee(e,t.V||\"0\");case\"provider\":return t.im;default:throw new me(ve.INVALID_ARGUMENT,\"makeCredentialsProvider failed due to invalid credential type\")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.HT(),this.JT.enableNetwork()},t.prototype.disableNetwork=function(){return this.HT(),this.JT.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.JT)throw new me(ve.FAILED_PRECONDITION,\"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.\");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&q(\"The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead.\"),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.rm(this.tm,{NT:!0,cacheSizeBytes:this.em.cacheSizeBytes,synchronizeTabs:r})},t.prototype.clearPersistence=function(){return ae.__awaiter(this,void 0,void 0,function(){var t,e=this;return ae.__generator(this,function(){if(void 0!==this.JT&&!this.JT.FT)throw new me(ve.FAILED_PRECONDITION,\"Persistence cannot be cleared after this Firestore instance is initialized.\");return t=new rr,[2,(this.zT.Jr(function(){return ae.__awaiter(e,void 0,void 0,function(){var e,n;return ae.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.om(),[4,this.tm.clearPersistence(e)];case 1:return r.sent(),t.resolve(),[3,3];case 2:return n=r.sent(),t.reject(n),[3,3];case 3:return[2]}})})}),t.promise)]})})},t.prototype.terminate=function(){return this.app._removeServiceInstance(\"firestore\"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,\"hm\",{get:function(){return this.HT(),this.JT.FT},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.HT(),this.JT.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){return this.HT(),Jt(t)?this.am(t):(tt(\"Firestore.onSnapshotsInSync\",\"function\",1,t),this.am({next:t}))},t.prototype.am=function(t){var e=this,n=new Ki({next:function(){t.next&&t.next()},error:function(){throw G(\"Uncaught Error in onSnapshotsInSync\")}});return this.JT.Ol(n),function(){n.OT(),e.JT.xl(n)}},t.prototype.HT=function(){return this.JT||this.rm(new Bi,{NT:!1}),this.JT},t.prototype.om=function(){return new Gn(this.KT,this.XT,this.em.host,this.em.ssl,this.em.forceLongPolling)},t.prototype.rm=function(t,e){var n=this.om();return this.JT=new zi(Fn.Lt(),n,this.ZT,this.zT),this.JT.start(t,e)},t.prototype.nm=function(t){var e=new jn(t,{dn:Fn.Lt().dn});return new kr(e,function(e){if(e instanceof Zi){var n=t,r=e.firestore.KT;if(!r.isEqual(n))throw new me(ve.INVALID_ARGUMENT,\"Document reference is for database \"+r.projectId+\"/\"+r.database+\" but should be for database \"+n.projectId+\"/\"+n.database);return new Dr(t,e.um)}return e})},t.YT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,\"projectId\"))throw new me(ve.INVALID_ARGUMENT,'\"projectId\" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||\"string\"!=typeof n)throw new me(ve.INVALID_ARGUMENT,\"projectId must be a string in FirebaseApp.options\");return new zn(n)},Object.defineProperty(t.prototype,\"app\",{get:function(){if(!this.GT)throw new me(ve.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this.GT},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return Q(\"Firestore.collection\",arguments,1),tt(\"Firestore.collection\",\"non-empty string\",1,t),this.HT(),new io(Ae.G(t),this)},t.prototype.doc=function(t){return Q(\"Firestore.doc\",arguments,1),tt(\"Firestore.doc\",\"non-empty string\",1,t),this.HT(),Zi.cm(Ae.G(t),this)},t.prototype.collectionGroup=function(t){if(Q(\"Firestore.collectionGroup\",arguments,1),tt(\"Firestore.collectionGroup\",\"non-empty string\",1,t),0<=t.indexOf(\"/\"))throw new me(ve.INVALID_ARGUMENT,\"Invalid collection ID '\"+t+\"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.\");return this.HT(),new no(new on(Ae.H,t),this)},t.prototype.runTransaction=function(t){var e=this;return Q(\"Firestore.runTransaction\",arguments,1),tt(\"Firestore.runTransaction\",\"function\",1,t),this.HT().transaction(function(n){return t(new Ji(e,n))})},t.prototype.batch=function(){return this.HT(),new Qi(this)},Object.defineProperty(t,\"logLevel\",{get:function(){switch(M()){case ce.LogLevel.DEBUG:return\"debug\";case ce.LogLevel.SILENT:return\"silent\";default:return\"error\"}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(Q(\"Firestore.setLogLevel\",arguments,1),tt(\"Firestore.setLogLevel\",\"non-empty string\",1,t),t){case\"debug\":j(ce.LogLevel.DEBUG);break;case\"error\":j(ce.LogLevel.ERROR);break;case\"silent\":j(ce.LogLevel.SILENT);break;default:throw new me(ve.INVALID_ARGUMENT,\"Invalid log level: \"+t)}},t.prototype._m=function(){return this.em.timestampsInSnapshots},t}(),Ji=function(){function t(t,e){this.lm=t,this.dm=e}return t.prototype.get=function(t){var e=this;Q(\"Transaction.get\",arguments,1);var n=te(\"Transaction.get\",t,this.lm);return this.dm.pu([n.um]).then(function(t){if(!t||1!==t.length)return G(\"Mismatch in docs returned from document lookup.\");var r=t[0];if(r instanceof en)return new to(e.lm,n.um,null,!1,!1,n.fm);if(r instanceof tn)return new to(e.lm,n.um,r,!1,!1,n.fm);throw G(\"BatchGetDocumentsRequest returned unexpected document type: \"+r.constructor.name)})},t.prototype.set=function(t,e,n){$(\"Transaction.set\",arguments,2,3);var r=te(\"Transaction.set\",t,this.lm);n=Qt(\"Transaction.set\",n);var i=ee(r.fm,e,\"Transaction.set\"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.lm.sm.pa(s,o,n.mergeFields):this.lm.sm.Va(s,o);return this.dm.set(r.um,u),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return\"string\"==typeof e||e instanceof dr?(Z(\"Transaction.update\",arguments,3),r=te(\"Transaction.update\",t,this.lm),i=this.lm.sm.Sa(\"Transaction.update\",e,n,o)):(Q(\"Transaction.update\",arguments,2),r=te(\"Transaction.update\",t,this.lm),i=this.lm.sm.ya(\"Transaction.update\",e)),this.dm.update(r.um,i),this},t.prototype.delete=function(t){Q(\"Transaction.delete\",arguments,1);var e=te(\"Transaction.delete\",t,this.lm);return this.dm.delete(e.um),this},t}(),Qi=function(){function t(t){this.lm=t,this.Tm=[],this.mm=!1}return t.prototype.set=function(t,e,n){$(\"WriteBatch.set\",arguments,2,3),this.Em();var r=te(\"WriteBatch.set\",t,this.lm);n=Qt(\"WriteBatch.set\",n);var i=ee(r.fm,e,\"WriteBatch.set\"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.lm.sm.pa(s,o,n.mergeFields):this.lm.sm.Va(s,o);return this.Tm=this.Tm.concat(u.da(r.um,ze.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Em(),\"string\"==typeof e||e instanceof dr?(Z(\"WriteBatch.update\",arguments,3),r=te(\"WriteBatch.update\",t,this.lm),i=this.lm.sm.Sa(\"WriteBatch.update\",e,n,o)):(Q(\"WriteBatch.update\",arguments,2),r=te(\"WriteBatch.update\",t,this.lm),i=this.lm.sm.ya(\"WriteBatch.update\",e)),this.Tm=this.Tm.concat(i.da(r.um,ze.exists(!0))),this},t.prototype.delete=function(t){Q(\"WriteBatch.delete\",arguments,1),this.Em();var e=te(\"WriteBatch.delete\",t,this.lm);return this.Tm=this.Tm.concat(new Xe(e.um,ze.NONE)),this},t.prototype.commit=function(){return this.Em(),this.mm=!0,0<this.Tm.length?this.lm.HT().write(this.Tm):Promise.resolve()},t.prototype.Em=function(){if(this.mm)throw new me(ve.FAILED_PRECONDITION,\"A write batch can no longer be used after commit() has been called.\")},t}(),Zi=function(){function t(t,e,n){this.um=t,this.firestore=e,this.fm=n,this.JT=this.firestore.HT()}return t.cm=function(e,n,r){if(0!=e.length%2)throw new me(ve.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+e.K()+\" has \"+e.length);return new t(new ke(e),n,r)},Object.defineProperty(t.prototype,\"id\",{get:function(){return this.um.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new io(this.um.path.L(),this.firestore,this.fm)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this.um.path.K()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(Q(\"DocumentReference.collection\",arguments,1),tt(\"DocumentReference.collection\",\"non-empty string\",1,t),!t)throw new me(ve.INVALID_ARGUMENT,\"Must provide a non-empty collection name to collection()\");var e=Ae.G(t);return new io(this.um.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ct(\"isEqual\",\"DocumentReference\",1,e);return this.firestore===e.firestore&&this.um.isEqual(e.um)&&this.fm===e.fm},t.prototype.set=function(t,e){$(\"DocumentReference.set\",arguments,1,2),e=Qt(\"DocumentReference.set\",e);var n=ee(this.fm,t,\"DocumentReference.set\"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.sm.pa(i,r,e.mergeFields):this.firestore.sm.Va(i,r);return this.JT.write(o.da(this.um,ze.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return\"string\"==typeof t||t instanceof dr?(Z(\"DocumentReference.update\",arguments,2),n=this.firestore.sm.Sa(\"DocumentReference.update\",t,e,r)):(Q(\"DocumentReference.update\",arguments,1),n=this.firestore.sm.ya(\"DocumentReference.update\",t)),this.JT.write(n.da(this.um,ze.exists(!0)))},t.prototype.delete=function(){return Q(\"DocumentReference.delete\",arguments,0),this.JT.write([new Xe(this.um,ze.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];$(\"DocumentReference.onSnapshot\",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;\"object\"!=typeof t[i]||Jt(t[i])||(ht(\"DocumentReference.onSnapshot\",r=t[i],[\"includeMetadataChanges\"]),rt(\"DocumentReference.onSnapshot\",\"boolean\",\"includeMetadataChanges\",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return Jt(t[i])?n=t[i]:(tt(\"DocumentReference.onSnapshot\",\"function\",i,t[i]),et(\"DocumentReference.onSnapshot\",\"function\",i+1,t[i+1]),et(\"DocumentReference.onSnapshot\",\"function\",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.wm(o,n)},t.prototype.wm=function(t,e){var n=this,r=function(t){console.error(\"Uncaught Error in onSnapshot:\",t)};e.error&&(r=e.error.bind(e));var i=new Ki({next:function(t){if(e.next){var r=t.docs.get(n.um);e.next(new to(n.firestore,n.um,r,t.fromCache,t.hasPendingWrites,n.fm))}},error:r}),o=this.JT.listen(on.ve(this.um.path),i,t);return function(){i.OT(),n.JT.fc(o)}},t.prototype.get=function(t){var e=this;return $(\"DocumentReference.get\",arguments,0,1),$t(\"DocumentReference.get\",t),new Promise(function(n,r){t&&\"cache\"===t.source?e.firestore.HT().$T(e.um).then(function(t){n(new to(e.firestore,e.um,t,!0,t instanceof tn&&t.te,e.fm))},r):e.Im(n,r,t)})},t.prototype.Im=function(t,e,n){var r=this.wm({includeMetadataChanges:!0,Kl:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new me(ve.UNAVAILABLE,\"Failed to get document because the client is offline.\")):i.exists&&i.metadata.fromCache&&n&&\"server\"===n.source?e(new me(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this.um,this.firestore,e)},t}(),$i=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),to=function(){function t(t,e,n,r,i,o){this.lm=t,this.um=e,this.Rm=n,this.Am=r,this.Pm=i,this.fm=o}return t.prototype.data=function(t){if($(\"DocumentSnapshot.data\",arguments,0,1),t=Zt(\"DocumentSnapshot.data\",t),this.Rm){if(this.fm){var e=new eo(this.lm,this.um,this.Rm,this.Am,this.Pm);return this.fm.fromFirestore(e,t)}return new Wi(this.lm,this.lm._m(),t.serverTimestamps,void 0).BT(this.Rm.Ie())}},t.prototype.get=function(t,e){if($(\"DocumentSnapshot.get\",arguments,1,2),e=Zt(\"DocumentSnapshot.get\",e),this.Rm){var n=this.Rm.data().field(bt(\"DocumentSnapshot.get\",t));if(null!==n)return new Wi(this.lm,this.lm._m(),e.serverTimestamps,this.fm).BT(n)}},Object.defineProperty(t.prototype,\"id\",{get:function(){return this.um.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"ref\",{get:function(){return new Zi(this.um,this.lm,this.fm)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"exists\",{get:function(){return null!==this.Rm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return new $i(this.Pm,this.Am)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw ct(\"isEqual\",\"DocumentSnapshot\",1,e);return this.lm===e.lm&&this.Am===e.Am&&this.um.isEqual(e.um)&&(null===this.Rm?null===e.Rm:this.Rm.isEqual(e.Rm))&&this.fm===e.fm},t}(),eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ae.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(to),no=function(){function t(t,e,n){this.Vm=t,this.firestore=e,this.fm=n}return t.prototype.where=function(e,n,r){var i;Q(\"Query.where\",arguments,3),at(\"Query.where\",3,r),function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new me(ve.INVALID_ARGUMENT,\"Invalid value \"+ut(r)+\" provided to function Query.where() for its \"+lt(2)+\" argument. Acceptable values: \"+e.join(\", \"))}(0,[\"<\",\"<=\",\"==\",\">=\",\">\",\"array-contains\",\"in\",\"array-contains-any\"],0,n);var o=bt(\"Query.where\",e),s=sn.G(n);if(o.Y()){if(s===sn.ARRAY_CONTAINS||s===sn.ARRAY_CONTAINS_ANY)throw new me(ve.INVALID_ARGUMENT,\"Invalid Query. You can't perform '\"+s.toString()+\"' queries on FieldPath.documentId().\");if(s===sn.IN){this.gm(r,s);for(var u,a=[],h=0,c=r;h<c.length;h++)u=c[h],a.push(this.pm(u));i={arrayValue:{values:a}}}else i=this.pm(r)}else s!==sn.IN&&s!==sn.ARRAY_CONTAINS_ANY||this.gm(r,s),i=this.firestore.sm.Da(\"Query.where\",r,s===sn.IN);var f=un.create(o,s,i);return this.ym(f),new t(this.Vm.Ce(f),this.firestore,this.fm)},t.prototype.orderBy=function(e,n){var r;if($(\"Query.orderBy\",arguments,1,2),et(\"Query.orderBy\",\"non-empty string\",2,n),void 0===n||\"asc\"===n)r=pn.ASCENDING;else{if(\"desc\"!==n)throw new me(ve.INVALID_ARGUMENT,\"Function Query.orderBy() has unknown direction '\"+n+\"', expected 'asc' or 'desc'.\");r=pn.DESCENDING}if(null!==this.Vm.startAt)throw new me(ve.INVALID_ARGUMENT,\"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().\");if(null!==this.Vm.endAt)throw new me(ve.INVALID_ARGUMENT,\"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().\");var i=bt(\"Query.orderBy\",e),o=new mn(i,r);return this.bm(o),new t(this.Vm.ke(o),this.firestore,this.fm)},t.prototype.limit=function(e){return Q(\"Query.limit\",arguments,1),tt(\"Query.limit\",\"number\",1,e),ft(\"Query.limit\",1,e),new t(this.Vm.Ne(e),this.firestore,this.fm)},t.prototype.limitToLast=function(e){return Q(\"Query.limitToLast\",arguments,1),tt(\"Query.limitToLast\",\"number\",1,e),ft(\"Query.limitToLast\",1,e),new t(this.Vm.Fe(e),this.firestore,this.fm)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Z(\"Query.startAt\",arguments,1);var i=this.vm(\"Query.startAt\",e,n,!0);return new t(this.Vm.$e(i),this.firestore,this.fm)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Z(\"Query.startAfter\",arguments,1);var i=this.vm(\"Query.startAfter\",e,n,!1);return new t(this.Vm.$e(i),this.firestore,this.fm)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Z(\"Query.endBefore\",arguments,1);var i=this.vm(\"Query.endBefore\",e,n,!0);return new t(this.Vm.Me(i),this.firestore,this.fm)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Z(\"Query.endAt\",arguments,1);var i=this.vm(\"Query.endAt\",e,n,!1);return new t(this.Vm.Me(i),this.firestore,this.fm)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ct(\"isEqual\",\"Query\",1,e);return this.firestore===e.firestore&&this.Vm.isEqual(e.Vm)},t.prototype.withConverter=function(e){return new t(this.Vm,this.firestore,e)},t.prototype.vm=function(t,e,n,r){if(at(t,1,e),e instanceof to){if(0<n.length)throw new me(ve.INVALID_ARGUMENT,\"Too many arguments provided to \"+t+\"().\");var i=e;if(!i.exists)throw new me(ve.NOT_FOUND,\"Can't use a DocumentSnapshot that doesn't exist for \"+t+\"().\");return this.Sm(i.Rm,r)}var o=[e].concat(n);return this.Dm(t,o,r)},t.prototype.Sm=function(t,e){for(var n,r=[],i=0,o=this.Vm.orderBy;i<o.length;i++)if((n=o[i]).field.Y())r.push(b(this.firestore.KT,t.key));else{var s=t.field(n.field);if(h(s))throw new me(ve.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field \"'+n.field+'\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=n.field.K();throw new me(ve.INVALID_ARGUMENT,\"Invalid query. You are trying to start or end a query using a document for which the field '\"+u+\"' (used as the orderBy) does not exist.\")}r.push(s)}return new vn(r,e)},t.prototype.Dm=function(t,e,n){var r=this.Vm.Ve;if(e.length>r.length)throw new me(ve.INVALID_ARGUMENT,\"Too many arguments provided to \"+t+\"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses\");for(var i,o=[],s=0;s<e.length;s++)if(i=e[s],r[s].field.Y()){if(\"string\"!=typeof i)throw new me(ve.INVALID_ARGUMENT,\"Invalid query. Expected a string for document ID in \"+t+\"(), but got a \"+typeof i);if(!this.Vm.He()&&-1!==i.indexOf(\"/\"))throw new me(ve.INVALID_ARGUMENT,\"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to \"+t+\"() must be a plain document ID, but '\"+i+\"' contains a slash.\");var u=this.Vm.path.child(Ae.G(i));if(!ke.st(u))throw new me(ve.INVALID_ARGUMENT,\"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to \"+t+\"() must result in a valid document path, but '\"+u+\"' is not because it contains an odd number of segments.\");var a=new ke(u);o.push(b(this.firestore.KT,a))}else{var h=this.firestore.sm.Da(t,i);o.push(h)}return new vn(o,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];$(\"Query.onSnapshot\",arguments,1,4);var n,r={},i=0;return\"object\"!=typeof t[i]||Jt(t[i])||(ht(\"Query.onSnapshot\",r=t[i],[\"includeMetadataChanges\"]),rt(\"Query.onSnapshot\",\"boolean\",\"includeMetadataChanges\",r.includeMetadataChanges),i++),Jt(t[i])?n=t[i]:(tt(\"Query.onSnapshot\",\"function\",i,t[i]),et(\"Query.onSnapshot\",\"function\",i+1,t[i+1]),et(\"Query.onSnapshot\",\"function\",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.Cm(this.Vm),this.wm(r,n)},t.prototype.wm=function(t,e){var n=this,r=function(t){console.error(\"Uncaught Error in onSnapshot:\",t)};e.error&&(r=e.error.bind(e));var i=new Ki({next:function(t){e.next&&e.next(new ro(n.firestore,n.Vm,t,n.fm))},error:r}),o=this.firestore.HT(),s=o.listen(this.Vm,i,t);return function(){i.OT(),o.fc(s)}},t.prototype.Cm=function(t){if(t.Ke()&&0===t.Ve.length)throw new me(ve.UNIMPLEMENTED,\"limitToLast() queries require specifying at least one orderBy() clause\")},t.prototype.get=function(t){var e=this;return $(\"Query.get\",arguments,0,1),$t(\"Query.get\",t),this.Cm(this.Vm),new Promise(function(n,r){t&&\"cache\"===t.source?e.firestore.HT().MT(e.Vm).then(function(t){n(new ro(e.firestore,e.Vm,t,e.fm))},r):e.Im(n,r,t)})},t.prototype.Im=function(t,e,n){var r=this.wm({includeMetadataChanges:!0,Kl:!0},{next:function(i){r(),i.metadata.fromCache&&n&&\"server\"===n.source?e(new me(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.pm=function(t){if(\"string\"==typeof t){if(\"\"===t)throw new me(ve.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.\");if(!this.Vm.He()&&-1!==t.indexOf(\"/\"))throw new me(ve.INVALID_ARGUMENT,\"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '\"+t+\"' contains a '/' character.\");var e=this.Vm.path.child(Ae.G(t));if(!ke.st(e))throw new me(ve.INVALID_ARGUMENT,\"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '\"+e+\"' is not because it has an odd number of segments (\"+e.length+\").\");return b(this.firestore.KT,new ke(e))}if(t instanceof Zi)return b(this.firestore.KT,t.um);throw new me(ve.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: \"+ut(t)+\".\")},t.prototype.gm=function(t,e){if(!Array.isArray(t)||0===t.length)throw new me(ve.INVALID_ARGUMENT,\"Invalid Query. A non-empty array is required for '\"+e.toString()+\"' filters.\");if(10<t.length)throw new me(ve.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters support a maximum of 10 elements in the value array.\");if(0<=t.indexOf(null))throw new me(ve.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters cannot contain 'null' in the value array.\");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new me(ve.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters cannot contain 'NaN' in the value array.\")},t.prototype.ym=function(t){if(t instanceof un){var e=[sn.ARRAY_CONTAINS,sn.ARRAY_CONTAINS_ANY],n=[sn.IN,sn.ARRAY_CONTAINS_ANY],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.Ge()){var o=this.Vm.Se();if(null!==o&&!o.isEqual(t.field))throw new me(ve.INVALID_ARGUMENT,\"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '\"+o.toString()+\"' and '\"+t.field.toString()+\"'\");var s=this.Vm.De();null!==s&&this.km(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.Vm.ze(n)),null===u&&r&&(u=this.Vm.ze(e)),null!=u)throw u===t.op?new me(ve.INVALID_ARGUMENT,\"Invalid query. You cannot use more than one '\"+t.op.toString()+\"' filter.\"):new me(ve.INVALID_ARGUMENT,\"Invalid query. You cannot use '\"+t.op.toString()+\"' filters with '\"+u.toString()+\"' filters.\")}}},t.prototype.bm=function(t){if(null===this.Vm.De()){var e=this.Vm.Se();null!==e&&this.km(e,t.field)}},t.prototype.km=function(t,e){if(!e.isEqual(t))throw new me(ve.INVALID_ARGUMENT,\"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '\"+t.toString()+\"' and so you must also use '\"+t.toString()+\"' as your first Query.orderBy(), but your first Query.orderBy() is on field '\"+e.toString()+\"' instead.\")},t}(),ro=function(){function t(t,e,n,r){this.lm=t,this.Nm=e,this.Fm=n,this.fm=r,this.$m=null,this.Mm=null,this.metadata=new $i(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return this.Fm.docs.U()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this.Fm.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;$(\"QuerySnapshot.forEach\",arguments,1,2),tt(\"QuerySnapshot.forEach\",\"function\",1,t),this.Fm.docs.forEach(function(r){t.call(e,n.Lm(r))})},Object.defineProperty(t.prototype,\"query\",{get:function(){return new no(this.Nm,this.lm,this.fm)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(ht(\"QuerySnapshot.docChanges\",t,[\"includeMetadataChanges\"]),rt(\"QuerySnapshot.docChanges\",\"boolean\",\"includeMetadataChanges\",t.includeMetadataChanges));var e=t&&t.includeMetadataChanges;if(e&&this.Fm.ds)throw new me(ve.INVALID_ARGUMENT,\"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().\");return this.$m&&this.Mm===e||(this.$m=function(t,e,n,r){if(n.cs.U()){var i=0;return n.docChanges.map(function(e){var o=new eo(t,e.doc.key,e.doc,n.fromCache,n._s.has(e.doc.key),r);return e.doc,{type:\"added\",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.cs;return n.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var i=new eo(t,e.doc.key,e.doc,n.fromCache,n._s.has(e.doc.key),r),s=-1,u=-1;return 0!==e.type&&(s=o.indexOf(e.doc.key),o=o.delete(e.doc.key)),1!==e.type&&(u=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(t){return 0===t?\"added\":2===t||3===t?\"modified\":1===t?\"removed\":G(\"Unknown change type: \"+t)}(e.type),doc:i,oldIndex:s,newIndex:u}})}(this.lm,e,this.Fm,this.fm),this.Mm=e),this.$m},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ct(\"isEqual\",\"QuerySnapshot\",1,e);return this.lm===e.lm&&this.Nm.isEqual(e.Nm)&&this.Fm.isEqual(e.Fm)&&this.fm===e.fm},t.prototype.Lm=function(t){return new eo(this.lm,t.key,t,this.metadata.fromCache,this.Fm._s.has(t.key),this.fm)},t}(),io=function(t){function e(e,n,r){var i=this;if((i=t.call(this,on.ve(e),n,r)||this).Om=e,1!=e.length%2)throw new me(ve.INVALID_ARGUMENT,\"Invalid collection reference. Collection references must have an odd number of segments, but \"+e.K()+\" has \"+e.length);return i}return ae.__extends(e,t),Object.defineProperty(e.prototype,\"id\",{get:function(){return this.Vm.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"parent\",{get:function(){var t=this.Vm.path.L();return t.U()?null:new Zi(new ke(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"path\",{get:function(){return this.Vm.path.K()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if($(\"CollectionReference.doc\",arguments,0,1),0===arguments.length&&(t=Bn.mi()),tt(\"CollectionReference.doc\",\"non-empty string\",1,t),\"\"===t)throw new me(ve.INVALID_ARGUMENT,\"Document path must be a non-empty string\");var e=Ae.G(t);return Zi.cm(this.Vm.path.child(e),this.firestore,this.fm)},e.prototype.add=function(t){Q(\"CollectionReference.add\",arguments,1),tt(\"CollectionReference.add\",\"object\",1,this.fm?this.fm.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},e.prototype.withConverter=function(t){return new e(this.Om,this.firestore,t)},e}(no),oo=dt(Xi,\"Use firebase.firestore() instead.\"),so=dt(Ji,\"Use firebase.firestore().runTransaction() instead.\"),uo=dt(Qi,\"Use firebase.firestore().batch() instead.\"),ao=dt(Zi,\"Use firebase.firestore().doc() instead.\"),ho=dt(to),co=dt(eo),fo=dt(no),lo=dt(ro),po=dt(io,\"Use firebase.firestore().collection() instead.\"),yo={Firestore:oo,GeoPoint:Tr,Timestamp:Te,Blob:pr,Transaction:so,WriteBatch:uo,DocumentReference:ao,DocumentSnapshot:ho,Query:fo,QueryDocumentSnapshot:co,QuerySnapshot:lo,CollectionReference:po,FieldPath:dr,FieldValue:Er,setLogLevel:Xi.setLogLevel,CACHE_SIZE_UNLIMITED:Hi},vo=function(){function t(){}return t.prototype.Hu=function(){},t.prototype.lc=function(){},t}(),mo=function(){function t(){var t=this;this.xm=function(){return t.Bm()},this.Um=function(){return t.qm()},this.Qm=[],this.Wm()}return t.prototype.Hu=function(t){this.Qm.push(t)},t.prototype.lc=function(){window.removeEventListener(\"online\",this.xm),window.removeEventListener(\"offline\",this.Um)},t.prototype.Wm=function(){window.addEventListener(\"online\",this.xm),window.addEventListener(\"offline\",this.Um)},t.prototype.Bm=function(){F(\"ConnectivityMonitor\",\"Network connectivity changed: AVAILABLE\");for(var t=0,e=this.Qm;t<e.length;t++)(0,e[t])(0)},t.prototype.qm=function(){F(\"ConnectivityMonitor\",\"Network connectivity changed: UNAVAILABLE\");for(var t=0,e=this.Qm;t<e.length;t++)(0,e[t])(1)},t.Uc=function(){return\"undefined\"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),go=function(){function t(t){this.jm=t.jm,this.Km=t.Km}return t.prototype._u=function(t){this.Gm=t},t.prototype.ou=function(t){this.zm=t},t.prototype.onMessage=function(t){this.Hm=t},t.prototype.close=function(){this.Km()},t.prototype.send=function(t){this.jm(t)},t.prototype.Jm=function(){this.Gm()},t.prototype.Ym=function(t){this.zm(t)},t.prototype.Xm=function(t){this.Hm(t)},t}(),wo={BatchGetDocuments:\"batchGet\",Commit:\"commit\"},bo=function(){function t(t){this.cn=t.cn;var e=t.ssl?\"https\":\"http\";this.Zm=e+\"://\"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.tE=function(t,e){if(e)for(var n in e.h)e.h.hasOwnProperty(n)&&(t[n]=e.h[n]);t[\"X-Goog-Api-Client\"]=\"gl-js/ fire/\"+de},t.prototype.gu=function(t,e,n){var r=this,i=this.eE(t);return new Promise(function(o,s){var u=new pe.XhrIo;u.listenOnce(pe.EventType.COMPLETE,function(){try{switch(u.getLastErrorCode()){case pe.ErrorCode.NO_ERROR:var e=u.getResponseJson();F(\"Connection\",\"XHR received:\",JSON.stringify(e)),o(e);break;case pe.ErrorCode.TIMEOUT:F(\"Connection\",'RPC \"'+t+'\" timed out'),s(new me(ve.DEADLINE_EXCEEDED,\"Request time out\"));break;case pe.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(F(\"Connection\",'RPC \"'+t+'\" failed with status:',n,\"response text:\",u.getResponseText()),0<n){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=r.status.toLowerCase().replace(\"_\",\"-\");return 0<=Object.values(ve).indexOf(e)?e:ve.UNKNOWN}();s(new me(i,r.message))}else s(new me(ve.UNKNOWN,\"Server responded with status \"+u.getStatus()))}else F(\"Connection\",'RPC \"'+t+'\" failed'),s(new me(ve.UNAVAILABLE,\"Connection failed.\"));break;default:G('RPC \"'+t+'\" failed with unanticipated webchannel error '+u.getLastErrorCode()+\": \"+u.getLastError()+\", giving up.\")}}finally{F(\"Connection\",'RPC \"'+t+'\" completed.')}});var a=Object.assign({},e);delete a.database;var h=JSON.stringify(a);F(\"Connection\",\"XHR sending: \",i+\" \"+h);var c={\"Content-Type\":\"text/plain\"};r.tE(c,n),u.send(i,\"POST\",h,c,15)})},t.prototype.yu=function(t,e,n){return this.gu(t,e,n)},t.prototype.lu=function(t,e){var n=[this.Zm,\"/\",\"google.firestore.v1.Firestore\",\"/\",t,\"/channel\"],r=pe.createWebChannelTransport(),i={httpSessionIdParam:\"gsessionid\",initMessageHeaders:{},messageUrlParams:{database:\"projects/\"+this.cn.projectId+\"/databases/\"+this.cn.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.tE(i.initMessageHeaders,e),fe.isMobileCordova()||fe.isReactNative()||fe.isElectron()||fe.isIE()||fe.isUWP()||fe.isBrowserExtension()||(i.httpHeadersOverwriteParam=\"$httpHeaders\");var o=n.join(\"\");F(\"Connection\",\"Creating WebChannel: \"+o+\" \"+i);var s=r.createWebChannel(o,i),u=!1,a=!1,h=new go({jm:function(t){a?F(\"Connection\",\"Not sending because WebChannel is closed:\",t):(u||(F(\"Connection\",\"Opening WebChannel transport.\"),s.open(),u=!0),F(\"Connection\",\"WebChannel sending:\",t),s.send(t))},Km:function(){return s.close()}}),c=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return c(pe.WebChannel.EventType.OPEN,function(){a||F(\"Connection\",\"WebChannel transport opened.\")}),c(pe.WebChannel.EventType.CLOSE,function(){a||(a=!0,F(\"Connection\",\"WebChannel transport closed\"),h.Ym())}),c(pe.WebChannel.EventType.ERROR,function(t){a||(a=!0,F(\"Connection\",\"WebChannel transport errored:\",t),h.Ym(new me(ve.UNAVAILABLE,\"The operation could not be completed\")))}),c(pe.WebChannel.EventType.MESSAGE,function(t){var e;if(!a){var n=t.data[0];z(!!n,\"Got a webchannel message without data.\");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){F(\"Connection\",\"WebChannel received error:\",i);var o=i.status,u=function(t){var e=dn[o];if(void 0!==e)return D(e)}(),c=i.message;void 0===u&&(u=ve.INTERNAL,c=\"Unknown error status: \"+o+\" with message \"+i.message),a=!0,h.Ym(new me(u,c)),s.close()}else F(\"Connection\",\"WebChannel received:\",n),h.Xm(n)}}),setTimeout(function(){h.Jm()},0),h},t.prototype.eE=function(t){var e=wo[t];return this.Zm+\"/v1/projects/\"+this.cn.projectId+\"/databases/\"+this.cn.database+\"/documents:\"+e},t}();Fn.fi(new(function(){function t(){this.dn=!0,this.ia=\"undefined\"!=typeof atob}return Object.defineProperty(t.prototype,\"document\",{get:function(){return\"undefined\"==typeof document?null:document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"window\",{get:function(){return\"undefined\"==typeof window?null:window},enumerable:!0,configurable:!0}),t.prototype.DT=function(t){return Promise.resolve(new bo(t))},t.prototype.gT=function(){return mo.Uc()?new mo:new vo},t.prototype.yT=function(t){return new jn(t,{dn:!0})},t.prototype.Ti=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}())),ne(he),e.__PRIVATE_registerFirestore=ne},function(t,e,n){\"use strict\";\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(e,\"__esModule\",{value:!0});var r,i,o=n(0),s=n(1),u=n(3),a=n(4),h=((r={})[\"no-app\"]=\"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()\",r[\"bad-app-name\"]=\"Illegal App name: '{$appName}\",r[\"duplicate-app\"]=\"Firebase App named '{$appName}' already exists\",r[\"app-deleted\"]=\"Firebase App named '{$appName}' already deleted\",r[\"invalid-app-argument\"]=\"firebase.{$appName}() takes either no argument or a Firebase App instance.\",r[\"invalid-log-argument\"]=\"First argument to `onLog` must be null or a function.\",r),c=new s.ErrorFactory(\"app\",\"Firebase\",h),f=\"@firebase/app\",l=\"[DEFAULT]\",p=((i={})[f]=\"fire-core\",i[\"@firebase/analytics\"]=\"fire-analytics\",i[\"@firebase/auth\"]=\"fire-auth\",i[\"@firebase/database\"]=\"fire-rtdb\",i[\"@firebase/functions\"]=\"fire-fn\",i[\"@firebase/installations\"]=\"fire-iid\",i[\"@firebase/messaging\"]=\"fire-fcm\",i[\"@firebase/performance\"]=\"fire-perf\",i[\"@firebase/remote-config\"]=\"fire-rc\",i[\"@firebase/storage\"]=\"fire-gcs\",i[\"@firebase/firestore\"]=\"fire-fst\",i[\"fire-js\"]=\"fire-js\",i[\"firebase-wrapper\"]=\"fire-js-all\",i),d=new a.Logger(\"@firebase/app\"),y=function(){function t(t,e,n){var r,i,a=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=s.deepCopy(t),this.container=new u.ComponentContainer(e.name),this._addComponent(new u.Component(\"app\",function(){return a},\"PUBLIC\"));try{for(var h,c=o.__values(this.firebase_.INTERNAL.components.values()),f=c.next();!f.done;f=c.next())h=f.value,this._addComponent(h)}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,\"automaticDataCollectionEnabled\",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"name\",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"options\",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(t){return t.delete()}))}).then(function(){t.isDeleted_=!0})},t.prototype._getService=function(t,e){return void 0===e&&(e=l),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=l),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug(\"Component \"+t.name+\" failed to register with FirebaseApp \"+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create(\"app-deleted\",{appName:this.name_})},t}();\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */y.prototype.name&&y.prototype.options||y.prototype.delete||console.log(\"dc\");var v=\"7.14.1\",m=\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction t(){var e=function(t){function e(t){if(t=t||l,!s.contains(r,t))throw c.create(\"no-app\",{appName:t});return r[t]}function n(n){var u,a,f=n.name;if(i.has(f))return d.debug(\"There were multiple attempts to register component \"+f+\".\"),\"PUBLIC\"===n.type?h[f]:null;if(i.set(f,n),\"PUBLIC\"===n.type){var l=function(t){if(void 0===t&&(t=e()),\"function\"!=typeof t[f])throw c.create(\"invalid-app-argument\",{appName:f});return t[f]()};void 0!==n.serviceProps&&s.deepExtend(l,n.serviceProps),h[f]=l,t.prototype[f]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,f).apply(this,n.multipleInstances?t:[])}}try{for(var p,y=o.__values(Object.keys(r)),v=y.next();!v.done;v=y.next())p=v.value,r[p]._addComponent(n)}catch(t){u={error:t}}finally{try{v&&!v.done&&(a=y.return)&&a.call(y)}finally{if(u)throw u.error}}return\"PUBLIC\"===n.type?h[f]:null}var r={},i=new Map,h={__esModule:!0,initializeApp:function(e,n){void 0===n&&(n={}),(\"object\"!=typeof n||null===n)&&(n={name:n});var i=n;void 0===i.name&&(i.name=l);var o=i.name;if(\"string\"!=typeof o||!o)throw c.create(\"bad-app-name\",{appName:o+\"\"});if(s.contains(r,o))throw c.create(\"duplicate-app\",{appName:o});var u=new t(e,i,h);return r[o]=u,u},app:e,registerVersion:function(t,e,r){var i,o=null!==(i=p[t])&&void 0!==i?i:t;r&&(o+=\"-\"+r);var s=o.match(/\\s|\\//),a=e.match(/\\s|\\//);if(s||a){var h=['Unable to register library \"'+o+'\" with version \"'+e+'\":'];return s&&h.push('library name \"'+o+'\" contains illegal characters (whitespace or \"/\")'),s&&a&&h.push(\"and\"),a&&h.push('version name \"'+e+'\" contains illegal characters (whitespace or \"/\")'),void d.warn(h.join(\" \"))}n(new u.Component(o+\"-version\",function(){return{library:o,version:e}},\"VERSION\"))},setLogLevel:a.setLogLevel,onLog:function(t,e){if(null!==t&&\"function\"!=typeof t)throw c.create(\"invalid-log-argument\",{appName:name});a.setUserLogHandler(t,e)},apps:null,SDK_VERSION:v,INTERNAL:{registerComponent:n,removeApp:function(t){delete r[t]},components:i,useAsService:function(t,e){return\"serverAuth\"===e?null:e}}};return h.default=h,Object.defineProperty(h,\"apps\",{get:function(){return Object.keys(r).map(function(t){return r[t]})}}),e.App=t,h}(y);return e.INTERNAL=o.__assign(o.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){s.deepExtend(e,t)},createSubscribe:s.createSubscribe,ErrorFactory:s.ErrorFactory,deepExtend:s.deepExtend}),e}(),g=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){var e=t.getComponent();return\"VERSION\"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+\"/\"+e.version}return null}).filter(function(t){return t}).join(\" \")},t}();\n/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */if(s.isBrowser()&&void 0!==self.firebase){d.warn(\"\\n    Warning: Firebase is already defined in the global scope. Please make sure\\n    Firebase library is only loaded once.\\n  \");var w=self.firebase.SDK_VERSION;w&&0<=w.indexOf(\"LITE\")&&d.warn(\"\\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\\n    \")}var b=m.initializeApp;m.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.isNode()&&d.warn('\\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\\n      run in a Node environment.  If running in a Node environment, make sure you\\n      are using the bundle specified by the \"main\" field in package.json.\\n      \\n      If you are using Webpack, you can specify \"main\" as the first item in\\n      \"resolve.mainFields\":\\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\\n      \\n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify \"main\"\\n      as the first item in \"mainFields\", e.g. [\\'main\\', \\'module\\'].\\n      https://github.com/rollup/rollup-plugin-node-resolve\\n      '),b.apply(void 0,t)};var _=m;(function(t,e){t.INTERNAL.registerComponent(new u.Component(\"platform-logger\",function(t){return new g(t)},\"PRIVATE\")),t.registerVersion(f,\"0.6.2\",void 0),t.registerVersion(\"fire-js\",\"\")})(_),e.default=_,e.firebase=_},function(t,e,n){\"use strict\";var r=Math.max,i=Math.floor;n.r(e),function(t){function o(t){return\"string\"==typeof t}function s(t){return\"number\"==typeof t}function u(t,e){t=t.split(\".\"),e=e||nn;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function a(){}function h(t){var e=typeof t;if(\"object\"==e){if(!t)return\"null\";if(t instanceof Array)return\"array\";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if(\"[object Window]\"==n)return\"object\";if(\"[object Array]\"==n||\"number\"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable(\"call\"))return\"function\"}else if(\"function\"==e&&void 0===t.call)return\"object\";return e}function c(t){return\"array\"==h(t)}function f(t){var e=h(t);return\"array\"==e||\"object\"==e&&\"number\"==typeof t.length}function l(t){var e=typeof t;return\"object\"==e&&null!=t||\"function\"==e}function p(t){return t.call.apply(t.bind,arguments)}function d(t,e){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function y(){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?p:d).apply(null,arguments)}function v(t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function m(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return e.prototype[n].apply(t,r)}}function g(){this.j=this.j,this.i=this.i}function w(){return Array.prototype.concat.apply([],arguments)}function b(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function _(t){return/^[\\s\\xa0]*$/.test(t)}function E(t,e){return-1!=t.indexOf(e)}function T(t,e){return t<e?-1:t>e?1:0}function I(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function N(t){var e,n={};for(e in t)n[e]=t[e];return n}function A(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<pn.length;i++)e=pn[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function S(t){return S[\" \"](t),t}function D(){var t=nn.document;return t?t.documentMode:void 0}function k(t){return function(t,e){var n=Nn;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=cn(dn+\"\").split(\".\"),i=cn(t+\"\").split(\".\"),o=r(n.length,i.length),s=0;0==e&&s<o;s++){var u=n[s]||\"\",a=i[s]||\"\";do{if(u=/(\\d*)(\\D*)(.*)/.exec(u)||[\"\",\"\",\"\",\"\"],a=/(\\d*)(\\D*)(.*)/.exec(a)||[\"\",\"\",\"\",\"\"],0==u[0].length&&0==a[0].length)break;e=T(0==u[1].length?0:parseInt(u[1],10),0==a[1].length?0:parseInt(a[1],10))||T(0==u[2].length,0==a[2].length)||T(u[2],a[2]),u=u[3],a=a[3]}while(0==e)}return 0<=e})}function x(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function O(t,e){if(x.call(this,t?t.type:\"\"),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType=\"\",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(wn){t:{try{S(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else\"mouseover\"==n?e=t.fromElement:\"mouseout\"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0===r.clientX?r.pageX:r.clientX,this.clientY=void 0===r.clientY?r.pageY:r.clientY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0===t.clientX?t.pageX:t.clientX,this.clientY=void 0===t.clientY?t.pageY:t.clientY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||\"\",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=o(t.pointerType)?t.pointerType:xn[t.pointerType]||\"\",this.c=t,t.defaultPrevented&&this.b()}}function R(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++Rn,this.X=this.Z=!1}function L(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function C(t){this.src=t,this.a={},this.b=0}function P(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=an(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(L(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function V(t,e,n,r){for(var i,o=0;o<t.length;++o)if(!(i=t[o]).X&&i.listener==e&&i.capture==!!n&&i.da==r)return o;return-1}function U(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(c(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=z(r),e&&e[On]?e.Aa(n,r,l(i)?!!i.capture:!!i,o):M(e,n,r,!0,i,o)}(t,e,n,r,i);if(c(e)){for(var o=0;o<e.length;o++)U(t,e[o],n,r,i);return null}return n=z(n),t&&t[On]?t.za(e,n,l(r)?!!r.capture:!!r,i):M(t,e,n,!1,r,i)}function M(t,e,n,r,i,o){if(!e)throw Error(\"Invalid event type\");var s=l(i)?!!i.capture:!!i;if(s&&!Sn)return null;var u=G(t);if(u||(t[Ln]=u=new C(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=B,e=Sn?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)kn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(F(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");t.addListener(r)}return n}function j(t){if(!s(t)&&t&&!t.X){var e=t.src;if(e&&e[On])P(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(F(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=G(e))?(P(n,t),0==n.b&&(n.src=null,e[Ln]=null)):L(t)}}}function F(t){return t in Cn?Cn[t]:Cn[t]=\"on\"+t}function q(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&j(t),n.call(r,e)}function B(t,e){return!!t.X||(Sn?q(t,new O(e,this)):q(t,e=new O(e||u(\"window.event\"),this)))}function G(t){return(t=t[Ln])instanceof C?t:null}function z(t){return\"function\"==h(t)?t:(t[Pn]||(t[Pn]=function(e){return t.handleEvent(e)}),t[Pn])}function K(){g.call(this),this.c=new C(this),this.J=this,this.B=null}function W(t,e,n,r){if(!(e=t.c.a[e+\"\"]))return!0;e=e.concat();for(var i,o=!0,s=0;s<e.length;++s)if((i=e[s])&&!i.X&&i.capture==n){var u=i.listener,a=i.da||i.src;i.Z&&P(t.c,i),o=!1!==u.call(a,r)&&o}return o&&0!=r.Ia}function H(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Y(){this.b=this.a=null}function X(){var t=Fn,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function J(){this.next=this.b=this.a=null}function Q(t){nn.setTimeout(function(){throw t},0)}function Z(t,e){Mn||function(){var t=nn.Promise.resolve(void 0);Mn=function(){t.then($)}}(),jn||(Mn(),jn=!0),Fn.add(t,e)}function $(){for(var t;t=X();){try{t.a.call(t.b)}catch(t){Q(t)}var e=Un;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}jn=!1}function tt(t,e){K.call(this),this.b=t||1,this.a=e||nn,this.f=y(this.gb,this),this.g=sn()}function et(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function nt(t,e,n){if(\"function\"==h(t))n&&(t=y(t,n));else{if(!t||\"function\"!=typeof t.handleEvent)throw Error(\"Invalid listener argument\");t=y(t.handleEvent,t)}return 2147483647<+e?-1:nn.setTimeout(t,e||0)}function rt(t,e,n){g.call(this),this.f=null==n?t:y(t,n),this.c=e,this.b=y(this.$a,this),this.a=[]}function it(t){t.U=nt(t.b,t.c),t.f.apply(null,t.a)}function ot(t){g.call(this),this.b=t,this.a={}}function st(t,e,n,r){c(n)||(n&&(qn[0]=n.toString()),n=qn);for(var i,o=0;o<n.length&&(i=U(e,n[o],r||t.handleEvent,!1,t.b||t));o++)t.a[i.key]=i}function ut(t){I(t.a,function(t,e){this.a.hasOwnProperty(e)&&j(t)},t),t.a={}}function at(){}function ht(t){x.call(this,\"serverreachability\",t)}function ct(t){Bn.dispatchEvent(new ht(Bn,t))}function ft(t){x.call(this,\"statevent\",t)}function lt(t){Bn.dispatchEvent(new ft(Bn,t))}function pt(t){x.call(this,\"timingevent\",t)}function dt(t,e){if(\"function\"!=h(t))throw Error(\"Fn must not be null and must be a function\");return nn.setTimeout(function(){t()},e)}function yt(){}function vt(t){var e;return(e=t.a)||(e=t.a={}),e}function mt(){}function gt(){x.call(this,\"d\")}function wt(){x.call(this,\"c\")}function bt(){}function _t(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ot(this),this.O=Hn,t=gn?125:void 0,this.P=new tt(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}function Et(t,e,n){t.F=1,t.f=Wt(jt(e)),t.l=n,t.H=!0,It(t,null)}function Tt(t,e,n,r){t.F=1,t.f=Wt(jt(e)),t.l=null,t.H=n,It(t,r)}function It(t,e){t.v=sn(),St(t),t.D=jt(t.f),Kt(t.D,\"t\",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new rt(y(t.Ja,t,t.a),t.J)),st(t.I,t.a,\"readystatechange\",t.cb),e=t.h?N(t.h):{},t.l?(t.w||(t.w=\"POST\"),e[\"Content-Type\"]=\"application/x-www-form-urlencoded\",t.a.ca(t.D,t.w,t.l,e)):(t.w=\"GET\",t.a.ca(t.D,t.w,null,e)),ct(1)}function Nt(t,e,n){for(var r,i=!0;!t.m&&t.A<n.length;){if((r=At(t,n))==Xn){4==e&&(t.c=4,lt(14),i=!1);break}if(r==Yn){t.c=4,lt(15),i=!1;break}Rt(t,r)}4==e&&0==n.length&&(t.c=1,lt(16),i=!1),t.b=t.b&&i,i||(Ot(t),xt(t))}function At(t,e){var n=t.A,r=e.indexOf(\"\\n\",n);return-1==r?Xn:(n=+e.substring(n,r),isNaN(n)?Yn:(r+=1)+n>e.length?Xn:(e=e.substr(r,n),t.A=r+n,e))}function St(t){t.R=sn()+t.O,Dt(t,t.O)}function Dt(t,e){if(null!=t.i)throw Error(\"WatchDog timer not null\");t.i=dt(y(t.ab,t),e)}function kt(t){t.i&&(nn.clearTimeout(t.i),t.i=null)}function xt(t){t.g.Ca()||t.m||t.g.na(t)}function Ot(t){kt(t);var e=t.B;e&&\"function\"==typeof e.la&&e.la(),t.B=null,et(t.P),ut(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Rt(t,e){try{t.g.Fa(t,e),ct(4)}catch(t){}}function Lt(t,e){if(t.forEach&&\"function\"==typeof t.forEach)t.forEach(e,void 0);else if(f(t)||o(t))hn(t,e,void 0);else{if(t.K&&\"function\"==typeof t.K)var n=t.K();else if(t.C&&\"function\"==typeof t.C)n=void 0;else if(f(t)||o(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&\"function\"==typeof t.C)return t.C();if(o(t))return t.split(\"\");if(f(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}}function Ct(t){this.b={},this.a=[],this.c=0;var e=arguments.length;if(1<e){if(e%2)throw Error(\"Uneven number of arguments\");for(var n=0;n<e;n+=2)this.set(arguments[n],arguments[n+1])}else if(t)if(t instanceof Ct)for(e=t.K(),n=0;n<e.length;n++)this.set(e[n],t.get(e[n]));else for(n in t)this.set(n,t[n])}function Pt(t,e){Ut(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Vt(t))}function Vt(t){if(t.c!=t.a.length){for(var e,n=0,r=0;n<t.a.length;)e=t.a[n],Ut(t.b,e)&&(t.a[r++]=e),n++;t.a.length=r}if(t.c!=t.a.length){var i={};for(r=n=0;n<t.a.length;)Ut(i,e=t.a[n])||(t.a[r++]=e,i[e]=1),n++;t.a.length=r}}function Ut(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Mt(t,e){var n;this.b=this.j=this.f=\"\",this.i=null,this.g=this.a=\"\",this.h=!1,t instanceof Mt?(this.h=void 0===e?t.h:e,Ft(this,t.f),this.j=t.j,qt(this,t.b),Bt(this,t.i),this.a=t.a,Gt(this,ee(t.c)),this.g=t.g):t&&(n=(t+\"\").match(Jn))?(this.h=!!e,Ft(this,n[1]||\"\",!0),this.j=Ht(n[2]||\"\"),qt(this,n[3]||\"\",!0),Bt(this,n[4]),this.a=Ht(n[5]||\"\",!0),Gt(this,n[6]||\"\",!0),this.g=Ht(n[7]||\"\")):(this.h=!!e,this.c=new Jt(null,this.h))}function jt(t){return new Mt(t)}function Ft(t,e,n){t.f=n?Ht(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,\"\"))}function qt(t,e,n){t.b=n?Ht(e,!0):e}function Bt(t,e){if(e){if(e=+e,isNaN(e)||0>e)throw Error(\"Bad port number \"+e);t.i=e}else t.i=null}function Gt(t,e,n){e instanceof Jt?(t.c=e,function(t,e){e&&!t.f&&(Qt(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Zt(this,e),te(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=Yt(e,tr)),t.c=new Jt(e,t.h))}function zt(t,e,n){t.c.set(e,n)}function Kt(t,e,n){c(n)||(n=[n+\"\"]),te(t.c,e,n)}function Wt(t){return zt(t,\"zx\",i(2147483648*Math.random()).toString(36)+Math.abs(i(2147483648*Math.random())^sn()).toString(36)),t}function Ht(t,e){return t?e?decodeURI(t.replace(/%25/g,\"%2525\")):decodeURIComponent(t):\"\"}function Yt(t,e,n){return o(t)?(t=encodeURI(t).replace(e,Xt),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),t):null}function Xt(t){return\"%\"+(15&(t=t.charCodeAt(0))>>4).toString(16)+(15&t).toString(16)}function Jt(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Qt(t){t.a||(t.a=new Ct,t.b=0,t.c&&function(t,e){if(t){t=t.split(\"&\");for(var n=0;n<t.length;n++){var r=t[n].indexOf(\"=\"),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\\+/g,\" \")):\"\")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\\+/g,\" \")),n)}))}function Zt(t,e){Qt(t),e=ne(t,e),Ut(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Pt(t.a,e))}function $t(t,e){return Qt(t),e=ne(t,e),Ut(t.a.b,e)}function te(t,e,n){Zt(t,e),0<n.length&&(t.c=null,t.a.set(ne(t,e),b(n)),t.b+=n.length)}function ee(t){var e=new Jt;return e.c=t.c,t.a&&(e.a=new Ct(t.a),e.b=t.b),e}function ne(t,e){return e+=\"\",t.f&&(e=e.toLowerCase()),e}function re(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function ie(t){var e=t.a.F.a;if(null!=e)lt(4),e?(lt(10),qe(t.a,t,!1)):(lt(11),qe(t.a,t,!0));else{t.b=new _t(t,void 0,void 0),t.b.h=t.h,e=We(e=t.a,e.Y()?t.f:null,t.i),lt(4),Kt(e,\"TYPE\",\"xmlhttp\");var n=t.a.j,r=t.a.I;n&&r&&zt(e,n,r),Tt(t.b,e,!1,t.f)}}function oe(){this.a=this.b=null}function se(){this.a=new Ct}function ue(t){var e=typeof t;return\"object\"==e&&t||\"function\"==e?\"o\"+(t[rn]||(t[rn]=++on)):e.charAt(0)+t}function ae(t,e){this.b=t,this.a=e}function he(t){this.g=t||nr,nn.PerformanceNavigationTiming?t=0<(t=nn.performance.getEntriesByType(\"navigation\")).length&&(\"hq\"==t[0].nextHopProtocol||\"h2\"==t[0].nextHopProtocol):t=!!(nn.ka&&nn.ka.Da&&nn.ka.Da()&&nn.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new se),this.b=null,this.c=[]}function ce(t,e){!t.a&&(E(e,\"spdy\")||E(e,\"quic\")||E(e,\"h2\"))&&(t.f=t.g,t.a=new se,t.b&&(de(t,t.b),t.b=null))}function fe(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function le(t){return t.b?1:t.a?t.a.a.c:0}function pe(t,e){return t.b?t=t.b==e:t.a?(e=ue(e),t=Ut(t.a.a.b,e)):t=!1,t}function de(t,e){t.a?t.a.add(e):t.b=e}function ye(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=ue(e),n=Ut(t.a.a.b,n)),n&&Pt(t.a.a,ue(e)))}function ve(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return hn(t.a.C(),function(t){e=e.concat(t.j)}),e}return b(t.c)}function me(){}function ge(){this.a=new me}function we(t,e,n){var r=n||\"\";try{Lt(t,function(t,n){var i=t;l(t)&&(i=Vn(t)),e.push(r+n+\"=\"+encodeURIComponent(i))})}catch(n){throw e.push(r+\"type=\"+encodeURIComponent(\"_badmap\")),n}}function be(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function _e(t){K.call(this),this.headers=new Ct,this.H=t||null,this.b=!1,this.s=this.a=null,this.A=\"\",this.h=0,this.f=\"\",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=ir,this.D=this.F=!1}function Ee(t){return\"content-type\"==t.toLowerCase()}function Te(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Ie(t),Ae(t)}function Ie(t){t.v||(t.v=!0,t.dispatchEvent(\"complete\"),t.dispatchEvent(\"error\"))}function Ne(t){if(t.b&&void 0!==en&&(!t.s[1]||4!=De(t)||2!=t.T()))if(t.l&&4==De(t))nt(t.Ea,0,t);else if(t.dispatchEvent(\"readystatechange\"),4==De(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=(t.A+\"\").match(Jn)[1]||null;if(!o&&nn.self&&nn.self.location){var s=nn.self.location.protocol;o=s.substr(0,s.length-1)}i=!or.test(o?o.toLowerCase():\"\")}e=i}if(e)t.dispatchEvent(\"complete\"),t.dispatchEvent(\"success\");else{t.h=6;try{var u=2<De(t)?t.a.statusText:\"\"}catch(o){u=\"\"}t.f=u+\" [\"+t.T()+\"]\",Ie(t)}}finally{Ae(t)}}}function Ae(t,e){if(t.a){Se(t);var n=t.a,r=t.s[0]?a:null;t.a=null,t.s=null,e||t.dispatchEvent(\"ready\");try{n.onreadystatechange=r}catch(e){}}}function Se(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(nn.clearTimeout(t.m),t.m=null)}function De(t){return t.a?t.a.readyState:0}function ke(t,e){return t.a?t.a.getResponseHeader(e):null}function xe(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e=\"\";return I(t,function(t,n){e+=n,e+=\":\",e+=t,e+=\"\\r\\n\"}),e}(n),o(t)){if(e=encodeURIComponent(e+\"\"),e+=n=null==n?\"\":\"=\"+encodeURIComponent(n+\"\")){if(0>(n=t.indexOf(\"#\"))&&(n=t.length),0>(r=t.indexOf(\"?\"))||r>n){r=n;var i=\"\"}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+\"&\"+e:e:n,t=t[0]+(t[1]?\"?\"+t[1]:\"\")+t[2]}return t}return zt(t,e,n),t}function Oe(t){this.f=[],this.F=new oe,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!u(\"internalChannelParams.failFast\",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=u(\"internalChannelParams.baseRetryDelayMs\",t)||5e3,this.Ra=u(\"internalChannelParams.retryDelaySeedMs\",t)||1e4,this.Pa=u(\"internalChannelParams.forwardChannelMaxRetries\",t)||2,this.qa=u(\"internalChannelParams.forwardChannelRequestTimeoutMs\",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H=\"\",this.b=new he(t&&t.concurrentRequestLimit),this.ja=new ge,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Re(t){if(Le(t),3==t.u){var e=t.P++,n=jt(t.B);zt(n,\"SID\",t.H),zt(n,\"RID\",e),zt(n,\"TYPE\",\"terminate\"),Ue(t,n),(e=new _t(t,e,void 0)).F=2,e.f=Wt(jt(n)),n=!1,nn.navigator&&nn.navigator.sendBeacon&&(n=nn.navigator.sendBeacon(e.f.toString(),\"\")),!n&&nn.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=sn(),St(e)}Ke(t)}function Le(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(nn.clearTimeout(t.l),t.l=null),Be(t),t.b.cancel(),t.h&&(s(t.h)&&nn.clearTimeout(t.h),t.h=null)}function Ce(t,e){t.f.push(new ae(t.Qa++,e)),3==t.u&&Pe(t)}function Pe(t){fe(t.b)||t.h||(t.h=!0,Z(t.Ha,t),t.A=0)}function Ve(t,e){var n,r=Math.round;n=e?e.W:t.P++;var i=jt(t.B);zt(i,\"SID\",t.H),zt(i,\"RID\",n),zt(i,\"AID\",t.O),Ue(t,i),t.g&&t.i&&xe(i,t.g,t.i),n=new _t(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=Me(t,n,1e3),n.setTimeout(r(.5*t.qa)+r(.5*t.qa*Math.random())),de(t.b,n),Et(n,i,e)}function Ue(t,e){t.c&&Lt({},function(t,n){zt(e,n,t)})}function Me(t,e,n){n=Math.min(t.f.length,n);var i=t.c?y(t.c.Sa,t.c,t):null;t:for(var o,s=t.f,u=-1;;){o=[\"count=\"+n],-1==u?0<n?(u=s[0].b,o.push(\"ofs=\"+u)):u=0:o.push(\"ofs=\"+u);for(var a=!0,h=0;h<n;h++){var c=s[h].b,f=s[h].a;if(0>(c-=u))u=r(0,s[h].b-100),a=!1;else try{we(f,o,\"req\"+c+\"_\")}catch(u){i&&i(f)}}if(a){i=o.join(\"&\");break t}}return t=t.f.splice(0,n),e.j=t,i}function je(t){t.a||t.l||(t.S=1,Z(t.Ga,t),t.v=0)}function Fe(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=dt(y(t.Ga,t),Ge(t,t.v)),t.v++,!0)}function qe(t,e,n){var r=e.l;r&&ce(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=We(t,null,t.ha),Pe(t)}function Be(t){null!=t.s&&(nn.clearTimeout(t.s),t.s=null)}function Ge(t,e){var n=t.Na+i(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function ze(t,e){if(2==e){var n=null;t.c&&(n=null);var r=y(t.eb,t);n||(n=new Mt(\"//www.google.com/images/cleardot.gif\"),nn.location&&\"http\"==nn.location.protocol||Ft(n,\"https\"),Wt(n)),function(t,e){var n=new at;if(nn.Image){var r=new Image;r.onload=v(be,n,r,\"TestLoadImage: loaded\",!0,e),r.onerror=v(be,n,r,\"TestLoadImage: error\",!1,e),r.onabort=v(be,n,r,\"TestLoadImage: abort\",!1,e),r.ontimeout=v(be,n,r,\"TestLoadImage: timeout\",!1,e),nn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else lt(2);t.u=0,t.c&&t.c.ta(e),Ke(t),Le(t)}function Ke(t){t.u=0,t.m=-1,t.c&&((0!=ve(t.b).length||0!=t.f.length)&&(t.b.c.length=0,b(t.f),t.f.length=0),t.c.sa())}function We(t,e,n){var r=function(t){return t instanceof Mt?jt(t):new Mt(t,void 0)}(n);if(\"\"!=r.b)e&&qt(r,e+\".\"+r.b),Bt(r,r.i);else{var i,o=nn.location;i=e?e+\".\"+o.hostname:o.hostname,r=function(t,e,n,r){var i=new Mt(null,void 0);return t&&Ft(i,t),e&&qt(i,e),n&&Bt(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&I(t.V,function(t,e){zt(r,e,t)}),e=t.j,n=t.I,e&&n&&zt(r,e,n),zt(r,\"VER\",t.wa),Ue(t,r),r}function He(){}function Ye(){if(vn&&!(10<=+In))throw Error(\"Environmental error: no available transport.\")}function Xe(t,e){K.call(this),this.a=new Oe(e),this.g=t,this.m=e&&e.fb?e.fb:function(){for(var t,e=arguments[0],n=1;n<arguments.length;n++)if(0==(t=arguments[n]).lastIndexOf(\"/\",0))e=t;else{var r;(r=\"\"==e)||(r=0<=(r=e.length-1)&&e.indexOf(\"/\",r)==r),e+=r?t:\"/\"+t}return e}(this.g,\"test\"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t[\"X-Client-Protocol\"]=\"webchannel\":t={\"X-Client-Protocol\":\"webchannel\"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t[\"X-WebChannel-Content-Type\"]=e.messageContentType:t={\"X-WebChannel-Content-Type\":e.messageContentType}),e&&e.xa&&(t?t[\"X-WebChannel-Client-Profile\"]=e.xa:t={\"X-WebChannel-Client-Profile\":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!_(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!_(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Ze(this)}function Je(t){gt.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Qe(){wt.call(this),this.status=1}function Ze(t){this.a=t}n.d(e,\"ErrorCode\",function(){return cr}),n.d(e,\"EventType\",function(){return fr}),n.d(e,\"WebChannel\",function(){return lr}),n.d(e,\"XhrIo\",function(){return pr}),n.d(e,\"createWebChannelTransport\",function(){return hr});var $e,tn=\"undefined\"==typeof globalThis?\"undefined\"==typeof window?void 0===t?\"undefined\"==typeof self?{}:self:t:window:globalThis,en=en||{},nn=tn,rn=\"closure_uid_\"+(1e9*Math.random()>>>0),on=0,sn=Date.now||function(){return+new Date};g.prototype.j=!1,g.prototype.la=function(){},g.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var un,an=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(o(t))return o(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},hn=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=o(t)?t.split(\"\"):t,s=0;s<r;s++)s in i&&e.call(n,i[s],s,t)},cn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(t)[1]};t:{var fn=nn.navigator;if(fn){var ln=fn.userAgent;if(ln){un=ln;break t}}un=\"\"}var pn=[\"constructor\",\"hasOwnProperty\",\"isPrototypeOf\",\"propertyIsEnumerable\",\"toLocaleString\",\"toString\",\"valueOf\"];S[\" \"]=a;var dn,yn=E(un,\"Opera\"),vn=E(un,\"Trident\")||E(un,\"MSIE\"),mn=E(un,\"Edge\"),gn=mn||vn,wn=E(un,\"Gecko\")&&(!E(un.toLowerCase(),\"webkit\")||E(un,\"Edge\"))&&!(E(un,\"Trident\")||E(un,\"MSIE\"))&&!E(un,\"Edge\"),bn=E(un.toLowerCase(),\"webkit\")&&!E(un,\"Edge\");t:{var _n=\"\",En=function(){var t=un;return wn?/rv:([^\\);]+)(\\)|;)/.exec(t):mn?/Edge\\/([\\d\\.]+)/.exec(t):vn?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(t):bn?/WebKit\\/(\\S+)/.exec(t):yn?/(?:Version)[ \\/]?(\\S+)/.exec(t):void 0}();if(En&&(_n=En?En[1]:\"\"),vn){var Tn=D();if(null!=Tn&&Tn>parseFloat(_n)){dn=Tn+\"\";break t}}dn=_n}var In,Nn={},An=nn.document;In=An&&vn?D()||(\"CSS1Compat\"==An.compatMode?parseInt(dn,10):5):void 0;var Sn=!vn||9<=+In,Dn=vn&&!k(\"9\"),kn=function(){if(!nn.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},\"passive\",{get:function(){t=!0}});try{nn.addEventListener(\"test\",a,e),nn.removeEventListener(\"test\",a,e)}catch(t){}return t}();x.prototype.b=function(){this.Ia=!1},m(O,x);var xn={2:\"touch\",3:\"pen\",4:\"mouse\"};O.prototype.b=function(){O.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Dn)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var On=\"closure_listenable_\"+(0|1e6*Math.random()),Rn=0;C.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=V(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new R(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ln=\"closure_lm_\"+(0|1e6*Math.random()),Cn={},Pn=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);m(K,g),K.prototype[On]=!0,($e=K.prototype).addEventListener=function(t,e,n,r){U(this,t,e,n,r)},$e.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(c(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=l(i)?!!i.capture:!!i,r=z(r),e&&e[On]?(e=e.c,(n=(n+\"\").toString())in e.a&&-1<(r=V(s=e.a[n],r,i,o))&&(L(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=G(e))&&(n=e.a[n.toString()],e=-1,n&&(e=V(n,r,i,o)),(r=-1<e?n[e]:null)&&j(r))}(this,t,e,n,r)},$e.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(o(t))t=new x(t,n);else if(t instanceof x)t.target=t.target||n;else{var i=t;A(t=new x(r,n),i)}if(i=!0,e)for(var s,u=e.length-1;0<=u;u--)i=W(s=t.a=e[u],r,!0,t)&&i;if(i=W(s=t.a=n,r,!0,t)&&i,i=W(s,r,!1,t)&&i,e)for(u=0;u<e.length;u++)i=W(s=t.a=e[u],r,!1,t)&&i;return i},$e.G=function(){if(K.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)L(n[r]);delete e.a[t],e.b--}}this.B=null},$e.za=function(t,e,n,r){return this.c.add(t+\"\",e,!1,n,r)},$e.Aa=function(t,e,n,r){return this.c.add(t+\"\",e,!0,n,r)};var Vn=nn.JSON.stringify;H.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Un=new H(function(){return new J},function(t){t.reset()});Y.prototype.add=function(t,e){var n=Un.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},J.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},J.prototype.reset=function(){this.next=this.b=this.a=null};var Mn,jn=!1,Fn=new Y;m(tt,K),($e=tt.prototype).ba=!1,$e.L=null,$e.gb=function(){if(this.ba){var t=sn()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent(\"tick\"),this.ba&&(et(this),this.start()))}},$e.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=sn())},$e.G=function(){tt.N.G.call(this),et(this),delete this.a},m(rt,g),($e=rt.prototype).ea=!1,$e.U=null,$e.Ta=function(){this.a=arguments,this.U?this.ea=!0:it(this)},$e.G=function(){rt.N.G.call(this),this.U&&(nn.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},$e.$a=function(){this.U=null,this.ea&&(this.ea=!1,it(this))},m(ot,g);var qn=[];ot.prototype.G=function(){ot.N.G.call(this),ut(this)},ot.prototype.handleEvent=function(){throw Error(\"EventHandler.handleEvent not implemented\")};var Bn=new K;m(ht,x),m(ft,x),m(pt,x);var Gn={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},zn={jb:\"complete\",wb:\"success\",Ma:\"error\",La:\"abort\",ub:\"ready\",vb:\"readystatechange\",TIMEOUT:\"timeout\",qb:\"incrementaldata\",tb:\"progress\",lb:\"downloadprogress\",xb:\"uploadprogress\"};yt.prototype.a=null;var Kn,Wn={OPEN:\"a\",ib:\"b\",Ma:\"c\",rb:\"d\"};m(gt,x),m(wt,x),m(bt,yt),Kn=new bt;var Hn=45e3,Yn={},Xn={};($e=_t.prototype).setTimeout=function(t){this.O=t},$e.cb=function(t){t=t.target;var e=this.B;e&&3==De(t)?e.Ta():this.Ja(t)},$e.Ja=function(t){try{if(t==this.a)t:{var e=De(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e)&&(3!=e||gn||this.a.aa())){this.m||4!=e||7==n||ct(8==n||0>=r?3:2),kt(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var s=ke(this.a,\"X-HTTP-Initial-Response\");if(s&&!_(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.c=3,lt(12),Ot(this),xt(this);break t}this.s=!0,Rt(this,u)}this.H?(Nt(this,e,o),gn&&this.b&&3==e&&(st(this.I,this.P,\"tick\",this.bb),this.P.start())):Rt(this,o),4==e&&Ot(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,St(this)))}else 400==i&&0<o.indexOf(\"Unknown SID\")?(this.c=3,lt(12)):(this.c=0,lt(13)),Ot(this),xt(this)}}}catch(o){}},$e.bb=function(){if(this.a){var t=De(this.a),e=this.a.aa();this.A<e.length&&(kt(this),Nt(this,t,e),this.b&&4!=t&&St(this))}},$e.cancel=function(){this.m=!0,Ot(this)},$e.ab=function(){this.i=null;var t=sn();0<=t-this.R?(2!=this.F&&(ct(3),lt(17)),Ot(this),this.c=2,xt(this)):Dt(this,this.R-t)},($e=Ct.prototype).C=function(){Vt(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},$e.K=function(){return Vt(this),this.a.concat()},$e.get=function(t,e){return Ut(this.b,t)?this.b[t]:e},$e.set=function(t,e){Ut(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},$e.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Jn=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;Mt.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Yt(e,Qn,!0),\":\");var n=this.b;return(n||\"file\"==e)&&(t.push(\"//\"),(e=this.j)&&t.push(Yt(e,Qn,!0),\"@\"),t.push(encodeURIComponent(n+\"\").replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(n=this.i)&&t.push(\":\",n+\"\")),(n=this.a)&&(this.b&&\"/\"!=n.charAt(0)&&t.push(\"/\"),t.push(Yt(n,\"/\"==n.charAt(0)?$n:Zn,!0))),(n=this.c.toString())&&t.push(\"?\",n),(n=this.g)&&t.push(\"#\",Yt(n,er)),t.join(\"\")},Mt.prototype.resolve=function(t){var e=jt(this),n=!!t.f;n?Ft(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?qt(e,t.b):n=null!=t.i;var r=t.a;if(n)Bt(e,t.i);else if(n=!!t.a){if(\"/\"!=r.charAt(0))if(this.b&&!this.a)r=\"/\"+r;else{var i=e.a.lastIndexOf(\"/\");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(\"..\"==(i=r)||\".\"==i)r=\"\";else if(E(i,\"./\")||E(i,\"/.\")){r=0==i.lastIndexOf(\"/\",0),i=i.split(\"/\");for(var o,s=[],u=0;u<i.length;)\".\"==(o=i[u++])?r&&u==i.length&&s.push(\"\"):\"..\"==o?((1<s.length||1==s.length&&\"\"!=s[0])&&s.pop(),r&&u==i.length&&s.push(\"\")):(s.push(o),r=!0);r=s.join(\"/\")}else r=i}return n?e.a=r:n=\"\"!==t.c.toString(),n?Gt(e,ee(t.c)):n=!!t.g,n&&(e.g=t.g),e};var Qn=/[#\\/\\?@]/g,Zn=/[#\\?:]/g,$n=/[#\\?]/g,tr=/[#\\?@]/g,er=/#/g;($e=Jt.prototype).add=function(t,e){Qt(this),this.c=null,t=ne(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},$e.forEach=function(t,e){Qt(this),this.a.forEach(function(n,r){hn(n,function(n){t.call(e,n,r,this)},this)},this)},$e.K=function(){Qt(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},$e.C=function(t){Qt(this);var e=[];if(o(t))$t(this,t)&&(e=w(e,this.a.get(ne(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=w(e,t[n])}return e},$e.set=function(t,e){return Qt(this),this.c=null,$t(this,t=ne(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},$e.get=function(t,e){return t?0<(t=this.C(t)).length?t[0]+\"\":e:e},$e.toString=function(){if(this.c)return this.c;if(!this.a)return\"\";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(r+\"\");r=this.C(r);for(var o,s=0;s<r.length;s++)o=i,\"\"!==r[s]&&(o+=\"=\"+encodeURIComponent(r[s]+\"\")),t.push(o)}return this.c=t.join(\"&\")},m(function(){},function(){}),($e=re.prototype).M=null,$e.$=function(t){return this.a.$(t)},$e.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},$e.Ca=function(){return!1},$e.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ke(t,\"X-Client-Wire-Protocol\");this.l=n||null,this.a.j&&(t=ke(t,\"X-HTTP-Session-Id\"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(n){return(e=this.a).m=this.c,void ze(e,2)}this.f=r[0]}else(e=this.a).m=this.c,ze(e,2)}else 1==this.M&&(this.g?lt(6):\"11111\"==e?(lt(5),this.g=!0,(!vn||10<=+In)&&(this.c=200,this.b.cancel(),lt(11),qe(this.a,this,!0))):(lt(7),this.g=!1))},$e.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,ie(this)):1==this.M&&(this.g?(lt(11),qe(this.a,this,!0)):(lt(10),qe(this.a,this,!1)));else{0==this.M?lt(8):1==this.M&&lt(9);var t=this.a;t.m=this.c,ze(t,2)}},$e.Y=function(){return this.a.Y()},$e.ma=function(){return this.a.ma()},se.prototype.add=function(t){this.a.set(ue(t),t)},se.prototype.C=function(){return this.a.C()};var nr=10;he.prototype.cancel=function(){var t;this.c=ve(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(hn(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},me.prototype.stringify=function(t){return nn.JSON.stringify(t,void 0)},me.prototype.parse=function(t){return nn.JSON.parse(t,void 0)};var rr=nn.JSON.parse;m(_e,K);var ir=\"\",or=/^https?$/i,sr=[\"POST\",\"PUT\"];($e=_e.prototype).ca=function(t,e,n,r){if(this.a)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.A+\"; newUri=\"+t);e=e?e.toUpperCase():\"GET\",this.A=t,this.f=\"\",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?vt(this.H):vt(Kn),this.a.onreadystatechange=y(this.Ea,this);try{this.w=!0,this.a.open(e,t+\"\",!0),this.w=!1}catch(i){return void Te(this,i)}t=n||\"\";var i,u=new Ct(this.headers);r&&Lt(r,function(t,e){u.set(e,t)}),r=function(t){t:{for(var e=Ee,n=t.length,r=o(t)?t.split(\"\"):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:o(t)?t.charAt(e):t[e]}(u.K()),n=nn.FormData&&t instanceof nn.FormData,!(0<=an(sr,e))||r||n||u.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),u.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),\"withCredentials\"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Se(this),0<this.o&&((this.D=(i=this.a,vn&&k(9)&&s(i.timeout)&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=y(this.Ba,this)):this.m=nt(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(i){Te(this,i)}},$e.Ba=function(){void 0!==en&&this.a&&(this.f=\"Timed out after \"+this.o+\"ms, aborting\",this.h=8,this.dispatchEvent(\"timeout\"),this.abort(8))},$e.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),Ae(this))},$e.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Ae(this,!0)),_e.N.G.call(this)},$e.Ea=function(){this.j||(this.w||this.l||this.g?Ne(this):this.Za())},$e.Za=function(){Ne(this)},$e.T=function(){try{return 2<De(this)?this.a.status:-1}catch(t){return-1}},$e.aa=function(){try{return this.a?this.a.responseText:\"\"}catch(t){return\"\"}},$e.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),rr(e)}},$e.ya=function(){return this.h},$e.Xa=function(){return o(this.f)?this.f:this.f+\"\"},($e=Oe.prototype).wa=8,$e.u=1,$e.Ca=function(){return 0==this.u},$e.Ha=function(t){if(this.h)if(this.h=null,1!=this.u)3==this.u&&(t?Ve(this,t):0==this.f.length||fe(this.b)||Ve(this));else if(!t){this.P=i(1e5*Math.random());var e,n=new _t(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?A(r=N(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var s=e=0;s<this.f.length;s++){var u=this.f[s];if(void 0===(u=\"__data__\"in u.a&&o(u=u.a.__data__)?u.length:void 0))break;if(4096<(e+=u)){e=s;break t}if(4096===e||s===this.f.length-1){e=s+1;break t}}e=1e3}else e=1e3;e=Me(this,n,e),zt(s=jt(this.B),\"RID\",t),zt(s,\"CVER\",22),this.o&&this.j&&zt(s,\"X-HTTP-Session-Id\",this.j),Ue(this,s),this.g&&r&&xe(s,this.g,r),de(this.b,n),this.W?(zt(s,\"$req\",e),zt(s,\"SID\",\"null\"),n.S=!0,Et(n,s,null)):Et(n,s,e),this.u=2}},$e.Ga=function(){this.l=null,this.a=new _t(this,\"rpc\",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=jt(this.pa);zt(t,\"RID\",\"rpc\"),zt(t,\"SID\",this.H),zt(t,\"CI\",this.ia?\"0\":\"1\"),zt(t,\"AID\",this.O),Ue(this,t),zt(t,\"TYPE\",\"xmlhttp\"),this.g&&this.i&&xe(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Tt(this.a,t,!0,this.ga)},$e.Fa=function(t,e){if(0!=this.u&&(this.a==t||pe(this.b,t)))if(this.m=t.o,!t.s&&pe(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(c(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Be(this),this.a.cancel(),this.a=null}Fe(this),lt(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=dt(y(this.Ya,this),6e3));if(1>=le(this.b)&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else ze(this,11)}else if((t.s||this.a==t)&&Be(this),!_(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2!=this.u)3==this.u&&(\"stop\"==r[0]||\"close\"==r[0]?\"stop\"==r[0]?ze(this,7):Re(this):\"noop\"!=r[0]&&this.c&&this.c.ua(r),this.v=0);else if(\"c\"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&s(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=ke(r,\"X-Client-Wire-Protocol\"))&&ce(this.b,i),this.j&&(r=ke(r,\"X-HTTP-Session-Id\")))&&(this.I=r,zt(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=We(this,this.Y()?this.ga:null,this.ha),r.s?(ye(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(kt(r),St(r)),this.a=r):je(this),0<this.f.length&&Pe(this)}else\"stop\"!=r[0]&&\"close\"!=r[0]||ze(this,7)}},$e.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Fe(this),lt(19))},$e.na=function(t){var e=null;if(this.a==t){Be(this),this.a=null;var n=2}else{if(!pe(this.b,t))return;e=t.j,ye(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=sn()-t.v,Bn.dispatchEvent(new pt(Bn,t.l?t.l.length:0,e,this.A)),Pe(this)):je(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(le(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.f=e.j.concat(t.f),0):1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)||(t.h=dt(y(t.Ha,t,e),Ge(t,t.A)),t.A++,0)))}(this,t)||2==n&&Fe(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:ze(this,5);break;case 4:ze(this,10);break;case 3:ze(this,6);break;default:ze(this,2)}}},$e.eb=function(t){lt(t?2:1)},$e.$=function(t){if(t&&!this.R)throw Error(\"Can't create secondary domain capable XhrIo object.\");return(t=new _e(this.Ka)).F=this.R,t},$e.ma=function(){return!!this.c&&!0},$e.Y=function(){return this.R},($e=He.prototype).va=function(){},$e.ua=function(){},$e.ta=function(){},$e.sa=function(){},$e.Sa=function(){},Ye.prototype.a=function(t,e){return new Xe(t,e)},m(Xe,K),($e=Xe.prototype).addEventListener=function(t,e,n,r){Xe.N.addEventListener.call(this,t,e,n,r)},$e.removeEventListener=function(t,e,n,r){Xe.N.removeEventListener.call(this,t,e,n,r)},$e.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;lt(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new re(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=xe(e,t.g,t.i)),(t=t.w).i=n,e=We(t.a,null,t.i),lt(3),null==(n=t.a.F.b)?(Kt(e,\"MODE\",\"init\"),!t.a.o&&t.a.j&&Kt(e,\"X-HTTP-Session-Id\",t.a.j),t.b=new _t(t,void 0,void 0),t.b.h=t.h,Tt(t.b,e,!1,null),t.M=0):(t.f=n[0],t.M=1,ie(t))},$e.close=function(){Re(this.a)},$e.Wa=function(t){if(o(t)){var e={};e.__data__=t,Ce(this.a,e)}else this.h?((e={}).__data__=Vn(t),Ce(this.a,e)):Ce(this.a,t)},$e.G=function(){this.a.c=null,delete this.f,Re(this.a),delete this.a,Xe.N.G.call(this)},m(Je,gt),m(Qe,wt),m(Ze,He),Ze.prototype.va=function(){this.a.dispatchEvent(\"a\")},Ze.prototype.ua=function(t){this.a.dispatchEvent(new Je(t))},Ze.prototype.ta=function(t){this.a.dispatchEvent(new Qe(t))},Ze.prototype.sa=function(){this.a.dispatchEvent(\"b\")};var ur=v(function(t){function e(){}e.prototype=t.prototype;var n=new e;return t.apply(n,Array.prototype.slice.call(arguments,1)),n},Ye);Ye.prototype.createWebChannel=Ye.prototype.a,Xe.prototype.send=Xe.prototype.Wa,Xe.prototype.open=Xe.prototype.Va,Xe.prototype.close=Xe.prototype.close,Gn.NO_ERROR=0,Gn.TIMEOUT=8,Gn.HTTP_ERROR=6,zn.COMPLETE=\"complete\",mt.EventType=Wn,Wn.OPEN=\"a\",Wn.CLOSE=\"b\",Wn.ERROR=\"c\",Wn.MESSAGE=\"d\",K.prototype.listen=K.prototype.za,_e.prototype.listenOnce=_e.prototype.Aa,_e.prototype.getLastError=_e.prototype.Xa,_e.prototype.getLastErrorCode=_e.prototype.ya,_e.prototype.getStatus=_e.prototype.T,_e.prototype.getResponseJson=_e.prototype.Ua,_e.prototype.getResponseText=_e.prototype.aa,_e.prototype.send=_e.prototype.ca;var ar={createWebChannelTransport:ur,ErrorCode:Gn,EventType:zn,WebChannel:mt,XhrIo:_e},hr=ar.createWebChannelTransport,cr=ar.ErrorCode,fr=ar.EventType,lr=ar.WebChannel,pr=ar.XhrIo;e.default=ar}.call(this,n(2))},function(t,e,n){\"use strict\";n.r(e);var r={};n.r(r),n(5),console.log(r)}]);","extractedComments":[]}